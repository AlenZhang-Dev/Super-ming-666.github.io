<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="https://superming.life/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="https://superming.life/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="https://superming.life/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="https://superming.life/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="https://superming.life/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="https://superming.life/images/apple-touch-icon.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="https://superming.life/images/favicon-32x32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="https://superming.life/images/favicon-16x16.png?v=5.1.4">


  <link rel="mask-icon" href="https://superming.life/images/safari-pinned-tab.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="https://superming.life/atom.xml" title="AlenZhang's Blog" type="application/atom+xml" />






<meta property="og:type" content="website">
<meta property="og:title" content="AlenZhang&#39;s Blog">
<meta property="og:url" content="https://superming.life/index.html">
<meta property="og:site_name" content="AlenZhang&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="AlenZhang">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://superming.life/"/>





  <title>AlenZhang's Blog</title>
  








<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="https://superming.life/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AlenZhang's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="https://superming.life/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="https://superming.life/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="https://superming.life/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="https://superming.life/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://superming.life/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2021/01/28/SSD-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2021/01/28/SSD-Notes/" itemprop="url">Dive into SSD</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-01-28T20:30:00+08:00">
                2021-01-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/CS/" itemprop="url" rel="index">
                    <span itemprop="name">CS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2021/01/28/SSD-Notes/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2021/01/28/SSD-Notes/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2021/01/28/SSD-Notes/" class="leancloud_visitors" data-flag-title="Dive into SSD">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SSD-论文学习笔记"><a href="#SSD-论文学习笔记" class="headerlink" title="SSD 论文学习笔记"></a>SSD 论文学习笔记</h1><h2 id="Single-Shot-MultiBox-Detector"><a href="#Single-Shot-MultiBox-Detector" class="headerlink" title="Single Shot MultiBox Detector"></a>Single Shot MultiBox Detector</h2><p><strong>Single Shot</strong>：表示物体的分类和定位在网络的一次前向传递的完成。【The tasks of object localization and classification are done in a <em>single forward pass</em> of the network.】</p>
<p><strong>MultiBox</strong>：可扩展、高质量的目标检测，<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1412.1441">论文地址</a>。可以理解为在多个feature map上进行多尺度（multi-scale）预测。</p>
<p><strong>Detector</strong>：网络是一个Object Detector。</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Untitled.png" alt="Fig.1 详细SSD模型1"></p>
<p>==Fig.1 详细SSD模型1==</p>
<!--- more ---->
<h2 id="Model-Architecture"><a href="#Model-Architecture" class="headerlink" title="Model Architecture"></a>Model Architecture</h2><blockquote>
<p>The SSD approach is based on a feed-forward convolutional network that produces a fixed-size collection of bounding boxes and scores for the presence of object class<br>instances in those boxes, followed by a non-maximum suppression step to produce thefinal detections. The early network layers are based on a standard architecture used for high quality image classification (truncated before any classification layers), which we will call the base network2. </p>
</blockquote>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_8.19.22_AM.png" alt="Fig.2 SSD详细模型2"></p>
<p>==Fig.2 SSD详细模型2==</p>
<h3 id="Base-Network"><a href="#Base-Network" class="headerlink" title="Base Network"></a><strong>Base Network</strong></h3><p>VGG-16，舍弃了fc6和fc7两个全连接层，主要用于高质量的图片分类任务【High quality image classification  tasks】</p>
<p>原始的VGG、ResNet等主要用于处理分类任务，会采用fc层将最终的feature map映射到向量【对应分类物体】中，而目标检测不需要该分类任务，所以将fc层去掉。</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_9.00.06_AM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_9.00.06_AM.png"></p>
<p>==Fig.3 VGG网络结构(input 244 x 244 x 3)==</p>
<p>SSD在VGG16后添加6个辅助卷积层，这六层一共进行8732次预测。</p>
<p>参考论文给出的下图，可见使用Multi-scale feature maps对精度提升显著。</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_3.17.11_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_3.17.11_PM.png"></p>
<p>==Fig.4 Multiple output layer at different resolutions is better.==</p>
<p>对照实验，尽量控制Boxes的数量均衡。删除某一层后，会把该层的default box挂载到余下层并进行调整。</p>
<h3 id="Multi-scale-feature-map-for-detection"><a href="#Multi-scale-feature-map-for-detection" class="headerlink" title="Multi-scale feature map for detection."></a><strong>Multi-scale feature map for detection.</strong></h3><p>VGG中的Conv5_3以及后续添加的辅助层，用于用多种尺度进行特征提取【检测 + 分类】。最终进行预测的是这些层中选出的特定层。每个层对应不同的scale和不同的aspect ratios的bounding box进行预测。【后文会详细介绍】</p>
<h3 id="Convolutional-predictors-for-detection"><a href="#Convolutional-predictors-for-detection" class="headerlink" title="Convolutional predictors for detection."></a><strong>Convolutional predictors for detection.</strong></h3><p>每一个添加的feature layer通过使用一系列卷积层【convolutional filters】生成一系列预测结果。假设一个feature layer层的尺寸为m x n x p 【p为channel】，那么卷积核为3 x 3 x p，即一个detector/classifier 的参数量，它输出对应类别的得分或相对default box的坐标偏移量。对于m x n中卷积核的每一个bouding box，都会生成一个预测值。</p>
<h3 id="Default-boxes-and-aspect-ratios"><a href="#Default-boxes-and-aspect-ratios" class="headerlink" title="Default boxes and aspect ratios."></a><strong>Default boxes and aspect ratios.</strong></h3><p>对于每个feature map cell，都会关联k个boxes【也作prior box】，对于每个box都要输出C个类别和4个坐标偏移量【相对于default box】。因此对于每个cell，会产生(C + 4)k个输出，feature map共有m x n个cell，共产生(C + 4)kmn个输出，因此feature map共产生8732个输出。</p>
<p><strong>Non-Maximum Suppression (NMS)</strong></p>
<p>通过非极大抑制来控制噪声，确保网络保留最有效的几个预测，丢弃噪声较大的预测。</p>
<h3 id="MultiBox-Priors-and-IoU"><a href="#MultiBox-Priors-and-IoU" class="headerlink" title="MultiBox Priors and IoU."></a><strong>MultiBox Priors and IoU.</strong></h3><p>In MultiBox, the researchers created what we call priors (or anchors in Faster-R-CNN terminology), which are pre-computed, fixed size bounding boxes that closely match the distribution of the original ground truth boxes.In fact those priors are selected in such a way that their Intersection over Union ratio (aka IoU, and sometimes referred to as Jaccard index) is greater than 0.5.</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Untitled%201.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Untitled%201.png"></p>
<p>==Fig.5 IoU Explaination==</p>
<h2 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h2><p><img src="https://superming.life/2021/01/28/SSD-Notes/Untitled%202.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Untitled%202.png"></p>
<p>==Fig.6 SSD训练流程==</p>
<h3 id="Matching-strategy"><a href="#Matching-strategy" class="headerlink" title="Matching strategy."></a><strong>Matching strategy.</strong></h3><p>在训练过程中，需要确定默认框【default box】与真值框【Ground truth box】以及和训练网络的相关性。这些default box随着cell、aspect ratio和scale的不同而变化，我们通过将真值框与默认框之间的重合度定义一个值【IOU &gt; 0.5】，重合度高于IOU的样本便是正样本，参与后续的训练。这就是SSD的匹配策略，在YOLO，Faster R-CNN中都有使用。</p>
<h3 id="Training-objective"><a href="#Training-objective" class="headerlink" title="Training objective."></a><strong>Training objective.</strong></h3><p>SSD的Training objective 源于MultiBox objective ，但可以拓展到多个对象级别。</p>
<p>总的损失函数包含了localization loss（loc）和 confidence loss（conf），包含了定位和分类。</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_11.44.35_AM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_11.44.35_AM.png"></p>
<ul>
<li>N是匹配成功的正样本数量。N = 0， Loss = 0。</li>
<li>$\alpha$ 是定位损失和分类损失之间的比重，通过交叉验证设为1。</li>
<li>l表示bounding box 与 default box之间的变换关系，g代表ground truth box和default box之间的变换关系。</li>
<li>$x^p_{ij}=\left { 0,1 \right}$ 即x 参数，表示第i个default box与种类p的第j个ground truth box是否匹配，匹配则为1，否则为0。</li>
</ul>
<p><strong>和Faster R-CNN类似，定位损失使用Smooth L1 loss</strong></p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_11.56.16_AM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_11.56.16_AM.png"></p>
<p><strong>分类损失：Softmax loss</strong></p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_11.57.06_AM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_11.57.06_AM.png"></p>
<p><em>由公式可见，分类损失包含正负样本，而定位损失只包含正样本。因为对定位来说，需要回归出准确的变换关系，在预测的时候是不需要区分正负样本的。而分类是需要区分出正负样本的。</em></p>
<p>深入理解：</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_2.51.50_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_2.51.50_PM.png"></p>
<p>对于每一个Prior box，尽可能希望它能够回归到Ground Truth中，该过程需要损失层帮助我们计算真实值和预测值之间的走向，从而引导后续学习。</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_2.55.59_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_2.55.59_PM.png"></p>
<p>如上图，只要$l<em>{*}$与$g</em>{<em>}$接近，那么prediction box和ground truth就接近。$g_{</em>}$在训练时产生，$l_{*}$在interface时产生。</p>
<p><strong>Detector/Classifier对一个bounding box的回归的举例：</strong></p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_4.11.34_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_4.11.34_PM.png"></p>
<p><em>红色虚线框为未回归前的bounding box，实线框为回归后的bounding box。</em></p>
<p>而所有回归后的bounding box是一个很杂乱的场景，需要通过NMS筛选出部分高可用的数据，如下图：</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_4.13.45_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_4.13.45_PM.png"></p>
<p>每一个detector/class 输出部分可靠数据，所有feature map的detector/classes 的输出再次进行NMS后即最终的输出结果。【对应Fig.1】</p>
<h2 id="Choosing-scales-and-aspect-ratios-for-default-boxes"><a href="#Choosing-scales-and-aspect-ratios-for-default-boxes" class="headerlink" title="Choosing scales and aspect ratios for default boxes"></a>Choosing scales and aspect ratios for default boxes</h2><blockquote>
<p>We design the tiling of default boxes so that specific feature maps learn to be responsive to particular scales of the objects.</p>
</blockquote>
<p>此处的重点是default boxes生成规则。</p>
<p>与Region proposals类似，default box是bounding box的初始参考。而生成的bounding数量尺寸受到超参scale 和 aspect ratios 控制。所以为了保证生成不同尺寸的bounding box，scale 和 aspect ratios都是不同的。</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_1.57.24_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_1.57.24_PM.png"></p>
<p>如上图所示，b和c分别代表不同尺度的feature map（8 x 8 和 4 x 4）同时aspect ration 和 scale也是不一样的。同一个feature layer中cell的scale固定，根据不同的aspect ration生成不同尺寸的bounding box。</p>
<p>目标检测的第一层conv4_3为38 x 38，相较于input Image有来很大的下滑。导致SSD在检测小物体上相对于其他目标检测算法效果不是很理想。</p>
<p>If it is a problem, we can mitigate it by using images with higher resolution. </p>
<p>使用高分辨率的图像可以缓解。</p>
<blockquote>
<p>Q：高分辨率的input Image，相对第一层feature map的尺寸将会有更大的下滑，对小物体愈加不友好？<br>A：高分辨率是相对像素密度的提升，假设图像尺寸不变，像素密度提升，给出的图片信息越多。那么对小物体检测有什么提升呢？更detector/classifier容易回归？或是提升feature map像素密度的意思？</p>
</blockquote>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Untitled%203.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Untitled%203.png"></p>
<h3 id="Default-box-generator"><a href="#Default-box-generator" class="headerlink" title="Default box generator"></a>Default box generator</h3><p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_10.24.46_AM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_10.24.46_AM.png"></p>
<p>Default boxes生成</p>
<p>上图参数：原图300 x 300；Feature map 5 x 5， #default boxes = 3， min_size = 168, aspect_ration = 2。</p>
<p>左图中红点即cell。根据168 x 168的default box和aspect_ratio生成不同尺度的prior box。</p>
<p><strong>Cell的确定：</strong></p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_2.23.04_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_2.23.04_PM.png"></p>
<p>其中$f_{k}$ 为第k张feature map的大小。+0.5是为了将cell放到格子中间。</p>
<blockquote>
<p>By combining predictions for all default boxes with different scales and aspect ratios from all locations of many feature maps, we have a diverse set of predictions, covering various input object sizes and shapes.</p>
</blockquote>
<p>一系列的default box作为bounding box的初始参考，根据不同的scale和aspect ratio生成各种尺寸，各种形状的bounding box，能够覆盖大部分尺寸和大小的目标物体。如Fig.1 所示，4 x 4的feature map中红框圈出了狗狗，猫作为负样本被舍弃，而8 x 8的feature map仅圈出了猫，狗作为负样本被舍弃，可见不同feature map负责预测的物体尺寸不同。</p>
<p>论文指出，关于default box的设置是一个开放性研究内容，可以作为优化的一个考虑点。</p>
<blockquote>
<p>In practice, one can also design a distribution of default boxes to best fit a specific dataset. How to design the optimal tiling is an open question as well.</p>
</blockquote>
<p><strong>Scale的选择：</strong></p>
<p>论文中给出如下计算公式：</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_2.12.22_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_2.12.22_PM.png"></p>
<ul>
<li>$S<em>{min} = 0.2，S</em>{max}= 0.9$ ，最底层的scale为0.2，最高层的scale为0.9。</li>
<li><p>中间层的scale按照公式递增。</p>
</li>
<li><p>每个feature layer负债总额对不同面积大小的目标进行预测。</p>
</li>
</ul>
<p><strong>Aspect ratio的选择：</strong></p>
<p>由上图可见，bounding box的长宽比（aspect ratio）也是在不断变化的，SSD如何确定aspect ratio？</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_2.16.34_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_2.16.34_PM.png"></p>
<h2 id="Hard-negative-mining"><a href="#Hard-negative-mining" class="headerlink" title="Hard negative mining"></a>Hard negative mining</h2><p>难例挖掘：通过matching strategy后，存在大量default boxes为负样本，导致严重的正负样本不平衡，导致训练过程中很难收敛。作者通过对每个default box的confidence loss进行排序，选取高loc的几个负样本，使正负样本比例保持在3:1左右，大大加快了优化速率和训练的稳定性。</p>
<h2 id="Data-augmentation"><a href="#Data-augmentation" class="headerlink" title="Data augmentation"></a>Data augmentation</h2><p>为了增加模型的鲁棒性，使用如下策略进行数据增强：</p>
<ul>
<li>使用原图</li>
<li>在原图上随机采样多个patch，与物体之间的IOU进行样本的判定，定义为0.1，0.3，0.5，0.7，0.9。</li>
<li>采样的patch比例为[0.3, 1.0], aspect ration在0.5或2。</li>
<li>以0.5的概率随机水平翻转。</li>
<li>GT box中心在采样patch中面积大于0.</li>
</ul>
<p>数据增强后的表现：</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_3.23.21_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_3.23.21_PM.png"></p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_3.24.12_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_3.24.12_PM.png"></p>
<p>数据增强使用了random crop &amp; color distortion 和 random expansion。对预测精度提升显著，达8.8%。作者认为SSD的数据增强方式对Fast &amp; Faster R-CNN提升不大，因为后者使用的ROI池化本身对目标平移很敏感。</p>
<p>而显然使用更多的default box会产生更好的精度。</p>
<p>Atrous Convolution：指<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/50369448">空洞卷积</a>。</p>
<h2 id="Inference-time"><a href="#Inference-time" class="headerlink" title="Inference time"></a>Inference time</h2><p>SSD会生成大量的Boxes，所以使用NMS是必要的，并且能够大大减小工作时间。</p>
<p>SSD与其他目标检测算法进行比较，在mAP和FPS上都达到了比较优秀的效果。因此SSD可以使用相对较低分辨率从而达到类似的准确率。</p>
<p><img src="https://superming.life/2021/01/28/SSD-Notes/Screen_Shot_2021-01-28_at_7.32.03_PM.png" alt="SSD%EF%BC%9ASingle%20Shot%20MultiBox%20Detector%20Notes%209c6d1d0f6b01440b8da4dac4d5ca7769/Screen_Shot_2021-01-28_at_7.32.03_PM.png"></p>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><ul>
<li>更多default boxes可以增加预测的准确性，但是对检测速度有较大影响。</li>
<li>SSD训练过程中80%的时间花费在VGG-16上：这意味着如果使用更高效的网络，能够提高SSD的性能。</li>
<li>SSD会混淆相似类别的对象。可能是多个类别共享位置导致的。因为我们使用相同的bounding box去做类别分类的预测。</li>
<li>SSD-500（input 512 x 512）在voc07上获得高达76.8的mAP，但fps掉为22fps。</li>
<li>SSD在较小图像上的性能不佳，增加输入的分辨率可能缓解问题，但不能彻底解决。</li>
<li>COCO数据集有很多小物体，要提升准确率，使用小一点的default boxes（start with a smaller scale at 0.15）</li>
<li>设计更好的boundary boxes会提升准确率。</li>
</ul>
<hr>
<p>To improve accuracy, SSD introduces:</p>
<ul>
<li>small convolutional filters to predict object classes and offsets to default boundary boxes.</li>
<li>separate filters for default boxes to handle the difference in aspect ratios.</li>
<li>multi-scale feature maps for object detection.</li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1512.02325.pdf">SSD论文地址</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/weiliu89/caffe/tree/ssd">SSD源码</a></p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1409.1556">VGG16</a></p>
<p><a target="_blank" rel="noopener" href="https://arleyzhang.github.io/articles/786f1ca3/">研究SSD博客</a></p>
<p><a target="_blank" rel="noopener" href="https://jonathan-hui.medium.com/ssd-object-detection-single-shot-multibox-detector-for-real-time-processing-9bd8deac0e06#:~:text=SSD%20is%20a%20single%2Dshot,offsets%20to%20default%20boundary%20boxes.">Jonathan Hui: SSD object detection: Single Shot MultiBox Detector for real-time processing</a></p>
<p><a href>Understanding SSD MultiBox</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.google.com/presentation/d/1rtfeV_VmdGdZD5ObVVpPDPIODSDxKnFSU0bsN_rgZXc/pub?start=false&amp;loop=false&amp;delayms=3000&amp;slide=id.g179f601b72_0_51">很不错的俄文PPT</a>  &amp;&amp; <strong><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=P8e-G-Mhx4k">视频</a></strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2021/01/17/Weekly-Report-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2021/01/17/Weekly-Report-1/" itemprop="url">Weekly Report 1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-01-17T22:00:00+08:00">
                2021-01-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/Life/" itemprop="url" rel="index">
                    <span itemprop="name">Life</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2021/01/17/Weekly-Report-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2021/01/17/Weekly-Report-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2021/01/17/Weekly-Report-1/" class="leancloud_visitors" data-flag-title="Weekly Report 1">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Weekly-Report-1"><a href="#Weekly-Report-1" class="headerlink" title="Weekly Report 1"></a>Weekly Report 1</h1><blockquote>
<p>2021.1.11 - 2021.1.17</p>
</blockquote>
<p><img src="https://superming.life/2021/01/17/Weekly-Report-1/129EDA66-4FCF-4D3F-A744-116C3E5FEF4B_1_105_c.jpeg" alt="Weekly-Report-01/129EDA66-4FCF-4D3F-A744-116C3E5FEF4B_1_105_c.jpeg"></p>
<h2 id="Books"><a href="#Books" class="headerlink" title="Books"></a>Books</h2><p>《<a target="_blank" rel="noopener" href="https://book.douban.com/subject/27056409/">深度工作 如何有效使用每一点脑力</a>》by <a target="_blank" rel="noopener" href="https://www.calnewport.com/">Cal NewPort</a>。在Goodreads上：4.2 / 5。作者是MIT的计算机科学博士及乔治城大学计算机科学副教授。</p>
<p>书本的重点论证了深度工作（deep work）在当前知识社会背景下的重要性，甚至可以说深度工作的能力是当前信息社会中一个人的核心竞争力。书本分为理论和准则两部分，前半部分论证深度工作的价值和意义，后部分向读者介绍深度工作的准则和方法。作者论证比较严谨，深度上有所欠缺，或许少了点说服力，像是一本深度工作的入门说明书。换个角度来看，深度工作的能力是需要长年累月，并通过不断训练调整才能达到的高度，而真正的深度工作者并不需要这样一本书，受众更多是想要进行深度工作并对生活进行改变的人群，比较推荐有以上想法的朋友阅读。书中的一些建议挺有借鉴意义，比如远离社交媒体这一准则，我也用相对更适合自己的方式调整了自己社交媒体使用限制等，得到了很好的正反馈。</p>
<!--- more  --->
<ul>
<li>阅读过程中的部分笔记：</li>
</ul>
<p>关于深度工作和浮浅工作的概念：</p>
<p><strong>深度工作</strong>：在无干扰的状态下专注进行职业活动，使个人的认知能力达到极限。这种努力能够创造价值，提升技能，而且难以复制。</p>
<p><strong>浮浅工作</strong>：对认知要求不高的事务性任务，往往在受到干扰的情况下开展。此类工作通常不会为世界创造太多新价值，且容易复制。</p>
<p>当代知识工作者的主要问题在于：他们并非游手好闲，甚至异常忙碌。根据麦肯锡的调查发现：知识工作者60%时间使用电子沟通和网络搜索。</p>
<p>Notes：所以假设一天工作时间为8小时，除去这些支离破碎的状态，只剩下3.2小时给你完成自己的工作或进入深度工作的状态。<strong>不得不让人思考网络工具的出现是否真正提升了知识工作者的工作效率？</strong>  而学习本身是一项需要高度专注并高效产出的一项活动，而当前多数工作也是需要不断学习精进的。所以如何高效学习、深度工作其实在每个人、甚至社会经济价值上扮演者很重要的角色。</p>
<p>刻意练习的核心要素通常如下：</p>
<ol>
<li>你的注意力全情投入到某个你希望提升的技能或想要掌握的理念上。</li>
<li>你能得到反馈意见，这样你就可以调整自己的方法，保持注意力的投入有最佳产出。</li>
</ol>
<p>高质量的工作 = 专注度 X 时间</p>
<p>Notes：很多人会忽视一个重要的事实：每个人的注意力、意志力是有限的，并且会在使用过程中不断被消耗，像肌肉一般会疲劳。设想一个环境：你在一个某天的下午胡乱浏览各种社交APP、流连各种短视频，此时你意识到自己荒废了大量时间，才想要开始学习，而学习是一项需要高认知高专注的任务，需要抽取你大量的注意力和意志力才能将工作继续下去，所以往往在这种状态下进行学习会有很大的失败率，不出意外你会安慰自己：明天在学吧… 往往当大脑习惯了随时分心，在你想要专注的时候，很难摆脱这种习惯。</p>
<p>最小阻力原则（The Priniciple of Least Resistance）：在工作环境下，若各种行为对于底线的影响没有得到明确的反馈意见，我们倾向于采用当下最简单易行的行为。</p>
<p>任何益处法：一旦发现使用一款网络工具有任何益处，或者不使用就可能错过某些事，你就觉得有足够理由使用这款网络工具。</p>
<p>Notes：以上是作者用来解释大家为什么会对社交媒体青睐的原因。互联网工具的出现和高速发展导致了技术垄断（Technoploy）的出现。社交媒体带来的那一点益处，会让人忽略其背后强大的致隐性。不作展开，引用尼尔波兹曼在20世纪90年代的文章：“我们不再权衡新科技的利弊，不再平衡新增效率和新引入问题之间的关系，我们开始自认为的认定，只要是高科技就是好的，不用再做探讨。”</p>
<p>…</p>
<ul>
<li>相关阅读：</li>
</ul>
<p>万维钢 《高手》</p>
<p>James Clear《原子习惯》</p>
<h2 id="Thoughts"><a href="#Thoughts" class="headerlink" title="Thoughts"></a>Thoughts</h2><p>关于如何保持高效这个问题也曾长时间困扰自己，甚至可以说整个大学期间一直在寻找适合自己的学习方法，也渐渐的从长时间低效甚至无效学习转移到现在相对高效并更令自己满意的状态，也希望自己能够不断调整优化。借这个机会简单梳理几点对自己的效率有很大提升的改进或习惯。</p>
<ul>
<li>与互联网保持一点点的距离</li>
</ul>
<p>与互联网保持一定的距离。这个习惯耗费了大量的精力和意志力去克服，但收益巨大。</p>
<p>我开始意识到这个问题的时候就从问自己为什么要使用它入手，如果没有他对我个人利弊影响如何…如下</p>
<p>为什么需要这个那个社交媒体？带来了什么？</p>
<p>我习惯于用工具思维来理解东西。将某一新科技或新事物定义为你完成特定任务的工具，仅在需要的时候去使用它，That’s it。如果你没有明确目的去使用它，它就是一个无限汲取你时间精力的黑洞。</p>
<p>举例：</p>
<p>为什么要使用微博？</p>
<ul>
<li>能够关注到一些朋友的动向。保持浅层联系。【微信朋友圈同】</li>
<li>我喜欢的作家、优秀工程师一般会通过在微博上发表一些比较深度的想法，部分想法促进我个人思考，对个人成长价值。【但总体上有价值的信息密度不高】</li>
</ul>
<p>以上是我使用微博的原因。是我用来与朋友保持浅层关系【浅层关系，也绝非社交重心】和关注行业（兴趣）动向的一个工具，但也不是我获取信息的主要途径，所以我对微博的使用率一直很低。</p>
<p>为什么使用微信？</p>
<p>微信底层基础是即时通讯。将人与人连接了起来，依靠社交和超强用户粘性发展到如今all-in-one的平台。即时通信让人们的沟通变得更快速，就我而言，人与人之间的沟通是快了，也降低了人们闲聊的成本，多数沟通也并未因此变得高效……而作为学生，并没有那么重要的消息需要我停止当前的工作状态去立即回复，即时通讯对我并没有那么重要，仅仅作为一个能够保持联系的渠道而已。</p>
<ul>
<li>通讯渠道。</li>
<li>部分信息渠道。【公众号关注的一些高质量的信息】</li>
</ul>
<p>可能大家会认为人难免避免社交啊balabala的，社交与每个人的意义都不一样。那我举例， 我的社交对象就那么几个，每天在上面花费的时间也不多，并不喜欢微信的产品设计与更全能的定位【KPI=用户使用时长】。权衡后将通讯平台迁移到Apple自带的iMessage上，纯粹的聊天工具，用完即走能够避免很大的干扰，很多信息没有你想象中的那么重要。</p>
<p>用工具思维去定义了我的手机以及我手机上的各种应用。一般只有在想到要做什么事情的时候，才会用手机上对应的功能去完成这件事。所以手机使用每周一般会维持在一个相对较低的时长，省下了大把漫无目的冲浪的时间去专注于更重要的事情。</p>
<p>总的来说，互联网带来的益处是不可否认的，或许一些网络工具可以不错过某些热点、大事，除此之外，一些工具所带有的致瘾性却往往会被大家所忽略。权衡利弊之后在去使用这些工具，生活会好很多吧。</p>
<p>“和这个普遍联系的世界有一点点失联。”</p>
<ul>
<li>Habits Tracker</li>
</ul>
<p>以前在电子笔记本上进行习惯记录，时不时就忘了。上周制作了Habit Tracker的习惯记录表格，夹线圈笔记本中发现意外的好用，满意度大大的上升。</p>
<p>部分目前正在养成的习惯 [完成时长 / 计划开始时长]：</p>
<p>Sleep without Phone：8 days / 9 days</p>
<p>Reading before Bed：6 days / 6 days </p>
<p>Plan  in the morning: 6 days / 6days</p>
<p>以下为模版：</p>
<p><img src="https://superming.life/2021/01/17/Weekly-Report-1/Screen_Shot_2021-01-19_at_11.32.10_AM.png" alt="Weekly-Report-01/Screen_Shot_2021-01-19_at_11.32.10_AM.png"></p>
<p>下载链接：</p>
<p>Google Drive:</p>
<p><a target="_blank" rel="noopener" href="https://drive.google.com/drive/folders/1zxSFZv1Dt1g9_-fO37JxI1vPoM5OANVE?usp=sharing">Habits Tracker - Google Drive</a></p>
<p>Baidu :</p>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1thTcU1wZgacEAs4E38qRCg">https://pan.baidu.com/s/1thTcU1wZgacEAs4E38qRCg</a> 密码: e4vr</p>
<h2 id="Explore"><a href="#Explore" class="headerlink" title="Explore"></a>Explore</h2><p><strong>高德纳的Homepage</strong>：</p>
<p><a target="_blank" rel="noopener" href="https://www-cs-faculty.stanford.edu/~knuth/">Don Knuth’s Home Page</a></p>
<p><strong>Teach Yourself Computer Science：</strong></p>
<p>如果想学习Computer Science，而网上有太多的信息与资源，如何取其精华，去其糟粕，这便是文章的重点：</p>
<ul>
<li>该学习哪些科目？为什么？</li>
<li><p>对于这些科目，目前为止最好的资源是什么？</p>
<p>  <img src="https://superming.life/2021/01/17/Weekly-Report-1/Screen_Shot_2021-01-18_at_3.57.37_PM.png" alt="Weekly-Report-01/Screen_Shot_2021-01-18_at_3.57.37_PM.png"></p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://teachyourselfcs.com/">Teach Yourself Computer Science</a></p>
<p><strong>一篇关于如何充分利用你所阅读内容的文章。【有时间翻译一下】</strong></p>
<ul>
<li>“Just as life is too short for bad wine, life is too short for bad books.”</li>
<li><p>Levels of Reading</p>
<p>  <img src="https://superming.life/2021/01/17/Weekly-Report-1/Screen_Shot_2021-01-18_at_3.40.57_PM.png" alt="Weekly-Report-01/Screen_Shot_2021-01-18_at_3.40.57_PM.png"></p>
</li>
<li><p>It’s not how fast you read but what you absorb that matters.</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://fs.blog/reading/">Reading Better</a></p>
<p>近期关注的点：</p>
<ul>
<li>消费主义<ul>
<li>特别关注的两个品牌：AllBirds和Patagonia。【消费也可以是一种选择】</li>
</ul>
</li>
<li>信息获取渠道的选择</li>
<li>克拉克硬科幻系列</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/" itemprop="url">Ubuntu18.04 Tensorflow 1.x</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-01-03T20:22:19+08:00">
                2021-01-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/CS/" itemprop="url" rel="index">
                    <span itemprop="name">CS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/" class="leancloud_visitors" data-flag-title="Ubuntu18.04 Tensorflow 1.x">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Ubuntu18-04-Tensorflow-1-x-安装（一）：Nvidia软件安装"><a href="#Ubuntu18-04-Tensorflow-1-x-安装（一）：Nvidia软件安装" class="headerlink" title="Ubuntu18.04 Tensorflow 1.x 安装（一）：Nvidia软件安装"></a>Ubuntu18.04 Tensorflow 1.x 安装（一）：Nvidia软件安装</h1><p>文章包含以下几个内容：</p>
<ul>
<li>Nvidia驱动安装</li>
<li>CUDA版本选择及安装</li>
<li>cuDNN选择及安装</li>
</ul>
<p>我的配置[参考]：</p>
<ul>
<li>GTX965M</li>
<li>Ubuntu18.04 LTS</li>
</ul>
<h2 id="Nvidia驱动安装"><a href="#Nvidia驱动安装" class="headerlink" title="Nvidia驱动安装"></a>Nvidia驱动安装</h2><p>需考虑：GPU硬件型号，GPU驱动，CUDA，TensorFlow，PyTorch以及CuDNN等适配信息。</p>
<ol>
<li><strong>检查GPU是否支持CUDA。这决定了你能否安装TensorFlow的GPU版本。</strong></li>
</ol>
<p>通过下面链接检查GPU是否支持CUDA，如果GPU能在列表中找到，即支持CUDA。</p>
<p><a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-gpus">CUDA GPUs</a></p>
<!--- more --->
<p>例如：我使用的GPU为GTX965M，相关信息能在Nvidia官网找到：</p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_4.09.17_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_4.09.17_PM.png"></p>
<p>计算能力5.2</p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_3.58.30_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_3.58.30_PM.png"></p>
<ol>
<li><strong>确定安装驱动的版本</strong></li>
</ol>
<p>下面链接可以查到GPU所对应操作系统可安装最新的驱动版本：</p>
<p><a target="_blank" rel="noopener" href="https://www.nvidia.com/Download/index.aspx">Download Drivers</a></p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_11.05.58_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_11.05.58_PM.png"></p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_8.27.17_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_8.27.17_PM.png"></p>
<p>接下来执行如下代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:graphics-drivers <span class="comment">#添加NVIDIA显卡的驱动库</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">ubuntu-drivers devices <span class="comment">#显示可安装的驱动版本</span></span><br></pre></td></tr></table></figure>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen Shot 2020-12-27 at 10.41.05 PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen Shot 2020-12-27 at 10.41.05 PM.png"></p>
<p>显示有390-455的版本，其中推荐安装455版本。</p>
<p>需要注意的是，在下一步安装CUDA时，<u>不同版本的CUDA对驱动版本有要求</u>，详细要求在<a href>Nvidia CUDA Compatibility</a>页面中进行查看。</p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_10.01.29_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_10.01.29_PM.png"></p>
<p><strong>如何确定安装的CUDA版本？</strong></p>
<p>CUDA的版本根据Tensorflow版本确定。如下图所示，假设要安装tensorflow_gpu-1.14.0版本，那么我需要安装的CUDA版本为10.0[10.1或9都不行，版本间一一对应]。<a href>检查Tensorflow对应版本</a>。</p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_10.12.59_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-24_at_10.12.59_PM.png"></p>
<p>综上，根据我要安装的tensorflow版本，需要安装CUDA10.0以及cuDNN7.4。</p>
<p>回到CUDA对驱动要求查看对应GPU驱动版本的要求：<code>&gt; = 410.48</code> 。</p>
<p>执行如下命令安装驱动：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt list nvidia-drivers* <span class="comment">#列出可安装的驱动版本</span></span><br><span class="line">sudo apt install nvidia-driver-450 <span class="comment">#安装450的驱动</span></span><br></pre></td></tr></table></figure>
<p>检验驱动是否安装完成：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_11.41.06_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_11.41.06_PM.png"></p>
<p>执行nvidia-smi显示如图表示驱动安装完成</p>
<p>训练时检测GPU使用情况：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -n 0.5 nvidia-smi  #即每隔0.5秒执行一次nvidia-smi；</span><br></pre></td></tr></table></figure>
<h2 id="CUDA安装："><a href="#CUDA安装：" class="headerlink" title="CUDA安装："></a>CUDA安装：</h2><p>在<a target="_blank" rel="noopener" href="https://developer.nvidia.com/Cuda-Toolkit-Archive">官方页面</a>中找到对应的CUDA版本</p>
<p><a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-10.0-download-archive">CUDA Toolkit 10.0 Archive</a></p>
<p>可以采用多种教程进行安装，根据给出的参考进行安装：</p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-27_at_12.26.44_AM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-27_at_12.26.44_AM.png"></p>
<p>选择deb(local)进行安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i cuda-repo-ubuntu1804-10-0-local-10.0.130-410.48_1.0-1_amd64.deb</span><br><span class="line">sudo apt-key add /var/cuda-repo-&lt;version&gt;/7fa2af80.pub</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install cuda</span><br></pre></td></tr></table></figure>
<p>安装完成：</p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_10.25.53_AM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_10.25.53_AM.png"></p>
<p><strong>CUDA配置</strong>：</p>
<p>执行<code>vim ~/.bashrc</code>在bash配置文件下添加：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># added by cuda 10.0 installer</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;/usr/local/cuda-10.0/bin:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="string">&quot;/usr/local/cuda-10.0/lib64:<span class="variable">$LD_LIBRARY_PATH</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>source ~/.bashrc</code><br><code>nvcc -V</code> 检查CUDA版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nvcc: NVIDIA (R) Cuda compiler driver</span><br><span class="line">Copyright (c) 2005-2018 NVIDIA Corporation</span><br><span class="line">Built on Sat_Aug_25_21:08:01_CDT_2018</span><br><span class="line">Cuda compilation tools, release 10.0, V10.0.130</span><br></pre></td></tr></table></figure>
<p><strong>检查CUDA是否正常工作：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cuda-install-samples-10.x.sh ~  <span class="comment">#安装cuda 10.x的样本到~目录下，替换x为你的版本号</span></span><br><span class="line"><span class="built_in">cd</span> ~/NVIDIA_CUDA-10.x_Samples  <span class="comment">#进入Sample目录</span></span><br><span class="line">make  <span class="comment">#有点耗时，如果系统版本不匹配，gcc版本可能会导致报错。</span></span><br><span class="line">./1_Utilities/deviceQuery/deviceQuery  <span class="comment">#执行检查程序</span></span><br></pre></td></tr></table></figure>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_12.12.08_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_12.12.08_PM.png"></p>
<p>结果出现Result==Pass表示通过，CUDA安装完成。</p>
<h2 id="安装cuDNN："><a href="#安装cuDNN：" class="headerlink" title="安装cuDNN："></a>安装cuDNN：</h2><p>CUDA10.0 对应cuDNN 7.4</p>
<p>在官方页面下载cuDNN【需注册Nvidia账号】，</p>
<p>下载<a target="_blank" rel="noopener" href="https://developer.nvidia.com/rdp/cudnn-archive">cuDNN v7.4.2 for CUDA 10.0</a></p>
<p>找到Ubuntu18.04 对应的deb包，并下载。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/Downloads  <span class="comment">#进入下载目录</span></span><br><span class="line">sudo dpkg -i libcudnn*  <span class="comment">#同时安装三个文件</span></span><br><span class="line"><span class="comment">#逐个安装执行如下三个命令</span></span><br><span class="line"><span class="comment">#sudo dpkg -i libcudnn7_7.6.5.32-1+cuda10.2_amd64.deb </span></span><br><span class="line"><span class="comment">#sudo dpkg -i libcudnn7-dev_7.6.5.32-1+cuda10.2_amd64.deb</span></span><br><span class="line"><span class="comment">#sudo dpkg -i libcudnn7-doc_7.6.5.32-1+cuda10.2_amd64.deb</span></span><br><span class="line"></span><br><span class="line">cp -r /usr/src/cudnn_samples_v7/ <span class="variable">$HOME</span>  <span class="comment">#复制样本文件到$HOME文件夹下</span></span><br><span class="line"><span class="built_in">cd</span>  <span class="variable">$HOME</span>/cudnn_samples_v7/mnistCUDNN  <span class="comment">#进入样本目录</span></span><br><span class="line">make clean &amp;&amp; make  <span class="comment">#编译</span></span><br><span class="line">./mnistCUDNN  <span class="comment">#执行cuDNN测试</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出 Test Passed表示cuDNN安装成功。</span></span><br></pre></td></tr></table></figure>
<h1 id="Ubuntu18-04-Tensorflow-1-x-安装（二）：TensorFlow及相关软件包安装"><a href="#Ubuntu18-04-Tensorflow-1-x-安装（二）：TensorFlow及相关软件包安装" class="headerlink" title="Ubuntu18.04 Tensorflow 1.x 安装（二）：TensorFlow及相关软件包安装"></a>Ubuntu18.04 Tensorflow 1.x 安装（二）：TensorFlow及相关软件包安装</h1><h2 id="使用原生pip安装"><a href="#使用原生pip安装" class="headerlink" title="使用原生pip安装"></a>使用原生pip安装</h2><p><strong>libcupti包下载：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install libcupti-dev</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;export LD_LIBRARY_PATH=/usr/local/cuda/extras/CUPTI/lib64:$LD_LIBRARY_PATH&#x27;</span> &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>
<p><strong>相关软件包下载</strong>：</p>
<p>注：我的Ubuntu系统使用python3.6版本，通过<code>python -V</code>查看。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install python3-pip python3-dev python3-numpy python3-wheel ****<span class="comment"># for Python 3.n</span></span><br></pre></td></tr></table></figure>
<p><strong>下载指定版本的TensorFlow：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python 3.x</span></span><br><span class="line">$ pip3 install tensorflow==1.14.0 <span class="comment"># cpu version </span></span><br><span class="line">$ pip3 install tensorflow-gpu==1.14.0 <span class="comment">#gpu version</span></span><br><span class="line"><span class="comment"># Python 2.x</span></span><br><span class="line">$ pip install tensorflow==1.14.0 <span class="comment"># cpu version </span></span><br><span class="line">$ pip install tensorflow-gpu==1.14.0 <span class="comment">#gpu version</span></span><br></pre></td></tr></table></figure>
<p>备用方法：如果以上安装失败或者有报错，可以选择指定<code>tfBinaryURL</code>的形式进行安装。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://pypi.org/project/tensorflow/">CPU Version</a></li>
<li><a target="_blank" rel="noopener" href="https://pypi.org/project/tensorflow-gpu/">GPU Version</a></li>
</ul>
<p>根据TensorFlow版本、操作系统以及Python版本确定.whl文件。使用如下命令进行安装：</p>
<ul>
<li>可以直接安装，也可以在Virtualenv环境中安装。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python 2.x</span></span><br><span class="line">$ sudo pip  install --upgrade tfBinaryURL   </span><br><span class="line"><span class="comment"># Python 3.x</span></span><br><span class="line">$ sudo pip3 install --upgrade tfBinaryURL  </span><br></pre></td></tr></table></figure>
<p><strong>卸载：</strong></p>
<p>使用pip安装的TensorFlow可以使用如下命令卸载：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python 2.x</span></span><br><span class="line">$ sudo pip uninstall tensorflow </span><br><span class="line"><span class="comment"># Python 3.x</span></span><br><span class="line">$ sudo pip3 uninstall tensorflow</span><br></pre></td></tr></table></figure>
<h2 id="使用Anaconda安装TensorFlow"><a href="#使用Anaconda安装TensorFlow" class="headerlink" title="使用Anaconda安装TensorFlow"></a>使用Anaconda安装TensorFlow</h2><h3 id="Anaconda安装"><a href="#Anaconda安装" class="headerlink" title="Anaconda安装"></a>Anaconda安装</h3><p>在<a target="_blank" rel="noopener" href="https://www.anaconda.com/products/individual#Downloads">官网</a>下载64位Linux版本的<strong>Anaconda</strong>。</p>
<p>执行如下命令进行安装。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ bash Anaconda3-2020.11-Linux-x86_64.sh</span><br><span class="line">$ <span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>验证：运行python时，显示的内容如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ python</span><br><span class="line">Python 3.6.0 |Anaconda 4.3.0 (64-bit)| (default, Dec 23 2016, 12:22:00) </span><br><span class="line">[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)] on linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>查看下面图表，确定TensorFlow版本对Python版本的要求。【我使用Python 3.6】</p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_7.27.01_PM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-26_at_7.27.01_PM.png"></p>
<h3 id="TensorFlow安装"><a href="#TensorFlow安装" class="headerlink" title="TensorFlow安装"></a>TensorFlow安装</h3><p><strong>Anaconda安装</strong></p>
<p>在Anaconda中，我们使用conda创建一个虚拟环境，并在该环境中安装TensorFlow。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 建立一个名为tensorflow的conda虚拟环境，同时指定运行的Python版本为3.6</span></span><br><span class="line">$ conda create -n tensorflow pip python=3.6</span><br><span class="line"><span class="comment"># 安装完成后使用命令激活conda环境</span></span><br><span class="line">$ conda acticate tensorflow</span><br><span class="line">(tensorflow)$ <span class="comment"># 表示进入了名为tensorflow的虚拟环境中</span></span><br></pre></td></tr></table></figure>
<p>接下来可以选择在线安装或者本地安装：</p>
<ol>
<li>在线安装[简单]</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install tensorflow==1.14.0  <span class="comment"># CPU 版本</span></span><br><span class="line">pip install tensorflow-gpu==1.14.0 <span class="comment"># GPU版本</span></span><br></pre></td></tr></table></figure>
<ol>
<li>本地安装</li>
</ol>
<p>在<a target="_blank" rel="noopener" href="https://pypi.org/project/tensorflow-gpu/#files">pypi-tensorflow</a>网站找到对应的whl文件，下载后使用<code>pip install</code>执行即可。</p>
<p>附：conda的简单使用：[参考<a target="_blank" rel="noopener" href="https://docs.conda.io/projects/conda/en/latest/user-guide/cheatsheet.html">conda-cheatsheet</a>]</p>
<p><img src="https://superming.life/2021/01/03/Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-27_at_1.22.23_AM.png" alt="Ubuntu18.04+Tensorflow-1.x/Screen_Shot_2020-12-27_at_1.22.23_AM.png"></p>
<h2 id="使用Virtualenv安装"><a href="#使用Virtualenv安装" class="headerlink" title="使用Virtualenv安装"></a>使用Virtualenv安装</h2><p>Virtualenv顾名思义是Python的虚拟环境，独立于其他环境【类似于conda】，不与其他Python程序相互影响。在Virtualenv虚拟出的环境中安装TensorFlow及相关依赖，只要激活该环境便可在该环境中运行TensorFlow。</p>
<p><strong>安装pip和Virtualenv：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python 2.x</span></span><br><span class="line">$ sudo apt-get install python-pip python-dev python-virtualenv </span><br><span class="line"><span class="comment"># Python 3.x</span></span><br><span class="line">$ sudo apt-get install python3-pip python3-dev python-virtualenv </span><br></pre></td></tr></table></figure>
<p>选择其中一条命令创建<a target="_blank" rel="noopener" href="https://virtualenv.pypa.io/en/latest/index.html">Virtualenv</a>的虚拟环境</p>
<ul>
<li><code>tragetDirectory</code>  : 自定义VIrtualenv根目录，我设置为<code>~/tensorflow</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python 2.x</span></span><br><span class="line">$ virtualenv --system-site-packages targetDirectory </span><br><span class="line"><span class="comment"># Python 3.x</span></span><br><span class="line">$ virtualenv --system-site-packages -p python3 targetDirectory </span><br></pre></td></tr></table></figure>
<p><strong>激活环境并安装TensorFlow</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> ~/tensorflow/bin/activate</span><br><span class="line"><span class="comment"># Make sure pip 8.1+ installed.</span></span><br><span class="line">(tensorflow)$ easy_install -U pip</span><br><span class="line"><span class="comment"># Download TensorFlow</span></span><br><span class="line">  <span class="comment"># CPU with pip or pip3</span></span><br><span class="line">(tensorflow)$ pip install --upgrade tensorflow     </span><br><span class="line">(tensorflow)$ pip3 install --upgrade tensorflow    </span><br><span class="line">  <span class="comment"># GPU with pip or pip3</span></span><br><span class="line">(tensorflow)$ pip install --upgrade tensorflow-gpu  </span><br><span class="line">(tensorflow)$ pip3 install --upgrade tensorflow-gpu</span><br></pre></td></tr></table></figure>
<p><strong>Others</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 激活环境</span></span><br><span class="line">$ <span class="built_in">source</span> ~/tensorflow/bin/activate</span><br><span class="line"><span class="comment"># 休眠环境</span></span><br><span class="line">(tensorflow)$ deactivate</span><br><span class="line"><span class="comment"># 卸载TensorFlow, 移除目录树即可</span></span><br><span class="line">rm -r targetDirectory</span><br></pre></td></tr></table></figure>
<h2 id="源代码构建"><a href="#源代码构建" class="headerlink" title="源代码构建"></a>源代码构建</h2><p>待补充…</p>
<h2 id="验证TensorFlow是否可用："><a href="#验证TensorFlow是否可用：" class="headerlink" title="验证TensorFlow是否可用："></a>验证TensorFlow是否可用：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip show tensorflow-gpu</span><br><span class="line">pip show tensorflow</span><br></pre></td></tr></table></figure>
<p>执行简单的Python程序：</p>
<p>在shell中输入<code>python</code>开启python</p>
<p>输入如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python</span></span><br><span class="line">import tensorflow as tf</span><br><span class="line">hello = tf.constant(<span class="string">&#x27;Hello, TensorFlow!&#x27;</span>)</span><br><span class="line">sess = tf.Session()</span><br><span class="line"><span class="built_in">print</span>(sess.run(hello))</span><br></pre></td></tr></table></figure>
<p>系统输出：<code>Hello, Tensorflow</code> ，表示TensorFlow可正常使用。</p>
<hr>
<h2 id="参考-amp-帮助"><a href="#参考-amp-帮助" class="headerlink" title="参考&amp;帮助"></a>参考&amp;帮助</h2><p><a target="_blank" rel="noopener" href="http://ejklike.github.io/2017/03/06/install-tensorflow1.0-on-ubuntu16.04-1.html">우분투 16.04에 텐서플로 1.0 설치하기 (1) Nvidia 소프트웨어 설치 (ft. GTX 970)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.tensorflow.org/install/gpu">GPU support | TensorFlow</a></p>
<p><a target="_blank" rel="noopener" href="https://medium.com/better-programming/install-tensorflow-1-13-on-ubuntu-18-04-with-gpu-support-239b36d29070">Install Tensorflow 1.13 on Ubuntu 18.04 with GPU support</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/143429249">简易记录：安装GPU驱动，CUDA和cuDNN</a></p>
<p><a target="_blank" rel="noopener" href="https://tensorflow.juejin.im/install/install_linux.html#toc-16">在 Ubuntu 上安装 TensorFlow</a></p>
<p><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/">anaconda | 镜像站使用帮助 | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a></p>
<h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h2><p>How to change the default Anaconda python environment?</p>
<p>如何指定python的pip下载【电脑中有多个版本的python和pip】<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/2812520/dealing-with-multiple-python-versions-and-pip">Dealing with multiple Python versions and PIP?</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The system default python:</span></span><br><span class="line">$ python -m pip install fish</span><br><span class="line"></span><br><span class="line"><span class="comment"># A virtualenv&#x27;s python:</span></span><br><span class="line">$ .env/bin/python -m pip install fish</span><br><span class="line"></span><br><span class="line"><span class="comment"># A specific version of python:</span></span><br><span class="line">$ python-3.6 -m pip install fish</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://github.com/AlenZhang-Dev/Learning-Records/blob/master/Machine%20Learning/Notes/Ubuntu18.04%20%2B%20Tensorflow%201.x%20.md">GitHub记录</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2020/11/24/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2020/11/24/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/" itemprop="url">深度学习基础1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-11-24T14:00:00+08:00">
                2020-11-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/CS/" itemprop="url" rel="index">
                    <span itemprop="name">CS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2020/11/24/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2020/11/24/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2020/11/24/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/" class="leancloud_visitors" data-flag-title="深度学习基础1">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-深度学习基础"><a href="#1-深度学习基础" class="headerlink" title="1. 深度学习基础"></a>1. 深度学习基础</h1><h1 id="简单概述"><a href="#简单概述" class="headerlink" title="简单概述"></a>简单概述</h1><p>深度学习应用于计算机视觉的两个关键思想：卷积神经网络和反向传播。</p>
<p>总的来说，以下三种力量在推动机器学习。</p>
<ol>
<li><p>硬件</p>
<p> CPU以及GPU上的大量投入。</p>
</li>
<li><p>数据集和基准</p>
</li>
<li><p>算法上的改进</p>
<p> 在2009-2010年出现了几个简单但很重要的算法改进，可以实现更好的梯度传播。以及更先进的有助于梯度传播的方法：批标准化，残差连接和深度可分离卷积。</p>
<p> 更好的神经层激活函数</p>
<p> 更好的权重初始化方案</p>
<p> 更好的优化方案</p>
</li>
</ol>
<!--- more --->
<h1 id="神经网络的数学基础"><a href="#神经网络的数学基础" class="headerlink" title="神经网络的数学基础"></a>神经网络的数学基础</h1><p>理解神经网络需要有很扎实的数学基础：张量，张量运算，微分，梯度下降等。因此对于神经网络的应用和理解需要分开进行，两种学习层级不在一个Level。</p>
<ul>
<li>侧重与应用，并尽量避免数学论证。</li>
</ul>
<h2 id="神经网络数据表示"><a href="#神经网络数据表示" class="headerlink" title="神经网络数据表示"></a>神经网络数据表示</h2><p><strong>张量</strong></p>
<p><strong>张量（Tensor）</strong>，张量是机器学习的基本数据结构。它是一个数据容器，包含的数据几乎总是数值数据，因此它是数字的容器。张量是矩阵向任意纬度的推【纬度dimension 也叫轴axis】</p>
<p><strong>标量（0D张量）</strong></p>
<p>仅包含一个数字的张量叫做标量（scalar）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.array(<span class="number">12</span>)</span><br></pre></td></tr></table></figure>
<p><strong>向量（1D张量）</strong></p>
<p>数字组成的数据叫做向量（vector）。矩阵有一个轴。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.array([<span class="number">12</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br></pre></td></tr></table></figure>
<p><strong>矩阵（2D张量）</strong></p>
<p>向量组成的数组叫做矩阵或者二维张量。矩阵有两个轴。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.array([[<span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">              [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">              [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br></pre></td></tr></table></figure>
<p><strong>3D张量与更高维张量</strong></p>
<p>将多个矩阵组合成一个新数组，得到一个3D张量，也就是立方体。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.array([[[<span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">               [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">               [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]],</span><br><span class="line">              [[<span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">               [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">               [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]]])</span><br></pre></td></tr></table></figure>
<p>深度学习一般处理0-4D的张量，处理视频的时候可能会遇到5D张量。</p>
<p><strong>关键属性</strong></p>
<p>张量是由以下三个属性定义的：</p>
<p><strong>轴的个数（阶）</strong>：例如，3D张量中有3个轴，矩阵有两个轴。在Numpy等Python库中叫张量的ndim。</p>
<p><strong>形状</strong>：表示张量沿着每个轴的纬度大小（元素个数）。例如，矩阵示例形状为（3，5），3D张量示例形状为（3，3，5）…</p>
<p><strong>数据类型：</strong>（在Python库中叫做dtype）。这是张量中所包含的数据类型【float 32 、uint 8、float 64等】，极少数情况下会遇到字符（char）张量。</p>
<p><strong>在Numpy中操作张量</strong></p>
<p>选择张量的特定元素叫做张量切片（tensor slicing）。</p>
<p>下面例子选择第10-100个数字（不包含100个），并将其放在形状为（90，28，28）的数组中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_slice = train_images[<span class="number">10</span>:<span class="number">100</span>]</span><br><span class="line">print(my_slice.shape)</span><br><span class="line"><span class="comment"># 以下等同于前面的操作</span></span><br><span class="line">my_slice = train_image[<span class="number">10</span>:<span class="number">100</span>, :, :]</span><br><span class="line">my_slice = train_image[<span class="number">10</span>:<span class="number">100</span>, <span class="number">0</span>:<span class="number">28</span>, <span class="number">0</span>:<span class="number">28</span>]</span><br></pre></td></tr></table></figure>
<p><strong>数据批量概念</strong></p>
<p>In normal，深度学习中所有数据张量的第一个轴（0轴）都是样本轴（sample axis）。在MINIST中，样本就是数字图像。</p>
<p>深度学习模型不会同时处理整个数据集。而是将数据拆分成小批量，批量大小为128。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">batch = train_image[:<span class="number">128</span>]</span><br><span class="line">batch = train_image[<span class="number">128</span>:<span class="number">256</span>]</span><br><span class="line"><span class="comment"># 第n个批量</span></span><br><span class="line">batch = train_image[<span class="number">128</span> * n : <span class="number">128</span> * (n + <span class="number">1</span>)]</span><br></pre></td></tr></table></figure>
<p>对于以上的批量张量，第一个轴（0轴）叫做批量轴（batch axis）或批量维度（batch dimension）。</p>
<h2 id="神经网络张量运算"><a href="#神经网络张量运算" class="headerlink" title="神经网络张量运算"></a>神经网络张量运算</h2><p>深度神经网络的所有变化都可以简化为数值数据上的张量运算（tensor operation）</p>
<p><strong>逐元素运算</strong><br>relu元素和加法都是逐元素（element-wise）的运算，即该运算独立应用于张量中的每个元素。也就是该运算非常适合大规模并行实现。（向量化实现）</p>
<p><strong>广播</strong></p>
<p>如果两个不同形状的2D张量相加，会发生什么？</p>
<p>如果没有歧义，较小的张量会会被广播（broadcast），以匹配较大张量的形状。广播包含以下两步：</p>
<ol>
<li>向较小的张量添加轴（叫做广播轴），使其ndim与较大张量相同。</li>
</ol>
<p>2.将较小的张量沿着新轴重复，使其形状与较大的张量相同。</p>
<p>举例：如果一个张量的形状是(a, b, … n, n  + 1, … m)，另一个张量的形状是(n, n + 1, …  m)，那么你通常可以利用广播对它们做两个张量之间的逐元素运算。广播操作会自动应用于a到n-1的轴。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.random.random((<span class="number">64</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">10</span>))</span><br><span class="line">y = np.random.random(<span class="number">32</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">z = np.maximum(x, y)</span><br><span class="line"><span class="comment"># 输出z的形状是（64， 3， 32， 10），与x相同。</span></span><br></pre></td></tr></table></figure>
<p><strong>张量点积</strong></p>
<p>点积运算，也叫张量积（tensor product），是最常见也是最有用的张量运算。与逐元素张量不同，它将输入张量元素合并在一起。</p>
<p>Numpy，Keras，Theano和TensorFlow中，都是使用 * 实现逐元素点积。</p>
<p>就是两个向量对应位置一一相乘后求和的操作，最后结果是一个标量，是一个实数值。</p>
<p>两个向量a = [a1, a2,…, an]和b = [b1, b2,…, bn]的点积定义为：</p>
<p>a·b=a1b1+a2b2+……+anbn。</p>
<p>张量变形</p>
<p>改变张量的行和列，得到想要的形状，变形后的张量元素总个数与初始张量相同。</p>
<p>前面用到的reshape函数就是张量变形的应用。</p>
<h2 id="梯度下降-suspended"><a href="#梯度下降-suspended" class="headerlink" title="梯度下降  [suspended]"></a>梯度下降  [suspended]</h2><p>关于梯度下降在这里不展开，以下为梯度下降的主要概念</p>
<ul>
<li>随机梯度下降。</li>
<li>小批量随机梯度下降 SGD</li>
<li>局部最小点（local minimum）</li>
<li>反向传播算法（Backpropagation）</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>学习</strong>是找到一组模型参数，在给定训练数据样本和对应目标值上的损失函数最小化。</p>
<p>学习过程中：随机选取包含数据小样本及其目标值的批量，并计算批量损失相对于网络参数的梯度，随后将网络参数沿着梯度反方向移动。</p>
<p>整个学习过程中之所以能实现，是因为神经网络是一系列可微分的张量运算，因此可以利用求导的链式法则来得到梯度函数，这个函数将当前的参数和当前数据批量映射为一个梯度值。</p>
<p>损失是在训练过程中需要最小化的量，因此应该能够衡量当前任务是否已成功解决。</p>
<p>优化器是使用损失梯度更新参数的具体方式，比如RMSProp优化器、带动量的随机梯度下降等。</p>
<h1 id="神经网络入门"><a href="#神经网络入门" class="headerlink" title="神经网络入门"></a>神经网络入门</h1><blockquote>
<p>本章通过三个典型的介绍性示例深入理解如何使用神经网络解决实际问题。分别为1. 将电影评论划分为正面或负面（二分类问题）2. 将新闻按主题分类（多分类问题） 3. 根据房地产数据估算房屋价格。</p>
</blockquote>
<h2 id="神经网络剖析"><a href="#神经网络剖析" class="headerlink" title="神经网络剖析"></a>神经网络剖析</h2><p><strong>主要介绍神经网络的核心组件：层、网络、目标函数和优化器。</strong></p>
<p><strong>神经网络主要围绕以下四个方面：</strong></p>
<p>层：多个层组合成网络（或模型）。</p>
<p>输入数据和相应的目标。</p>
<p>损失函数：即用于学习的反馈信号。</p>
<p>优化器：决定学习过程如何进行。</p>
<p><img src="https://superming.life/2020/11/24/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/Untitled.png" alt="深度学习基础/Untitled.png"></p>
<p><strong>多个层链接在一起组成了网络，将输入映射为预测值。然后损失函数将这些预测值与目标进行比较，得到损失值，用户衡量网络预测值与预期结果的匹配程度。优化器使用这个损失值来更新网络权重。</strong></p>
<p>神经网络的基本数据结构是层。层是一个数据处理模块，将一个或多个输入张量转换为一个或多个输出张量。</p>
<p><strong>层：深度学习的基本组件</strong></p>
<p>神经网络的基本数据结构是层。层是一个数据处理模块，将一个或多个输入张量转换为一个或多个输出张量。有权重的层称为有状态的层。权重是利用随机梯度下降学到的一个或多个张量。其中包含网络的知识。</p>
<p>不同张量个数与不同数据处理类型需要用到不同的层。例如，简单的向量数据保存在形状为（samples， features）的2D张量中，通常用密集连接层【Densely connected layer 】进行处理。序列数据保存在形状为（samples，timesteps，features）的3D张量中，通常用循环层（Recurrent Layer表示，比如Keras的LSTM层）</p>
<p>层兼容性（Layer compatibiltiy）具体指每一层只接受特定形状的输入张量，并返回特定形状的输入张量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line">layer = layers.Dense(<span class="number">32</span>, input_shape(<span class="number">784</span>, ))</span><br><span class="line"><span class="comment"># 创建一个层，有32个输出单元的密集层，同时只接受一个维度大小为784的2D张量作为输入。</span></span><br></pre></td></tr></table></figure>
<p>接上，上一层后面只能连接一个32维向量作为输入层，Keras会自动匹配输入层的形状。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line">model = models.Sequential()</span><br><span class="line">model.add(layers.Dense(<span class="number">32</span>, input_shape=(<span class="number">784</span>)))</span><br><span class="line">model.add(layers.Dense(<span class="number">32</span>))</span><br><span class="line"><span class="comment"># 第二层没有输入形状(input_shape)，可以自动推导出上一层的形状。</span></span><br></pre></td></tr></table></figure>
<p><strong>模型：由层构成的网络</strong></p>
<p>层构成的网络。</p>
<p>深度学习模型是层构成的有向无环图。</p>
<p>随着深入学习，会接触到更多类型的网络拓扑结构。</p>
<ol>
<li>双分支网络（two-branch）</li>
<li>多头网络（multihead）</li>
<li>Inception模块</li>
</ol>
<p><strong>损失函数与优化器</strong></p>
<p>一旦确定了网络架构，需要选择以下两个参数。</p>
<ol>
<li>损失函数（目标函数） — 在训练过程中需要将其最小化。他能够衡量当前任务是否成功完成。</li>
<li>优化器 — 决定如何基于损失函数对网络进行更新。它执行的是随机梯度下降（SGD）的某个变体。</li>
</ol>
<p><strong>具有多个输出的神经网络可能有多个损失函数。（每个输出对应一个损失函数）【但是梯度下降过程中必须基于单个标量损失值，因此对于具有多个损失函数的网络，需要将所有损失函数取平均，变为一个标量值】</strong></p>
<p>选取正确的目标函数对解决问题非常重要，网络的目的是使损失尽可能最小化。因此如果目标函数与成功完成当前任务不完全相关，那么网络最终得到的结果可能会不符合你的预期。因此对于常见的分类、回归、序列预测等常见问题，可以遵循一些简单的指导原则来选择正确的损失函数。</p>
<p>对于二分类问题：可以使用二元交叉熵（binary crossentropy）损失函数，对于多分类函数，可以使用分类交叉熵（categorical crossentropy），对于回归问题，可以使用均方误差（mean-squared error）对于序列学习问题，可以使用联结主义时序分类（CTC，connecttionist temporal classification）损失函数，等</p>
<h2 id="二分类问题"><a href="#二分类问题" class="headerlink" title="二分类问题"></a>二分类问题</h2><p>典型的二分类问题代码及解析：<a target="_blank" rel="noopener" href="https://github.com/AlenZhang-Dev/Learning-Records/blob/master/Machine%20Learning/Deep%20Learning%20with%20Python/3.4%20%E7%94%B5%E5%BD%B1%E8%AF%84%E8%AE%BA%E5%88%86%E7%B1%BB%E3%80%90%E4%BA%8C%E5%88%86%E7%B1%BB%E3%80%91.ipynb">使用IMDB进行电影评论分类</a></p>
<p>关于隐藏单元。一个隐藏单元是该层表示空间的一个维度。16个隐藏单元对应权重矩阵W的形状为（input_dimension）,与W做点击相当于输入数据投影到16维表示空间中。可以表示空间维度直观理解为“网络学习内部表示时所拥有的自由度。”隐藏单元越多，网络能够学到更复杂的表示，但网络的计算代价也越大，而且能够导致学到不好的模式。（能够提高训练数据上的性能，但不能提高测试集上的性能）</p>
<p><strong>构建网络</strong></p>
<p>对于Dense层的堆叠，需要有以下两个关键架构</p>
<ol>
<li>网络有多少层</li>
<li>每层有多少隐藏单</li>
</ol>
<p><strong>对于二分类问题的总结：</strong></p>
<ol>
<li><p>需要对原始数据进行大量的预处理，方便将其转换为张量输入到神经网络中。单词序列使用二进制向量编码，但也有别的编码方式。</p>
</li>
<li><p>带有relu激活的Dense层堆叠，可以解决很多种问题。</p>
</li>
<li><p>对于二分类问题，网络最后一层应该是只有一个单元并使用sigmoid激活的Dense层，网络输出应该是0～1范围内的标量，表示概率值。</p>
</li>
<li><p>对于二分类问题的sigmoid标量输出，应该使用binary_crossentropy损失函数。</p>
</li>
<li><p>无论问题是什么，rmsprop优化器通常都是足够好的选择。</p>
</li>
<li><p>随着神经网络在训练数据上的表现越来越好，模型最终会过拟合，所以需要监控模型在训练集之外的性能。</p>
</li>
</ol>
<p>什么是激活函数？为什么要使用激活函数？</p>
<p>如果没有relu等激活函数，Dense层将只包括两个线性运算—点积和加法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">output = dot(W, <span class="built_in">input</span>) + b</span><br></pre></td></tr></table></figure>
<p>这样Dense层就只能学习输入数据的线性变化：该层的假设空间是从输入数据到16位空间所有可能的线性变换集合。这种假设空间非常有限，无法利用多个表示层的优势，因为多个线性层堆叠实现的仍是线性运算，添加层数并不会扩展假设空间。</p>
<p>为了得到更丰富的假设空间，从而充分利用多层表示的优势，你需要添加非线性或激活函数。relu是深度学习中最常用的激活函数，但还有许多其他函数可选。</p>
<p>Q：Dense层堆叠的影响？</p>
<h2 id="多分类问题"><a href="#多分类问题" class="headerlink" title="多分类问题"></a>多分类问题</h2><p>相关重点参见：<a target="_blank" rel="noopener" href="https://github.com/AlenZhang-Dev/Learning-Records/blob/master/Machine%20Learning/Deep%20Learning%20with%20Python/3.5%20%E5%A4%9A%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E3%80%90%E6%96%B0%E9%97%BB%E5%88%86%E7%B1%BB%E3%80%91.ipynb">新闻分类：多分类问题</a></p>
<h2 id="标量回归问题"><a href="#标量回归问题" class="headerlink" title="标量回归问题"></a>标量回归问题</h2><p>相关重点参见：<a target="_blank" rel="noopener" href="https://github.com/AlenZhang-Dev/Learning-Records/blob/master/Machine%20Learning/Deep%20Learning%20with%20Python/3.6%20%E6%B3%A2%E5%A3%AB%E9%A1%BF%E6%88%BF%E4%BB%B7%E3%80%90%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98%E3%80%91.ipynb">波士顿房价预测</a></p>
<h1 id="机器学习基础"><a href="#机器学习基础" class="headerlink" title="机器学习基础"></a>机器学习基础</h1><blockquote>
<p>改进Plan：鉴于以下几个改进建议，用数据可视化进行表示。</p>
</blockquote>
<p>机器学习的四个分支：监督学习、无监督学习、自监督学习、强化学习。 </p>
<p>评估机器学习模型：<br>机器学习的目的是得到可泛化（generalize）的模型，即在前所未有的数据上表现很好的模型，而过拟合则是核心难点。</p>
<h2 id="训练集、验证集、测试集"><a href="#训练集、验证集、测试集" class="headerlink" title="训练集、验证集、测试集"></a>训练集、验证集、测试集</h2><p>评估模型的重点是将数据划分如下三个集合：<strong>训练集、验证集和测试集</strong>。在训练数据上训练模型，在测试集上评估模型，一旦找到了最佳参数，在测试数据上最后测试一次。</p>
<p>因为在开发模型时总是需要调整参数，比如选择层数或者每层大小【这叫做模型的超参数，以便与模型的参数分开】这个调节过程需要使用模型在验证数据集上的性能作为反馈信号，这个调节本质上也是一种学习：在某个参数空间中寻找良好的模型配置。如果基于模型在验证集上的性能来调节模型配置，会很快导致模型在验证集上过拟合，即使你没有在验证集上训练数据。这一现象叫做：信息泄露（information leak）</p>
<p>以下为主要三种经典评估方法：</p>
<ol>
<li>简单的留出验证集(hold-out validation)<br>这是最简单的评估方法，但是有一个缺点：如果可用的数据很少，那么可能验证集和测试集包含的样本太少，从而无法在统计学上代表数据。</li>
<li><p>K折验证</p>
<p> K折验证（K-fold validation）将数据划分为大小相同的K个分区。对于每个分区i，在剩余的K-1个分区中训练模型，然后在分区i上评估模型。最终分数等于K个分数的平均值。</p>
</li>
<li><p>带有打乱数据的重复K折验证</p>
<p> 如果可用数据相对较少，而你又需要尽可能精确地评估模型，那么可以选择带有打乱数据的重复K折验证(iterated K-fold validation with shuffling)。但这种方法一共要训练P X K个模型，计算代价很大。</p>
</li>
</ol>
<p>评估模型注意事项：</p>
<ol>
<li>数据代表性（data representativeness)</li>
<li>时间箭头(the arrow of time)</li>
<li>数据冗余(redundancy in your data)</li>
</ol>
<h2 id="数据预处理、特征工程和特征学习"><a href="#数据预处理、特征工程和特征学习" class="headerlink" title="数据预处理、特征工程和特征学习"></a>数据预处理、特征工程和特征学习</h2><p>神经网络的数据预处理</p>
<ol>
<li><p>向量化</p>
<p> 神经网络所有输入和目标都必须是浮点数张量。无论处理什么数据（声音、图像还是文本），都必须首先将其转换为张量，称为数据向量化（data vectorization）。例如前面进行的one-hot编码。</p>
</li>
<li><p>值标准化</p>
<p> 在手写数字分类的例子中，开始时图像被编码为0-255范围内的整数，表示灰度值。将这一数据输入网络之前，你需要将其转换为float32格式并除255，这样就得到0-1范围内的浮点数。</p>
<p> 一般来说，取值相对较大的数据（比如多位整数，比网络权重初始值大很多）或异质数据（heterogenrous data，比如数据的一个特征在0-1范围内，另一个特征在100-200范围内)，输入到神经网络中是不安全的。可能会导致较大的梯度更新，进而导致较大的梯度更新，从而导致网络无法收敛。因此输入数据应该具有以下特征：</p>
<ol>
<li>取值较小：大部分应该在0-1范围内。</li>
<li>同质性（homogenous）所有特征取值都应在大致相同的范围内。 </li>
</ol>
</li>
<li><p>处理缺失值</p>
<p> 你的数据中有时可能会有缺失值。例如在房价预测例子中，第一个特征是人均犯罪率。如果不是所有样本都具有这个特征怎么办？</p>
<p> 一般来说，将缺失值设置为0是安全的，只要0不是一个有意义的值。网络能够从数据总学到0意味缺失数据，并且会忽略这个值。</p>
<p> 注意：如果测试数据中有缺失值，而网络是在没有缺失值的数据上进行训练的，那么网络不可能学会忽略缺失值。这种情况下应该人为生成一些缺失项的训练样本，多次复制一些训练样本，然后深处测试数据中可能缺失的某些特征。</p>
</li>
</ol>
<h2 id="特征工程（feature-engineering）"><a href="#特征工程（feature-engineering）" class="headerlink" title="特征工程（feature engineering）"></a>特征工程（feature engineering）</h2><p>特征工程指将数据输入模型之前，利用自己关于数据和机器学习算法的知识对数据进行硬编码的变换，以改善模型的效果。多数情况下，一个机器学习无法从完全任意的数据中进行学习。呈现给模型的数据应该便于模型进行学习。</p>
<h2 id="过拟合与欠拟合"><a href="#过拟合与欠拟合" class="headerlink" title="过拟合与欠拟合"></a>过拟合与欠拟合</h2><p>机器学习的根本问题是优化和泛化之间的对立。优化(optimization)是指调节模型以在训练数据上得到最佳性能，而泛化(generalization)是指训练好的模型在前所未见的数据上的性能好坏。机器学习的目的是去的良好的泛化，但你无法控制泛化，只能基于训练数据调节模型。</p>
<p>训练开始时，优化和泛化是相关的：训练数据上损失越小，测试数据上的损失也越小，这时的模型是欠拟合（unfit）的。但在训练数据上迭代一定次数之后，泛化不再提高，验证指标先是不变，然后开始变差，模型开始过拟合。</p>
<p>为了防止模型从训练数据中学到错误且无关紧要的模式：</p>
<ul>
<li>最优解决方式是获得更多训练数据。模型训练数据越多，泛化能力自然越好。</li>
<li>如果无法获得更多数据，次优解决方法是调节模型允许存储的信息量，对模型允许存储的信息进行约束。</li>
<li>如果一个网络只能记住几个模式，那么优化过程会迫使模型集中学习最重要的模式，这样可以得到更好的泛化。</li>
</ul>
<p>这种降低过拟合的方法叫做正则化（regularization）。以下为几种最常见的正则化方法。</p>
<h2 id="减小网络大小"><a href="#减小网络大小" class="headerlink" title="减小网络大小"></a>减小网络大小</h2><p>防止过拟合最简单的方法就是减小模型大小，即减少模型中可学习的参数个数。在深度学习中，模型中可学习参数个数通常被称为模型容量(capacity)。从直观上看，参数更多的模型拥有更大的记忆容量(memorization capacity)，因此能够在训练样本和目标之间完美映射，但这种映射没有任何泛化能力。深度学习模型通常都擅长数据拟合，但真正的挑战在于泛化而不是拟合。</p>
<p>相反，如果网络的记忆容量有限，则无法轻松学会这种映射。所以为了让损失最小化，网络必须学会对目标具有很强的预测能力的压缩表示。需要记住的是：你的模型应该具有足够多的参数，以防止欠拟合，即模型应避免记忆资源不足。【在容量过大与容量不足之间找到平衡】</p>
<p>然而整个过程必须评估一些列不同的网络架构，以便为数据找到最佳的模型大小，一般工作流程是开始时选择较小的层和参数，然后逐渐增加层的大小或新层，直到这种增加对验证损失的影响变得很小。</p>
<p>对电影评论分类做实验。【分别用原始模型、容量更小模型和容量更大模型进行实验】</p>
<h2 id="添加权重正则化"><a href="#添加权重正则化" class="headerlink" title="添加权重正则化"></a>添加权重正则化</h2><p>这里的简单模型（simple model）指参数值分布的熵更小的模型（或参数更少的模型）因此常见的降低过拟合方法是强制让模型权重只能取较小的值，从而限制模型的复杂度，这使得权重分布更加规则。称为权重正则化（weight regularization）。其实现方法是向网络损失函数中添加较大权重值相关的成本（cost）</p>
<ul>
<li>L1 正则化：添加的成本与权重系数的绝对值【权重的L1范数】成正比</li>
<li>L2正则化：添加的成本与权重系数的平方【权重L2范数】成正比。神经网络中L2正则化也叫权重衰减。</li>
</ul>
<h2 id="添加dropout正则化"><a href="#添加dropout正则化" class="headerlink" title="添加dropout正则化"></a>添加dropout正则化</h2><p>dropout是神经网络最有效也是最常用的正则方法之一。对某一层使用dropout，就是在训练过程中随机将该层的一些输出特征舍弃（设置为0）。假设在训练过程中，某一层对给定输入样本的返回值应该是向量[0.2, 0.5, 1.3, 0.8, 1.1]，使用dropout后，该向量会有几个随机元素变为0。dropout的比率是被设为0的特征所占的比例，通常在0.2-0.5范围内。测试时没有单元被舍弃，而该层的输出值需要按dropout比率缩小，因为这是比训练时有更多单元被激活，需要加以平衡。</p>
<h1 id="机器学习的通用工作流程-suspend"><a href="#机器学习的通用工作流程-suspend" class="headerlink" title="机器学习的通用工作流程[suspend]"></a>机器学习的通用工作流程[suspend]</h1><p>该章介绍用于解决任何机器学习问题的通用模版。</p>
<h2 id="问题定义，收集数据集"><a href="#问题定义，收集数据集" class="headerlink" title="问题定义，收集数据集"></a>问题定义，收集数据集</h2><ul>
<li>你输入的数据是什么？你要预测什么？只有拥有可训练的数据，才能预测某件事情。【数据+标注】</li>
<li>你面对的是什么问题？是二分类、多分类、标量回归、向量回归还是多标签问题。确定问题类型可以更好的选择模型架构等。</li>
</ul>
<p>机器学习只能用来记忆训练数据中存在的模式。你只能识出曾经见过的东西。</p>
<h2 id="选择衡量指标"><a href="#选择衡量指标" class="headerlink" title="选择衡量指标"></a>选择衡量指标</h2><p>要控制一件事情，就需要观察它。要取得成功，必须给出成功的定义。衡量成功的指标将决定你选择损失函数，即模型需要优化什么。</p>
<p>例如：对于平衡分类问题（每个类别的可能性相同），精度和接受者操作特征曲线下面积（area under the reveiver operating characteristic curve, ROC AUC)是常用的指标。对于排序问题或多标签问题，可以使用平均准确率均值(mean average precision)。自定义衡量成功的指标很常见。可以参考Kaggle网站上的数据科学竞赛，给出了各种问题的评估指标。</p>
<h2 id="确定评估方法"><a href="#确定评估方法" class="headerlink" title="确定评估方法"></a>确定评估方法</h2><p>一旦明确了目标，必须确定如何衡量当前进展。</p>
<ul>
<li>留出验证集。数据量大的时候可以选择这种方法。</li>
<li>K折交叉验证。如果留出的验证样本太少，无法保证可靠性，可以选择这种方法。</li>
<li>重复K折验证。如果留出验证的样本量太少，同时模型评估又需要非常准确，可以使用这个方法。</li>
</ul>
<h2 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h2><p>首先需要将数据格式化，使其可以输入到机器学习模型中。</p>
<ul>
<li>将数据格式化为张量。</li>
<li>张量取值通常应该缩放为较小的值。</li>
<li>不同特征具有不同取值范围（异质数据），那么应该将数据标准化。</li>
<li>可能需要做特征工程，尤其对小数据问题。</li>
</ul>
<h2 id="开发比基准更好的模型"><a href="#开发比基准更好的模型" class="headerlink" title="开发比基准更好的模型"></a>开发比基准更好的模型</h2><p>该阶段的目标是统计功效（statistical power)，即开发一个小模型，能够打败纯随机的基准（dumb baseline）。比如，MNIST数字分类的例子中</p>
<p>如果尝试了多种合理架构后仍无法打败随机基准，那么可能问题的答案不在数据中。记住以下两种假设。</p>
<ul>
<li>假设输出是可以根据输出进行预测的。</li>
<li>假设可用数据包含足够多的信息，足以学习输入和输出之间的关系。</li>
</ul>
<p>如果一切顺利，需要选择以下三个关键参数构建第一个工作模型</p>
<ul>
<li>最后一层激活。对网络输出进行有效的限制。例如IMDB分类例子在最后一层使用sigmoid，回归则没有使用激活。</li>
<li>损失函数。匹配你所要解决的问题。例如，IMDB使用binary_crossentropy、回归使用mse等。</li>
<li>优化配置。使用什么优化器？学习率多少？多数情况下，使用rmsprop机器默认学习率是稳妥的。</li>
</ul>
<p>关于损失函数的选择，需要注意：直接优化衡量问题成功的指标不一定是可行的，有时难以转化为损失函数，损失函数需要只有在小批量数据时即可计算，而且必须是可微的。例如广泛使用的分类指标ROC AUC就不能被直接优化。因此在分类任务中，常见的做法是优化ROC AUC的替代指标，比如交叉熵。一般来说你认为交叉熵越小，ROC AUC越大。</p>
<h2 id="扩大模型规模：开发过拟合的模型"><a href="#扩大模型规模：开发过拟合的模型" class="headerlink" title="扩大模型规模：开发过拟合的模型"></a>扩大模型规模：开发过拟合的模型</h2><p>一旦得到具有统计功效的模型，问题就变成了：模型是否足够强大？是否具有足够多的层和参数来对问题进行建模。例如，只有单个隐藏层且只有两个单元的网络，在MINST问题上具有统计功效，但并不足以很好的解决问题。请记住，机器学习中无处不在的对立是优化和泛化的对立，理想的模型是刚好在欠拟合和过拟合的界线上，在容量不足和容量多大的界线上。</p>
<p>要搞清楚需要多大的模型，就必须开发一个过拟合模型。</p>
<ol>
<li>添加更多的层。</li>
<li>让每一层变得更大。</li>
<li>训练更多轮次。</li>
</ol>
<p>要始终监控训练损失和验证损失，以及你所关心的指标的训练值和验证值。如果你发现模型在验证数据集上性能开始下降，那么出现了过拟合。</p>
<h2 id="模型正则化与调节超参数"><a href="#模型正则化与调节超参数" class="headerlink" title="模型正则化与调节超参数"></a>模型正则化与调节超参数</h2><p>这是最耗时间：你将不断调节模型、训练、在验证数据上评估（不是测试数据）。再次调节模型让，然后重复，直到模型打到最佳性能。</p>
<ul>
<li>添加dropout。</li>
<li>尝试不不同的架构：增加或减少层数。</li>
<li>添加L1 和 / 或 L2正则化。</li>
<li>尝试不同的超参数，以找到最佳配置。</li>
<li>反复做特征工程：添加新特征或删除没有信息量的特征。</li>
</ul>
<p>每次使用验证过程的反馈来调节模型，都会有相关验证过程信息泄露到模型中。如果只重复几次，那么无关紧要；如果系统性迭代多次，最终会导致模型对验证过程过拟合。即会降低验证过程中的可靠性。</p>
<p>一旦开发出令人满意的模型配置，就可以在所有可用数据（训练数据+验证数据）上训练最终的生产模型，然后在测试集上最后评估一次。如果测试集上的性能比验证集上差很多，那么可能意味你的验证流程不可靠，或者在调节模型参数时验证机数据上出现来过拟合。这种情况下可能需要更换更可靠的评估方法，比如重复的K折验证。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><ul>
<li>定义问题与要训练的数据。收集这些数据，有需要的应该标签进行数据标注。</li>
<li>选择衡量问题成功的指标。在验证数据上监控哪些指标。</li>
<li>确定评估方法：留出验证？K折验证？你应该将哪一部分数据用于验证。</li>
<li>开发第一个比基准更好的模型，即具有统计功效的模型。</li>
<li>开发过拟合模型。</li>
<li>基于模型在验证数据上的性能来进行模型正则化与调节超参数。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2020/11/16/Programming%20Assignment%20Deques%20and%20Randomized%20Queues/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2020/11/16/Programming%20Assignment%20Deques%20and%20Randomized%20Queues/" itemprop="url">Programming Assignment:Deques and Randomized Queues</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-11-16T09:12:52+08:00">
                2020-11-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/CS/" itemprop="url" rel="index">
                    <span itemprop="name">CS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2020/11/16/Programming%20Assignment%20Deques%20and%20Randomized%20Queues/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2020/11/16/Programming%20Assignment%20Deques%20and%20Randomized%20Queues/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2020/11/16/Programming%20Assignment%20Deques%20and%20Randomized%20Queues/" class="leancloud_visitors" data-flag-title="Programming Assignment:Deques and Randomized Queues">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Programming-Assignment-Deques-and-Randomized-Queues"><a href="#Programming-Assignment-Deques-and-Randomized-Queues" class="headerlink" title="Programming Assignment: Deques and Randomized Queues"></a>Programming Assignment: Deques and Randomized Queues</h1><p>Assignment Link: <a target="_blank" rel="noopener" href="https://coursera.cs.princeton.edu/algs4/assignments/queues/specification.php">https://coursera.cs.princeton.edu/algs4/assignments/queues/specification.php</a></p>
<hr>
<p><strong><u>Write a generic data type for a deque and a randomized queue.</u></strong> </p>
<p><strong>The goal of this assignment is to implement elementary data structures using arrays and linked lists, and to introduce you to generics and iterators.</strong></p>
<blockquote>
<p>目标1: Linked lists和arrays的应用</p>
<p>目标2: 范型和迭代器的应用</p>
</blockquote>
<!--- more --->
<h2 id="Dequeue"><a href="#Dequeue" class="headerlink" title="Dequeue"></a>Dequeue</h2><p><strong>Dequeue.</strong> A <em>double-ended queue</em> or <em>deque</em> (pronounced “deck”) is a generalization of a stack and a queue that supports adding and removing items from either the front or the back of the data structure. Create a generic data type <code>Deque</code> that implements the following API:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Deque</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// construct an empty deque</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Deque</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// is the deque empty?</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// return the number of items on the deque</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// add the item to the front</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(Item item)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// add the item to the back</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(Item item)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// remove and return the item from the front</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> Item <span class="title">removeFirst</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// remove and return the item from the back</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> Item <span class="title">removeLast</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// return an iterator over items in order from front to back</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// unit testing (required)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>
<p><em>Corner cases.</em> Throw the specified exception for the following corner cases:</p>
<ul>
<li>Throw an <code>IllegalArgumentException</code> if the client calls either <code>addFirst()</code> or <code>addLast()</code> with a <code>null</code> argument.</li>
<li>Throw a <code>java.util.NoSuchElementException</code> if the client calls either <code>removeFirst()</code> or <code>removeLast</code> when the deque is empty.</li>
<li>Throw a <code>java.util.NoSuchElementException</code> if the client calls the <code>next()</code> method in the iterator when there are no more items to return.</li>
<li>Throw an <code>UnsupportedOperationException</code> if the client calls the <code>remove()</code> method in the iterator.</li>
</ul>
<p><em>Unit testing.</em> Your <code>main()</code> method must call directly every public constructor and method to help verify that they work as prescribed (e.g., by printing results to standard output).</p>
<p><em>Performance requirements.</em> <u>Your deque implementation must support each deque operation (including construction) in <em>constant worst-case time</em>.</u> A deque containing <em>n</em> items must use at most 48<em>n</em> + 192 bytes of memory. Additionally, your iterator implementation must support each operation (including construction) in <em>constant worst-case time</em>.</p>
<p><strong>Implementation</strong></p>
<blockquote>
<p>双端队列使用链表更为合适。且题目要求使用常数时间。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* *****************************************************************************</span></span><br><span class="line"><span class="comment"> *  Name: Alen Zhang</span></span><br><span class="line"><span class="comment"> *  Date: 2020.11.15</span></span><br><span class="line"><span class="comment"> *  Description: Deque implementation.</span></span><br><span class="line"><span class="comment"> **************************************************************************** */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.NoSuchElementException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Deque</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Node first;</span><br><span class="line">    <span class="keyword">private</span> Node last;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        Item item;</span><br><span class="line">        Node next;</span><br><span class="line">        Node pre;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// construct an empty deque</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Deque</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// is the deque empty?</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">this</span>.size == <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return the number of items on the deque</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add the item to the front</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (item == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">&quot;item is null&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Node newNode = <span class="keyword">new</span> Node();</span><br><span class="line">        newNode.item = item;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">            first = newNode;</span><br><span class="line">            last = newNode;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            newNode.next = first;</span><br><span class="line">            first.pre = newNode;</span><br><span class="line">            first = newNode;</span><br><span class="line">            newNode.pre = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add the item to the back</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (item == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">&quot;item is null&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Node newNode = <span class="keyword">new</span> Node();</span><br><span class="line">        newNode.item = item;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">            first = newNode;</span><br><span class="line">            last = newNode;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            last.next = newNode;</span><br><span class="line">            newNode.pre = last;</span><br><span class="line">            last = newNode;</span><br><span class="line">            newNode.next = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// remove and return the item from the front</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">removeFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">&quot;Deque is empty&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Item returnItem = first.item;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">1</span>) &#123;</span><br><span class="line">            first = <span class="keyword">null</span>;</span><br><span class="line">            last = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            first = first.next;</span><br><span class="line">            first.pre = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size--;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> returnItem;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// remove and return the item from the back</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">removeLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">&quot;Deque is empty&quot;</span>);</span><br><span class="line">        Item returnItem = last.item;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">1</span>) &#123;</span><br><span class="line">            first = <span class="keyword">null</span>;</span><br><span class="line">            last = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            last = last.pre;</span><br><span class="line">            last.next = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">return</span> returnItem;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return an iterator over items in order from front to back</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListIterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ListIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Node cur = first;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (cur != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Item <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!hasNext())</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">&quot;No more Objects in the deque&quot;</span>);</span><br><span class="line"></span><br><span class="line">            Item returnItem = cur.item;</span><br><span class="line">            cur = cur.next;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> returnItem;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Deque&lt;String&gt; deque = <span class="keyword">new</span> Deque&lt;String&gt;();</span><br><span class="line">        System.out.println(deque.size());</span><br><span class="line">        deque.addFirst(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        deque.addFirst(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">        deque.addFirst(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">        deque.addFirst(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">        deque.addLast(<span class="string">&quot;5&quot;</span>);</span><br><span class="line">        System.out.println(deque.size());</span><br><span class="line">        Iterator&lt;String&gt; iter = deque.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">            System.out.println(iter.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Randomized-queue"><a href="#Randomized-queue" class="headerlink" title="Randomized queue"></a>Randomized queue</h2><p><strong>Randomized queue.</strong> A <em>randomized queue</em> is similar to a stack or queue, except that the item removed is chosen uniformly at random among items in the data structure. Create a generic data type <code>RandomizedQueue</code> that implements the following API:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomizedQueue</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// construct an empty randomized queue</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RandomizedQueue</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// is the randomized queue empty?</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// return the number of items on the randomized queue</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// add the item</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enqueue</span><span class="params">(Item item)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// remove and return a random item</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> Item <span class="title">dequeue</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// return a random item (but do not remove it)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> Item <span class="title">sample</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// return an independent iterator over items in random order</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="comment">// unit testing (required)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>
<p><em>Iterator</em>. Each iterator must return the items in uniformly random order. The order of two or more iterators to the same randomized queue must be <em>mutually independent</em>; each iterator must maintain its own random order.</p>
<p><em>Corner cases.</em> Throw the specified exception for the following corner cases:</p>
<ul>
<li>Throw an <code>IllegalArgumentException</code> if the client calls <code>enqueue()</code> with a <code>null</code> argument.</li>
<li>Throw a <code>java.util.NoSuchElementException</code> if the client calls either <code>sample()</code> or <code>dequeue()</code> when the randomized queue is empty.</li>
<li>Throw a <code>java.util.NoSuchElementException</code> if the client calls the <code>next()</code> method in the iterator when there are no more items to return.</li>
<li>Throw an <code>UnsupportedOperationException</code> if the client calls the <code>remove()</code> method in the iterator.</li>
</ul>
<p><em>Unit testing.</em> Your <code>main()</code> method must call directly every public constructor and method to verify that they work as prescribed (e.g., by printing results to standard output).</p>
<p><em>Performance requirements.</em> <u>Your randomized queue implementation must support each randomized queue operation</u> (besides creating an iterator) in <em>constant amortized time</em>. That is, any intermixed sequence of <em>m</em> randomized queue operations (starting from an empty queue) must take at most <em>cm</em> steps in the worst case, for some constant <em>c</em>. A randomized queue containing <em>n</em> items must use at most 48<em>n</em> + 192 bytes of memory. Additionally, <u>your iterator implementation must support operations <code>next()</code> and <code>hasNext()</code> in <em>constant worst-case time</em>; and construction in <em>linear time</em>;</u> you may (and will need to) use a linear amount of extra memory per iterator.</p>
<p><strong>Implementation</strong></p>
<blockquote>
<p>迭代器使用常数时间，Array满足要求。本题重点是每题元素是随机的。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* *****************************************************************************</span></span><br><span class="line"><span class="comment"> *  Name: Alen Zhang</span></span><br><span class="line"><span class="comment"> *  Date: 2020.11.15</span></span><br><span class="line"><span class="comment"> *  Description: RandomizedQueue implementation</span></span><br><span class="line"><span class="comment"> **************************************************************************** */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> edu.princeton.cs.algs4.StdRandom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.NoSuchElementException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomizedQueue</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Item[] queue;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// construct an empty randomized queue</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RandomizedQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        queue = (Item[]) <span class="keyword">new</span> Object[<span class="number">1</span>];</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// is the randomized queue empty?</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (size == <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return the number of items on the randomized queue</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add the item</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enqueue</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (item == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">&quot;Item is null&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (size == queue.length) &#123;</span><br><span class="line">            Item[] resizedQueue = (Item[]) <span class="keyword">new</span> Object[queue.length * <span class="number">2</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; queue.length; i++)</span><br><span class="line">                resizedQueue[i] = queue[i];</span><br><span class="line">            queue = resizedQueue;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        queue[size++] = item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">dequeue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">&quot;The RandomizeQueue is empty&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> seed = StdRandom.uniform(<span class="number">0</span>, size);</span><br><span class="line"></span><br><span class="line">        Item returnItem = queue[seed];</span><br><span class="line"></span><br><span class="line">        size--;</span><br><span class="line">        queue[seed] = queue[size];</span><br><span class="line">        queue[size] = <span class="keyword">null</span>;<span class="comment">// Avoid loitering</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (queue.length &gt; <span class="number">4</span> &amp;&amp; size &lt; queue.length / <span class="number">4</span>) &#123;</span><br><span class="line">            Item[] resizedQueue = (Item[]) <span class="keyword">new</span> Object[queue.length / <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                resizedQueue[i] = queue[i];</span><br><span class="line">            &#125;</span><br><span class="line">            queue = resizedQueue;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> returnItem;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return a random item (but do not remove it)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">sample</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">&quot;The RandomizeQueue is empty&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> queue[StdRandom.uniform(<span class="number">0</span>, size)];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return an independent iterator over items in random order</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RandomIterator(queue, size);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Item[] iteratorQueue;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> iteratorIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">RandomIterator</span><span class="params">(Item[] queue, <span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">            iteratorQueue = (Item[]) <span class="keyword">new</span> Object[size];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; iteratorQueue.length; i++) &#123;</span><br><span class="line">                iteratorQueue[i] = queue[i];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; iteratorQueue.length; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> swapIndex = StdRandom.uniform(j + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                Item temp = iteratorQueue[j];</span><br><span class="line">                iteratorQueue[j] = iteratorQueue[swapIndex];</span><br><span class="line">                iteratorQueue[swapIndex] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (iteratorIndex &lt; iteratorQueue.length);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Item <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!hasNext()) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">&quot;Queue is empty&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Item item = iteratorQueue[iteratorIndex];</span><br><span class="line">            iteratorIndex++;</span><br><span class="line">            <span class="keyword">return</span> item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RandomizedQueue&lt;String&gt; queue = <span class="keyword">new</span> RandomizedQueue&lt;&gt;();</span><br><span class="line">        queue.enqueue(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        queue.enqueue(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">        queue.enqueue(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">        queue.enqueue(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">        queue.enqueue(<span class="string">&quot;5&quot;</span>);</span><br><span class="line">        queue.dequeue();</span><br><span class="line">        Iterator&lt;String&gt; iterO = queue.iterator();</span><br><span class="line">        Iterator&lt;String&gt; iter1 = queue.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterO.hasNext()) &#123;</span><br><span class="line">            System.out.println(iterO.next());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="keyword">while</span> (iter1.hasNext()) &#123;</span><br><span class="line">            System.out.println(iter1.next());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h2><p><strong>Client.</strong> Write a client program <code>Permutation.java</code> that takes an integer <em>k</em> as a command-line argument; reads a sequence of strings from standard input using <code>StdIn.readString()</code>; and prints exactly <em>k</em> of them, uniformly at random. Print each item from the sequence at most once.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">~/Desktop/queues&gt;</span><span class="bash"> cat distinct.txt</span></span><br><span class="line">A B C D E F G H I</span><br><span class="line"></span><br><span class="line"><span class="meta">~/Desktop/queues&gt;</span><span class="bash"> java Permutation 3 &lt; distinct.txt</span></span><br><span class="line">C</span><br><span class="line">G</span><br><span class="line">A</span><br><span class="line"></span><br><span class="line"><span class="meta">~/Desktop/queues&gt;</span><span class="bash"> java Permutation 3 &lt; distinct.txt</span></span><br><span class="line">E</span><br><span class="line">F</span><br><span class="line">G</span><br></pre></td></tr></table></figure>
<p>Your program must implement the following API:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Permutation</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>
<p><em>Command-line argument.</em> You may assume that 0 ≤ <em>k</em> ≤ <em>n</em>, where <em>n</em> is the number of string on standard input. Note that you are not given <em>n</em>.</p>
<p><em>Performance requirements.</em> The running time of <code>Permutation</code> must be linear in the size of the input. You may use only a constant amount of memory plus either one <code>Deque</code> or <code>RandomizedQueue</code> object of maximum size at most <em>n</em>. (For an extra challenge and a small amount of extra credit, use only one <code>Deque</code> or <code>RandomizedQueue</code> object of maximum size at most <em>k</em>.)</p>
<p><strong>Implementation</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* *****************************************************************************</span></span><br><span class="line"><span class="comment"> *  Name: Alen Zhang</span></span><br><span class="line"><span class="comment"> *  Date: 2020.11.15</span></span><br><span class="line"><span class="comment"> *  Description: </span></span><br><span class="line"><span class="comment"> **************************************************************************** */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> edu.princeton.cs.algs4.StdIn;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Permutation</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RandomizedQueue&lt;String&gt; queue = <span class="keyword">new</span> RandomizedQueue&lt;String&gt;();</span><br><span class="line">        <span class="keyword">int</span> size = Integer.parseInt(args[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">while</span> (!StdIn.isEmpty()) &#123;</span><br><span class="line">            queue.enqueue(StdIn.readString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (size &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            System.out.println(queue.dequeue());</span><br><span class="line">            size--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2020/11/15/Algorithms-StacksandQueues/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2020/11/15/Algorithms-StacksandQueues/" itemprop="url">Algorithms，Part I：Stacks and Queues</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-11-15T21:10:55+08:00">
                2020-11-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/CS/" itemprop="url" rel="index">
                    <span itemprop="name">CS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2020/11/15/Algorithms-StacksandQueues/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2020/11/15/Algorithms-StacksandQueues/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2020/11/15/Algorithms-StacksandQueues/" class="leancloud_visitors" data-flag-title="Algorithms，Part I：Stacks and Queues">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Week-2-Stacks-and-Queues"><a href="#Week-2-Stacks-and-Queues" class="headerlink" title="Week 2-Stacks and Queues"></a>Week 2-Stacks and Queues</h1><p><strong>Generics.</strong> </p>
<p>An essential characteristic of collection ADTs is that we should be able to use them for any type of data. A specific Java mechanism known as generics enables this capability. The notation <Item> after the class name in each of our APIs defines the name Item as a type parameter, a symbolic placeholder for some concrete type to be used by the client. You can read Stack<Item> as “stack of items.” For example, you can write code such as</Item></Item></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stack&lt;String&gt; stack = <span class="keyword">new</span> Stack&lt;String&gt;();</span><br><span class="line">stack.push(<span class="string">&quot;Test&quot;</span>);</span><br><span class="line">...</span><br><span class="line">String next = stack.pop();</span><br></pre></td></tr></table></figure>
<p>to use a stack for String objects.</p>
<p>Without generics, we would have to define different APIs for each type of data we might need to collect ; with generics, we can use one API for all types of data, even types that are implemented in the future. Generics also lead to clear client code that is easy to understand and debug.</p>
<!--- more --->
<h1 id="Stacks"><a href="#Stacks" class="headerlink" title="Stacks"></a>Stacks</h1><p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-13_at_7.03.48_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-13_at_7.03.48_PM.png"></p>
<p><strong>Subtext: Modular programming</strong></p>
<p>Completely separate the interface and the implementation.</p>
<p><strong>Benefits.</strong></p>
<ul>
<li>Client can’t know details of implementation ⇒ client has many implementation from which to choose.</li>
<li>Implementation can’t know details of client needs.</li>
<li>Design: create modular, reusable libraries.</li>
<li>Performance: use optimized implementation where it matters.</li>
</ul>
<p><strong>Client</strong>: program using operations defined in interface.</p>
<p><strong>Implementation</strong>: actual code implementation operations.</p>
<p><strong>Interface</strong>: description of data type, basic operations.</p>
<p><strong>Stack API</strong></p>
<p>Warmup API. Stack of strings data type.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StackOfStrings</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">StackOfStrings</span>()    //<span class="title">create</span> <span class="title">an</span> <span class="title">empty</span> <span class="title">stack</span>.</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">push</span>(<span class="title">String</span> <span class="title">item</span>)     //<span class="title">insert</span> <span class="title">a</span> <span class="title">new</span> <span class="title">string</span> <span class="title">onto</span> <span class="title">stack</span></span></span><br><span class="line"><span class="class"><span class="title">String</span> <span class="title">pop</span>()    //<span class="title">remove</span> <span class="title">and</span> <span class="title">retrun</span> <span class="title">string</span> <span class="title">most</span> <span class="title">recently</span> <span class="title">added</span></span></span><br><span class="line"><span class="class"><span class="title">boolean</span> <span class="title">isEmpty</span>()     //<span class="title">is</span> <span class="title">the</span> <span class="title">stack</span> <span class="title">empty</span>?</span></span><br><span class="line"><span class="class"><span class="title">int</span> <span class="title">size</span>()     //<span class="title">number</span> <span class="title">of</span> <span class="title">strings</span> <span class="title">on</span> <span class="title">the</span> <span class="title">stack</span></span></span><br></pre></td></tr></table></figure>
<p>Warmup client.   Reverse sequence of strings from standard input.</p>
<p><strong>Stack test client</strong></p>
<p>Read string from standard input.</p>
<ul>
<li>If string equals “-“, pop string from stack and point.</li>
<li>Otherwise, push string onto stack.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Public <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    StackOfString stack = <span class="keyword">new</span> StackOfStrings();</span><br><span class="line">    <span class="keyword">while</span>(!StdIn.isEmpty())&#123;</span><br><span class="line">      String s = StdIn.readString();</span><br><span class="line">      <span class="keyword">if</span>(s.equals(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">          StdOut.print(stack.pop());</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">          stack.push(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Stack: Linked-list representation</strong></p>
<p>Maintain pointer to first node in a linked list; insert / remove from front.</p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-13_at_7.43.15_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-13_at_7.43.15_PM.png"></p>
<p><strong>Stack pop: Linked-list representation</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_11.32.40_AM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_11.32.40_AM.png"></p>
<p><strong>Stack push: linked-list implementation</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-13_at_7.48.47_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-13_at_7.48.47_PM.png"></p>
<p><strong>Stack: linked-list implementation in Java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedStackOfStrings</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Node first = <span class="keyword">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</span><br><span class="line">        String item;</span><br><span class="line">        Node next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fisrt == <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(String item)</span></span>&#123;</span><br><span class="line">        Node oldfirst = first;</span><br><span class="line">        first = <span class="keyword">new</span> Node();</span><br><span class="line">        first.item = item;</span><br><span class="line">        first.next = oldfirst;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String item = first.item;</span><br><span class="line">        first = first.next;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Stack: linked-list implementation performance</strong></p>
<p>Proposition.   </p>
<ol>
<li>Every operation takes constant time in the worst case.</li>
<li>A stack with N items uses ~ 40N bytes.</li>
</ol>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-15_at_4.40.38_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-15_at_4.40.38_PM.png"></p>
<p>Remark. This accounts for the memory for the stack. (but not the memory for strings themselves, which the client owns).</p>
<p><strong>Stack: Array implementation</strong></p>
<p>Array implementation of stack.</p>
<ul>
<li>Use array s[] to store N item on stack.</li>
<li>push(): add new item at s[N].</li>
<li>pop(): remove item from s[N - 1].</li>
</ul>
<p><strong>Defect</strong>: Stack overflows when N exceeds capacity. [stay tuned]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FixedCapacityStackOfStrings</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String[] s;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FixedCapacityStackOfStrings</span><span class="params">(<span class="keyword">int</span> capacity)</span></span>&#123;</span><br><span class="line">        s = <span class="keyword">new</span> String[capacity];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(String item)</span></span>&#123;</span><br><span class="line">        s[N++] = item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s[--N];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_9.27.40_AM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_9.27.40_AM.png"></p>
<h1 id="Resizing-arrays"><a href="#Resizing-arrays" class="headerlink" title="Resizing arrays"></a>Resizing arrays</h1><p><strong>Stack: resizing-array implementation</strong></p>
<p><strong>Q: How to grow and shrink array?</strong></p>
<p>First try.</p>
<ul>
<li>push(): increase size of array s[] by 1.</li>
<li>pop(): decrease size of array s[] by 1.</li>
</ul>
<p>Too expensive.</p>
<ul>
<li>Need to copy all items to a new array.</li>
<li>Inserting first N items takes time proportional to 1 + 2 + … + N ~ N ^ 2 / 2.[infeasible for large N]</li>
</ul>
<p>Challenge. Ensure that array resizing happens infrequently.</p>
<p><strong>Improvements.</strong></p>
<p><strong>Q: How to grow array?</strong></p>
<p>A: If array if full, create a new array of twice the size, and copy items.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ResizingArrayStackOfString</span><span class="params">()</span></span>&#123;</span><br><span class="line">    s = <span class="keyword">new</span> String[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span> <span class="params">(String item)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(N == s.length)</span><br><span class="line">        resize(<span class="number">2</span> * s.length);</span><br><span class="line">    s[N++] = item;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span> <span class="params">(<span class="keyword">int</span> capacity)</span></span>&#123;</span><br><span class="line">    String[] copy = <span class="keyword">new</span> String[capacity];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">        copy[i] = s[i];</span><br><span class="line">    s = copy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Consequence</strong>: Inserting first N items takes time proportional to N(not N^2).</p>
<p><strong>Q: How to shrink array?</strong></p>
<p><strong>First try.</strong></p>
<ul>
<li>push()r: double size of array s[] when array is full.</li>
<li>pop(): halve size of array s[] when array is one-half full.</li>
</ul>
<p>Too expensive in worst case.</p>
<ul>
<li>Consider push-pop-push-pop… sequence when array is full.</li>
<li>Each operation takes time proportional to N.</li>
</ul>
<p><strong>Efficient solution.</strong></p>
<ul>
<li>push():  double size of array s[] when array is full.</li>
<li>pop():  halve size of array s[] when array if one-quarter full.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">    String item = s[--N];</span><br><span class="line">    s[N] = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(N &gt; <span class="number">0</span> &amp;&amp; N == s.length / <span class="number">4</span>)</span><br><span class="line">        resize(s.length / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Invariant.  Array is between 25% full and 100% full.</p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_11.12.12_AM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_11.12.12_AM.png"></p>
<p><strong>Stack resizing-array implementation: performance</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_11.19.54_AM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_11.19.54_AM.png"></p>
<p><strong>Stack resizing-array implementation: memory usage</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_11.20.31_AM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_11.20.31_AM.png"></p>
<p><strong>Stack implementations: resizing array vs linked list</strong></p>
<p>Tradeoffs. </p>
<p>Can implement a stack with either resizing array or linked list; client can use interchangeably. Which one is better?</p>
<p><strong>Linked-List implementation</strong></p>
<ul>
<li>Every operation takes <strong>constant</strong> time in the <strong>worst case.</strong></li>
<li>Uses extra time and space to deal with the links.</li>
</ul>
<p><strong>Resizing-array implementation</strong></p>
<ul>
<li>Every operation takes constant <strong>amortized</strong> [摊销] time. [resize the array]</li>
<li>Less wasted space.</li>
</ul>
<p>Quiz:</p>
<p>Suppose that, starting from an empty data structure, we perform n push operations in our resizing-ar</p>
<p>ray implementation of a stack. How many times is the resize() method called?</p>
<p><strong>logarithmic [对数]</strong></p>
<p>Others:</p>
<p><strong>Loitering</strong>.</p>
<p>Java’s garbage collection policy is to reclaim the memory associated with any objects that no longer be accessed. Which means an object can’t be garbage as long as it’s reachable.    If you simply change your index with —N but do not nullify a[N], you will keep a reference to that object, preventing its garbage collection even if the client code does not reference that object any longer.</p>
<h1 id="Queues"><a href="#Queues" class="headerlink" title="Queues"></a>Queues</h1><p><strong>Queue API</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueueOfStrings</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">QueueOfStrings</span>()    //<span class="title">create</span> <span class="title">an</span> <span class="title">empty</span> <span class="title">queue</span></span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">enqueue</span>(<span class="title">String</span> <span class="title">item</span>)  //<span class="title">insert</span> <span class="title">a</span> <span class="title">new</span> <span class="title">string</span> <span class="title">onto</span> <span class="title">queue</span></span></span><br><span class="line"><span class="class"><span class="title">String</span> <span class="title">dequeue</span>()  //<span class="title">remove</span> <span class="title">and</span> <span class="title">return</span> <span class="title">the</span> <span class="title">String</span> <span class="title">least</span> <span class="title">recently</span> <span class="title">added</span></span></span><br><span class="line"><span class="class"><span class="title">boolean</span> <span class="title">isEmpty</span>()  //<span class="title">is</span> <span class="title">the</span> <span class="title">queue</span> <span class="title">empty</span></span></span><br><span class="line"><span class="class"><span class="title">int</span> <span class="title">size</span>()   //<span class="title">number</span> <span class="title">of</span> <span class="title">strings</span> <span class="title">on</span> <span class="title">the</span> <span class="title">queue</span></span></span><br></pre></td></tr></table></figure>
<p><strong>Linked-list representation</strong></p>
<p>Maintain pointer to first and last nodes in a linked list;</p>
<p>insert / remove from opposite ends.</p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_12.12.10_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_12.12.10_PM.png"></p>
<p><strong>Queue dequeue: linked-list implementation</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_12.13.02_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_12.13.02_PM.png"></p>
<p>Remark. Identical code to linked-list stack pop()</p>
<p><strong>Queue enqueue: linked-list implementation</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_12.15.36_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_12.15.36_PM.png"></p>
<p>Java implementation</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedQueueOfStrings</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Node first, last;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</span><br><span class="line">        <span class="comment">/* same as in StackOfString */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> first == <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enqueue</span><span class="params">(String item)</span></span>&#123;</span><br><span class="line">        Node oldlast = last;</span><br><span class="line">        last = <span class="keyword">new</span> Node();</span><br><span class="line">        last.item = item;</span><br><span class="line">        last.next = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(isEmpty())</span><br><span class="line">            first = last;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            oldlast.next = last;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">dequeue</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String item = first.item;</span><br><span class="line">        first = first.next;</span><br><span class="line">        <span class="keyword">if</span>(isEmpty())</span><br><span class="line">            last = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Queue: resizing array implementation</strong></p>
<p>Array implementation of a queue.</p>
<ul>
<li>Use array q[] to store items in queue.</li>
<li>enqueue(): add new item at q[tail].</li>
<li>dequeue(): remove item from q[head].</li>
<li>Update head and tail modulo the capacity.</li>
<li>Add resizing array.</li>
</ul>
<p><strong>Quiz:</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_12.42.16_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_12.42.16_PM.png"></p>
<h1 id="Generics"><a href="#Generics" class="headerlink" title="Generics"></a><strong>Generics</strong></h1><p><strong>Parameterized Stack</strong></p>
<p>Situation:</p>
<p>We implemented: StackOfStrings.</p>
<p>We also want: StackOfURLs, StackOfInts. StackOfVans, …</p>
<p>Attempt 1. Implement a separate stack class for each type.</p>
<ul>
<li>Rewrite code is tedious and error-prone.</li>
<li>Maintaining cut-and-pasted code is tedious and error-prone.</li>
</ul>
<p>Attempt 2. Implement a stack with items of type Object.</p>
<ul>
<li>Casting is required in client. [ugly code]</li>
<li>Casting is error-prone: run-time error if types <strong>mismatch</strong>.</li>
</ul>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_2.15.37_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_2.15.37_PM.png"></p>
<p>Attempt 3. Java generics.</p>
<ul>
<li>Avoid casting in client.</li>
<li>Discover type mismatch errors at compile-time instead of run-time.</li>
</ul>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_2.14.56_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_2.14.56_PM.png"></p>
<p>Guiding principles. Welcome compile-time errors; avoid run-time errors.</p>
<p><strong>Generic stack: linked-list implementation</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_2.17.23_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_2.17.23_PM.png"></p>
<p><strong>Generic stack: array implementation</strong></p>
<p><img src="https://superming.life/2020/11/15/Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_2.17.51_PM.png" alt="Algorithms-StacksandQueues/Screen_Shot_2020-11-14_at_2.17.51_PM.png"></p>
<p><strong>Generic data types</strong></p>
<p>Q: what to do about primitive types?</p>
<p>Wrapper type.</p>
<ul>
<li>Each primitive type has a <strong>wrapper</strong> object type.[ Integer is wrapper type for int ]</li>
</ul>
<p>Autoboxing.</p>
<p>Automatic cast between a primitive type and its wrapper.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Stack&lt;Integer&gt; s = <span class="keyword">new</span> Stack&lt;Integer&gt;();</span><br><span class="line">s.push(<span class="number">17</span>);  <span class="comment">//s.push(Integer.valueOf(17);</span></span><br><span class="line"><span class="keyword">int</span> a = s.pop();  <span class="comment">//int a = s.pop().intValue();</span></span><br></pre></td></tr></table></figure>
<p>Bottom line. Client code can use generic stack for any type of data.</p>
<h1 id="Iterators"><a href="#Iterators" class="headerlink" title="Iterators"></a>Iterators</h1><p><strong>Design challenge</strong>. Support iteration over stack items by client, without revealing the internal representation of the stack.</p>
<p>Java solution. Make stack implement the java.lang.Iterable interface</p>
<p>Q. What’s an Iterable?</p>
<p>A. Has a method that returns an Iterator.</p>
<p>A. Has method hasNext() and next().</p>
<p>Q. Why make data structures Iterable?</p>
<p>A. <strong>Java support elegant client code.</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Iterable interface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt;</span>&#123;</span><br><span class="line">    <span class="function">Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Iterator interface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span>&lt;<span class="title">Item</span>&gt;</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</span><br><span class="line">  ****	<span class="function">Item <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//equivalent code(long hand)</span></span><br><span class="line">Iterator&lt;String&gt; i = stack.iterator();</span><br><span class="line"><span class="keyword">while</span>(i.hasNext())&#123;</span><br><span class="line">    String s = i.next();</span><br><span class="line">    StdOut.println(s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//&quot;foreach&quot;statement(shorthand)</span></span><br><span class="line"><span class="keyword">for</span>(String s : stack)</span><br><span class="line">    StdOut.println(s);</span><br></pre></td></tr></table></figure>
<p>关于Java的迭代器：<Java 编程思想 p226></Java></p>
<p>任何容器类，必须要有某种方式可以插入元素并将他再次返回。毕竟，持有事物是容器最基本的工作。对于List，add() 是插入元素的方法之一，而get()是取出元素方式之一。</p>
<p>如何才能不重写代码，就可以应用于不同该类型的容器？</p>
<p>迭代器（设计模式），迭代器是一个对象，它的工作是遍历并选择序列中的对象，而客户端程序员不必知道或关心该序列底层的结构。此外，迭代器通常被成为“轻量级对象”，因为创建他的代价小。</p>
<p><strong>Stack iterator: Linked-list implementation</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stack</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt;</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ListIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Item</span>&gt;</span>&#123;</span><br><span class="line">          <span class="keyword">private</span> Node current = first;</span><br><span class="line"></span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>&#123;  <span class="keyword">return</span> current != <span class="keyword">null</span>;&#125;</span><br><span class="line">          </span><br><span class="line">          <span class="comment">// throw UnsupportedozperationException</span></span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>&#123;  <span class="comment">/* not supported */</span>&#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// throw NoSuchElementException if no more iterms in iteration</span></span><br><span class="line">          <span class="function"><span class="keyword">public</span> Item <span class="title">next</span><span class="params">()</span></span>&#123;</span><br><span class="line">              Item item = current.item;</span><br><span class="line">              current = current.next;</span><br><span class="line">              <span class="keyword">return</span> item;</span><br><span class="line">          &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Stack iterator: Array implementation</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stack</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt;</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ReverseArrayIterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ReverseArrayIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Item</span>&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> i = N;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;  <span class="keyword">return</span> i &gt; <span class="number">0</span>;  &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span>  </span>&#123; <span class="comment">/* not support */</span> &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Item <span class="title">next</span><span class="params">()</span>    </span>&#123;  <span class="keyword">return</span> s[--i];  &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong><em>It free us to switch to a totally different representation without having to change any client code. More important, taking the client’s point of view, it allows clients to use iteration without having to know any details of the class implementation.</em></strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2020/11/06/2001%E5%A4%AA%E7%A9%BA%E6%BC%AB%E6%B8%B8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2020/11/06/2001%E5%A4%AA%E7%A9%BA%E6%BC%AB%E6%B8%B8/" itemprop="url">2001太空漫游</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-11-06T17:11:17+08:00">
                2020-11-06
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2020/11/06/2001%E5%A4%AA%E7%A9%BA%E6%BC%AB%E6%B8%B8/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2020/11/06/2001%E5%A4%AA%E7%A9%BA%E6%BC%AB%E6%B8%B8/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2020/11/06/2001%E5%A4%AA%E7%A9%BA%E6%BC%AB%E6%B8%B8/" class="leancloud_visitors" data-flag-title="2001太空漫游">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>2001太空漫游的首版序，太喜欢这段话了。</strong></p>
<p>今天每一个活着的人背后，都立着三十个灵魂 — 三十比一。正是死去的人与活人的比例。开天辟地以来，在地球上活过的人大约总共一千亿。</p>
<p>这是个有趣的数字，因为说巧不巧，我们所在的这个宇宙，也就是这个银河系，也有大约一千亿颗星星。因此，每一个在地球上活过的人，在这个宇宙里都有一颗对应的星星在闪耀。</p>
<p>每颗相对应的星星，都是一颗太阳。比起那颗又小又近，我们称之为太阳的星星来说，其他这些星星都远为灿烂、明亮。而且，外层空间这些太阳，许多都有不止一颗的行星在环绕运转。因此我们几乎可以确定：太空中有足够的土地，可以让包括第一位猿人在内的每一个人，都拥有他专属的一颗星 — 是天堂还是地狱先不论。</p>
<p>这些潜在的天堂和地狱，到底有多少已经有生命居住其中，又是些什么样的生命，我们无从猜测 — 其中离我们最近的，也要比火星或金星远上一百万倍，而火星或金星仍是下一个世代的遥远目标。不过，距离的障碍正在逐渐消失，总有一天，我们会在星海中和我们的同类，或是我们的主宰相遇。</p>
<p>人类花了很长时间才面对这个可能，甚至，有人到今天还希望这一天永远不会到来。然而，越来越多人在问：<strong>“既然我们自己都即将要探索太空了，这样的会面为什么还没有发生呢？“</strong></p>
<p>真的，为什么还没有发生呢？针对这个合理的问题，这里有一个可能的答案，不过，请记住一点，这纯属虚构。</p>
<p><strong>至于真相，一定更在意料之外</strong>  —  自古皆然。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2020/11/01/MachineLearning-Week1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2020/11/01/MachineLearning-Week1/" itemprop="url">Machine-Learning Andrew Ng</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-11-01T12:10:55+08:00">
                2020-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/CS/" itemprop="url" rel="index">
                    <span itemprop="name">CS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2020/11/01/MachineLearning-Week1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2020/11/01/MachineLearning-Week1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2020/11/01/MachineLearning-Week1/" class="leancloud_visitors" data-flag-title="Machine-Learning Andrew Ng">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Machine-Learning-Week-1"><a href="#Machine-Learning-Week-1" class="headerlink" title="Machine-Learning - Week 1"></a>Machine-Learning - Week 1</h1><p>Github link: <a target="_blank" rel="noopener" href="https://github.com/AlenZhang-Dev/MachineLearning-Stanford">https://github.com/AlenZhang-Dev/MachineLearning-Stanford</a></p>
<h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>Introduce the core idea of teaching a computer to learn concepts using data - without being explicitly programmed.</p>
<p><strong>linear regression with one variable.</strong> Discuss the application of linear regression to housing price prediction, present the notion of a cost function, also introduce the gradient descent method for learning.</p>
<p>The course require the knowledge of l<strong>inear algebra</strong> concepts.</p>
<!---more-->
<hr>
<h2 id="What’s-Machine-Learning"><a href="#What’s-Machine-Learning" class="headerlink" title="What’s Machine Learning?"></a>What’s Machine Learning?</h2><p>Andrew NG: Machine Learning is the science of getting computers to learn, without being explicitly programmed.</p>
<ul>
<li>Grew out of work in AI</li>
<li>New capability for computers</li>
</ul>
<p>Examples:</p>
<ul>
<li>Database mining<ul>
<li>Large datasets from growth of automation/web</li>
<li>E.g., Web click data, medical records, biology, engineering</li>
</ul>
</li>
<li><p>Applications can’t program by hand.</p>
<ul>
<li>E.g., Autonomous helicopter, handwriting recognition, most of Natural Language Processing(NLP), Computer Vision.</li>
</ul>
</li>
<li><p>Self-customizing programs</p>
<p>  E.g., Amazon, Netflix product recommendations.</p>
</li>
<li><p>Understanding human learning(brain, real AI).</p>
</li>
</ul>
<p><strong>What’s Machine Learning?[Definition]</strong></p>
<p>Two definitions of Machine Learning are offered.</p>
<ul>
<li>Arthur Samuel described it as: <strong>“the field of study that gives computers the ability to learn without being explicitly programmed.”</strong> This is an older, informal definition.</li>
<li>Tom Mitchell provides a more modern definition: <strong>“A computer program is said to learn from experience E with respect to some class of tasks T and performance measure P, if its performance at tasks in T, as measured by P, improves with experience E.”</strong></li>
</ul>
<p>Examples:</p>
<p>playing checkers.</p>
<p>E = the experience of playing many games of checkers</p>
<p>T = the task of playing checkers.</p>
<p>P = the probability that the program will win the next game.</p>
<p>Suppose your email program watches which emails you do or do not mark as spam, and based on that learns how to better filter spam. Explain the E T P according to Tom Mitchell’s definiation.</p>
<p>E = Watching you label emails as spam or not spam.</p>
<p>T = Classify emails as spam or not spam.</p>
<p>P = The number(or fraction) of emails correctly classified as spam/not spam.</p>
<p>In general, any machine learning problem can be assigned to one of two broad classifications:</p>
<p><strong>Supervised learning and Unsupervised learning.</strong></p>
<p>Machine Learning algorithms </p>
<ul>
<li>Supervised Learning</li>
<li>Unsupervised Learning</li>
</ul>
<p>Others: Reinforcement Learning, recommender systems.</p>
<h2 id="Supervised-Learning"><a href="#Supervised-Learning" class="headerlink" title="Supervised Learning"></a>Supervised Learning</h2><p>In supervised learning, we are given a data set and already know what our correct output should look like, <strong>having the idea that there is a relationship between the input and the output.</strong></p>
<p>Supervised learning problems are categorized into “<strong>regression</strong>“ and “<strong>classification</strong>“ problems. </p>
<p>In a regression problem, we are trying to predict results within a <strong>continuous output</strong>, meaning that we are trying to map input variables to some continuous function. </p>
<p>In a classification problem, we are instead trying to predict results in a <strong>discrete output[离散输出]</strong>. In other words, we are trying to map input variables into discrete categories.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_3.50.40_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_3.50.40_PM.png"></p>
<p>Regression exp</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_3.51.03_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_3.51.03_PM.png"></p>
<p>Classification</p>
<p><strong>Example 1:</strong></p>
<p>Given data about the size of houses on the real estate market, try to predict their price. Price as a function of size is a continuous output, so this is a regression problem.</p>
<p>We could turn this example into a classification problem by instead making our output about whether the house “sells for more or less than the asking price.” Here we are classifying the houses based on price into two discrete categories.</p>
<p><strong>Example 2</strong>:</p>
<p>(a) Regression - Given a picture of a person, we have to predict their age on the basis of the given picture</p>
<p>(b) Classification - Given a patient with a tumor, we have to predict whether the tumor is malignant or benign.</p>
<p>Practice：</p>
<p>You’re running a company, and you want to develop learning algorithms to address each of two problems. </p>
<p>Problem 1: You have a large inventory of identical items. You want to predict how many of these items will sell over the next 3 months.</p>
<p>Problem 2: You’d like software to examine individual customer accounts, and for each account decide if it has been hacked/compromised. Should you treat these as classification or as regression problems?</p>
<p>Answer: </p>
<p>Treat problem 1 as a regression problem, problem 2 as a classification problem.</p>
<p>Explain:</p>
<p>First one : we have thousand of items [Continuous]</p>
<p>Second one: 0 - not hacked, 1 - hacked.[Hacked or not, Discrete]</p>
<h2 id="Unsupervised-Learning"><a href="#Unsupervised-Learning" class="headerlink" title="Unsupervised Learning"></a>Unsupervised Learning</h2><p>Unsupervised learning is a type of machine learning that looks for previously undetected patterns in a data set with no pre-existing labels and with a minimum of human supervision.    —- Wikipedia</p>
<p>Unsupervised learning allows us to approach problems with little or no idea what our results should look like. We can derive structure from data where we don’t necessarily know the effect of the variables.</p>
<p>We can derive this structure by clustering the data based on relationships among the variables in the data.</p>
<p>With unsupervised learning there is no feedback based on the prediction results.</p>
<p><strong>Example:</strong></p>
<p>Clustering: Take a collection of 1,000,000 different genes, and find a way to automatically group these genes into groups that are somehow similar or related by different variables, such as lifespan, location, roles, and so on.</p>
<p>Non-clustering: The “Cocktail Party Algorithm”, allows you to find structure in a chaotic environment. (i.e. identifying individual voices and music from a mesh of sounds at a <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Cocktail_party_effect">cocktail party</a>).</p>
<p>The Following examples using an unsupervised learning algorithm: </p>
<p>Given a set of news articles found on web, group them into sets of articles about the same stories.</p>
<p>Given a database of customer data, automatically discover market segments and group customers into different market segments.</p>
<h1 id="2-Model-and-Cost-Function"><a href="#2-Model-and-Cost-Function" class="headerlink" title="2. Model and Cost Function"></a>2. Model and Cost Function</h1><h3 id="Model-Representation"><a href="#Model-Representation" class="headerlink" title="Model Representation"></a>Model Representation</h3><p><strong>Notes:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_6.03.23_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_6.03.23_PM.png"></p>
<p>Linear regression model with only one variable[Also called univariate linear regression]</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_6.10.45_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_6.10.45_PM.png"></p>
<p><strong>Material:</strong></p>
<p>To describe the supervised learning problem slightly more formally, our goal is, given a training set, to learn a function h : X → Y so that h(x) is a “good” predictor for the corresponding value of y. For historical reasons, this function h is called a <strong>hypothesis</strong>. </p>
<p>When the target variable that we’re trying to predict is continuous, such as in our housing example, we call the learning problem a regression problem. When y can take on only a small number of discrete values (such as if, given the living area, we wanted to predict if a dwelling is a house or an apartment, say), we call it a classification problem.</p>
<h3 id="Cost-Function"><a href="#Cost-Function" class="headerlink" title="Cost Function"></a>Cost Function</h3><p><strong>Notes:</strong></p>
<p>How to choose the parameters?</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_6.17.14_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_6.17.14_PM.png"></p>
<p><strong>Material</strong>:</p>
<p>We can measure the accuracy of our hypothesis function by using a <strong>cost function</strong>. This takes an average difference (actually a fancier version of an average) of all the results of the hypothesis with inputs from x’s and the actual output y’s.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.06.02_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.06.02_PM.png"></p>
<p>MSE: the most common one used for regression problems.</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Mean_squared_error">Mean squared error</a></p>
<h2 id="Cost-Function-Intuition-I"><a href="#Cost-Function-Intuition-I" class="headerlink" title="Cost Function Intuition I"></a>Cost Function Intuition I</h2><p>1.Set the theta(0) to zero.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_6.58.03_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_6.58.03_PM.png"></p>
<p>2.The optimization objective for our learning algorithm is we want to choose the value of theta (1).  The Minimizes J(theat(1)).</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_7.39.12_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_7.39.12_PM.png"></p>
<p>Material:</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_7.39.36_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_7.39.36_PM.png"></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_7.39.52_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_7.39.52_PM.png"></p>
<h2 id="Cost-function-Intuition-II"><a href="#Cost-function-Intuition-II" class="headerlink" title="Cost function - Intuition II"></a>Cost function - Intuition II</h2><ol>
<li>Keep both two parameters of the cost function.</li>
</ol>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.42.52_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.42.52_PM.png"></p>
<p>The cost function may be look like below:</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.43.16_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.43.16_PM.png"></p>
<p>Contour plots / figure</p>
<p>A contour plot is a graph that contains many contour lines. A contour line of a two variable function has constant value at all points of same line. An example of such a graph is the one to the right below:</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.46.54_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.46.54_PM.png"></p>
<p>3 green x have the same cost.</p>
<p>When θ0=360 and θ1 = 0, the value of J(θ0, θ1) in the contour plot gets closer to the center thus reducing the cost function error. Now Giving our hypothesis function a slightly positive slope result in a better fit of the data.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.57.37_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_4.57.37_PM.png"></p>
<p>The graph above minimizes the cost function as much as possible and consequently, the result of θ1 and θ0 tend to be around 0.12 and 250 respectively. Plotting those values on our graph to the right seems to put our point in the center of the inner most ‘circle’.</p>
<h1 id="3-Parameter-Learning"><a href="#3-Parameter-Learning" class="headerlink" title="3. Parameter Learning"></a>3. Parameter Learning</h1><h2 id="Gradient-Descent"><a href="#Gradient-Descent" class="headerlink" title="Gradient Descent"></a>Gradient Descent</h2><p>The algorithm called gradient descent for <strong>minimizing the cost function j().</strong> </p>
<p>Gradient is a general algorithm.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_8.07.15_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_8.07.15_PM.png"></p>
<p>The outline of Gradient descent algorithm:</p>
<p>Understand the concept between Assignment and Truth assertion.</p>
<p>Simultaneous update both parameters.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_8.29.22_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_8.29.22_PM.png"></p>
<p><strong>Material:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_8.31.07_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_8.31.07_PM.png"></p>
<p>We will know that we have succeed when our cost function is at the very bottom of the pits in our graph. when its values is the minimum. The red arrows show the minimum points in the graph.</p>
<p>The way we do is by taking the derivative of our cost function. The slope of the tangent is the derivative at the point and it will give us a direction move towards. We make steps down the cost function in the direction with the steepest descent. The size of each step is determined by the parameter α, which is called the learning rate.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_8.31.16_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_8.31.16_PM.png"></p>
<h2 id="Gradient-Descent-Intuition"><a href="#Gradient-Descent-Intuition" class="headerlink" title="Gradient Descent Intuition"></a>Gradient Descent Intuition</h2><p>Apply gradient descent to minimize our squared cost function.</p>
<p>Gradient descent can converge to local minimum, even with the learning rate a fixed.</p>
<p>don’t need to change the a.</p>
<p>Explain the Gradient descent with one variable:</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.02.06_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.02.06_PM.png"></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.01.29_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.01.29_PM.png"></p>
<p>Features of Gradient descent:</p>
<p>When reach the bottom of our convex function, the derivative will always be 0, thus we get the settled <em>θ1.</em></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.01.42_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.01.42_PM.png"></p>
<h2 id="Gradient-Descent-For-Linear-Regression"><a href="#Gradient-Descent-For-Linear-Regression" class="headerlink" title="Gradient Descent For Linear Regression"></a>Gradient Descent For Linear Regression</h2><p>Simplify the function:</p>
<p>When we apply the Gradient descent algorithm with Linear Regression Model, we will derived a new form of the gradient descent equation.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_6.37.54_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_6.37.54_PM.png"></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.10.52_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.10.52_PM.png"></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.16.44_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.16.44_PM.png"></p>
<p>Convex function equals to Bowl shaped</p>
<p>“Batch” Gradient Descent.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.24.15_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-27_at_9.24.15_PM.png"></p>
<p>Material:</p>
<p>A new form of the gradient descent equation:</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_6.41.58_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_6.41.58_PM.png"></p>
<p>A single example of derivative.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_6.42.55_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_6.42.55_PM.png"></p>
<p>So this is simply gradient descent on the original cost function j. This method looks at every example in the entire training set on every step, which is called <strong>batch gradient descent.</strong> Note that, while gradient descent can be susceptible to <strong>local minima</strong> in general. the optimization problem we have posed here for linear regression has only on global, and no other local, optima; thus gradient descent always converges to the global minimum. </p>
<p>Indeed, j is a <strong>convex quadratic function</strong>. Here is an example of gradient descent as it run to minimize a quadratic function.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Untitled.png" alt="MachineLearning-Week1/Untitled.png"></p>
<p>The ellipses shown above are the contours of a quadratic function. Also shown is the trajectory taken by gradient descent, which was initialized at (48,30). The x’s in the figure (joined by straight lines) mark the successive values of θ that gradient descent went through as it converged to its minimum.</p>
<p>Rating Test:</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_8.31.33_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_8.31.33_PM.png"></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_8.35.23_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_8.35.23_PM.png"></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_8.37.06_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_8.37.06_PM.png"></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_9.01.07_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_9.01.07_PM.png"></p>
<p>Choose C and D</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_8.53.44_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_8.53.44_PM.png"></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-28_at_9.09.25_PM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-28_at_9.09.25_PM.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.notion.so/1cd7ea007e554bc59178ca74776018d5">Answers</a></p>
<h1 id="4-Linear-Algebra-Review"><a href="#4-Linear-Algebra-Review" class="headerlink" title="4. Linear Algebra Review"></a>4. Linear Algebra Review</h1><h2 id="Matrices-and-Vectors"><a href="#Matrices-and-Vectors" class="headerlink" title="Matrices and Vectors"></a>Matrices and Vectors</h2><p>Matrix: Rectangular array of numbers.</p>
<p>Matrices are 2-dimensional arrays.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.28.31_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.28.31_AM.png"></p>
<p>Vector: An n x 1 matrix.</p>
<p>A vector is a matrix with one column and many rows.</p>
<p>So vectors are a <strong>subset</strong> of matrices.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.34.06_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.34.06_AM.png"></p>
<p><strong>Notation and terms[Essential]</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.40.18_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.40.18_AM.png"></p>
<p><strong>Matlab commands below:</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% The ; denotes we are going back to a new row.</span></span><br><span class="line">A = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>; <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>; <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>; <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">% Initialize a vector </span></span><br><span class="line">v = [<span class="number">1</span>;<span class="number">2</span>;<span class="number">3</span>] </span><br><span class="line"></span><br><span class="line"><span class="comment">% Get the dimension of the matrix A where m = rows and n = columns</span></span><br><span class="line">[m,n] = <span class="built_in">size</span>(A)</span><br><span class="line"></span><br><span class="line"><span class="comment">% You could also store it this way</span></span><br><span class="line">dim_A = <span class="built_in">size</span>(A)</span><br><span class="line"></span><br><span class="line"><span class="comment">% Get the dimension of the vector v </span></span><br><span class="line">dim_v = <span class="built_in">size</span>(v)</span><br><span class="line"></span><br><span class="line"><span class="comment">% Now let&#x27;s index into the 2nd row 3rd column of matrix A</span></span><br><span class="line">A_23 = A(<span class="number">2</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Addition-and-Scalar-Multiplication"><a href="#Addition-and-Scalar-Multiplication" class="headerlink" title="Addition and Scalar Multiplication"></a>Addition and Scalar Multiplication</h2><p><strong>Outline:</strong></p>
<p>Matrix addition and subtraction, and how to multiply a matrix by a number. SO called Scalar Multiplication.</p>
<p><strong>Matrix Addition:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.49.42_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.49.42_AM.png"></p>
<p><strong>Scalar Multiplication:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.51.49_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.51.49_AM.png"></p>
<p><strong>Combination of Operands:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.55.22_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_8.55.22_AM.png"></p>
<p><strong>Matlab command:</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Initialize matrix A and B </span></span><br><span class="line">A = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>; <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">B = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>; <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">% Initialize constant s </span></span><br><span class="line">s = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% See how element-wise addition works</span></span><br><span class="line">add_AB = A + B </span><br><span class="line"></span><br><span class="line"><span class="comment">% See how element-wise subtraction works</span></span><br><span class="line">sub_AB = A - B</span><br><span class="line"></span><br><span class="line"><span class="comment">% See how scalar multiplication works</span></span><br><span class="line">mult_As = A * s</span><br><span class="line"></span><br><span class="line"><span class="comment">% Divide A by s</span></span><br><span class="line">div_As = A / s</span><br><span class="line"></span><br><span class="line"><span class="comment">% What happens if we have a Matrix + scalar?</span></span><br><span class="line">add_As = A + s</span><br><span class="line"></span><br><span class="line">A =</span><br><span class="line">   <span class="number">1</span>   <span class="number">2</span>   <span class="number">4</span></span><br><span class="line">   <span class="number">5</span>   <span class="number">3</span>   <span class="number">2</span></span><br><span class="line"></span><br><span class="line">B =</span><br><span class="line">   <span class="number">1</span>   <span class="number">3</span>   <span class="number">4</span></span><br><span class="line">   <span class="number">1</span>   <span class="number">1</span>   <span class="number">1</span></span><br><span class="line">s =  <span class="number">2</span></span><br><span class="line"></span><br><span class="line">add_AB =</span><br><span class="line">   <span class="number">2</span>   <span class="number">5</span>   <span class="number">8</span></span><br><span class="line">   <span class="number">6</span>   <span class="number">4</span>   <span class="number">3</span></span><br><span class="line"></span><br><span class="line">sub_AB =</span><br><span class="line">   <span class="number">0</span>  <span class="number">-1</span>   <span class="number">0</span></span><br><span class="line">   <span class="number">4</span>   <span class="number">2</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line">mult_As =</span><br><span class="line">    <span class="number">2</span>    <span class="number">4</span>    <span class="number">8</span></span><br><span class="line">   <span class="number">10</span>    <span class="number">6</span>    <span class="number">4</span></span><br><span class="line"></span><br><span class="line">div_As =</span><br><span class="line">   <span class="number">0.50000</span>   <span class="number">1.00000</span>   <span class="number">2.00000</span></span><br><span class="line">   <span class="number">2.50000</span>   <span class="number">1.50000</span>   <span class="number">1.00000</span></span><br><span class="line"></span><br><span class="line">add_As =</span><br><span class="line">   <span class="number">3</span>   <span class="number">4</span>   <span class="number">6</span></span><br><span class="line">   <span class="number">7</span>   <span class="number">5</span>   <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h2 id="Matrix-Vector-Multiplication"><a href="#Matrix-Vector-Multiplication" class="headerlink" title="Matrix Vector Multiplication"></a>Matrix Vector Multiplication</h2><p>The number of columns of matrix must match the number of rows of vector.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.11.24_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.11.24_AM.png"></p>
<p>m x n matrix multiply n x 1 matrix [n-dimensional vector] = m-dimensional vector</p>
<h2 id="Matrix-Matrix-Multiplication"><a href="#Matrix-Matrix-Multiplication" class="headerlink" title="Matrix Matrix Multiplication"></a>Matrix Matrix Multiplication</h2><p><strong>Details:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.26.48_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.26.48_AM.png"></p>
<p><strong>Apply:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.37.41_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.37.41_AM.png"></p>
<p><strong>Matlab command:</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Initialize a 3 by 2 matrix </span></span><br><span class="line">A = [<span class="number">1</span>, <span class="number">2</span>; <span class="number">3</span>, <span class="number">4</span>;<span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">% Initialize a 2 by 1 matrix </span></span><br><span class="line">B = [<span class="number">1</span>; <span class="number">2</span>] </span><br><span class="line"></span><br><span class="line"><span class="comment">% We expect a resulting matrix of (3 by 2)*(2 by 1) = (3 by 1) </span></span><br><span class="line">mult_AB = A*B</span><br><span class="line"></span><br><span class="line"><span class="comment">% Make sure you understand why we got that result</span></span><br><span class="line">A =</span><br><span class="line">     <span class="number">1</span>     <span class="number">2</span></span><br><span class="line">     <span class="number">3</span>     <span class="number">4</span></span><br><span class="line">     <span class="number">5</span>     <span class="number">6</span></span><br><span class="line"></span><br><span class="line">B =</span><br><span class="line">     <span class="number">1</span></span><br><span class="line">     <span class="number">2</span></span><br><span class="line"></span><br><span class="line">mult_AB =</span><br><span class="line">     <span class="number">5</span></span><br><span class="line">    <span class="number">11</span></span><br><span class="line">    <span class="number">17</span></span><br></pre></td></tr></table></figure>
<h2 id="Matrix-Multiplication-Properties"><a href="#Matrix-Multiplication-Properties" class="headerlink" title="Matrix Multiplication Properties"></a>Matrix Multiplication Properties</h2><p><strong>Not commutative</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.42.59_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.42.59_AM.png"></p>
<p><strong>Associative</strong></p>
<p>(A <em> B) </em> C = A <em> (B </em> C)</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.46.25_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.46.25_AM.png"></p>
<p><strong>Identity Matrix:</strong></p>
<p>The identity matrix of size n is the n x n square matrix <strong>with ones on the main diagonal and zeros elsewhere.<br>Details of Identity Matrix:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.55.37_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_9.55.37_AM.png"></p>
<h2 id="Inverse-and-Transpose"><a href="#Inverse-and-Transpose" class="headerlink" title="Inverse and Transpose"></a>Inverse and Transpose</h2><p>Start by how it relates to real numbers.</p>
<p><strong>Inverse Matrix:</strong></p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_10.07.41_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_10.07.41_AM.png"></p>
<ul>
<li>Matrices that don’t have an inverse are <strong>“singular” or “degenerate”</strong></li>
</ul>
<p>So how can we get the inverse matrix?</p>
<p>Sometimes you can compute inverses by hand but almost no one does that those day. It turns out there is very good <strong>numerical software</strong> for taking a matrix and computing.</p>
<p><strong>Matrix Transpose:</strong></p>
<p>The transpose of a matrix is an operator which flips a matrix over its diagonal.</p>
<p><img src="https://superming.life/2020/11/01/MachineLearning-Week1/Screen_Shot_2020-10-29_at_10.14.30_AM.png" alt="MachineLearning-Week1/Screen_Shot_2020-10-29_at_10.14.30_AM.png"></p>
<p>Matlab Command</p>
<h2 id><a href="#" class="headerlink" title></a><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Initialize matrix A </span></span><br><span class="line">A = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>;<span class="number">0</span>,<span class="number">5</span>,<span class="number">6</span>;<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">% Transpose A </span></span><br><span class="line">A_trans = A&#x27; </span><br><span class="line"></span><br><span class="line"><span class="comment">% Take the inverse of A </span></span><br><span class="line">A_inv = inv(A)</span><br><span class="line"></span><br><span class="line"><span class="comment">% What is A^(-1)*A? </span></span><br><span class="line">A_invA = inv(A)*A</span><br><span class="line"></span><br><span class="line">A =</span><br><span class="line">     <span class="number">1</span>     <span class="number">2</span>     <span class="number">0</span></span><br><span class="line">     <span class="number">0</span>     <span class="number">5</span>     <span class="number">6</span></span><br><span class="line">     <span class="number">7</span>     <span class="number">0</span>     <span class="number">9</span></span><br><span class="line">A_trans =</span><br><span class="line"></span><br><span class="line">     <span class="number">1</span>     <span class="number">0</span>     <span class="number">7</span></span><br><span class="line">     <span class="number">2</span>     <span class="number">5</span>     <span class="number">0</span></span><br><span class="line">     <span class="number">0</span>     <span class="number">6</span>     <span class="number">9</span></span><br><span class="line">A_inv =</span><br><span class="line"></span><br><span class="line">    <span class="number">0.3488</span>   <span class="number">-0.1395</span>    <span class="number">0.0930</span></span><br><span class="line">    <span class="number">0.3256</span>    <span class="number">0.0698</span>   <span class="number">-0.0465</span></span><br><span class="line">   <span class="number">-0.2713</span>    <span class="number">0.1085</span>    <span class="number">0.0388</span></span><br><span class="line">A_invA =</span><br><span class="line"></span><br><span class="line">    <span class="number">1.0000</span>   <span class="number">-0.0000</span>    <span class="number">0.0000</span></span><br><span class="line">    <span class="number">0.0000</span>    <span class="number">1.0000</span>   <span class="number">-0.0000</span></span><br><span class="line">   <span class="number">-0.0000</span>         <span class="number">0</span>    <span class="number">1.0000</span></span><br></pre></td></tr></table></figure></h2><h1 id="FAQ-for-Week1"><a href="#FAQ-for-Week1" class="headerlink" title="FAQ for Week1:"></a>FAQ for Week1:</h1><p><strong>Q1: In the cost function, why don’t we use absolute value(or mod(), or some other function) instead of the squared error?</strong></p>
<p>The absolute value has some bad characteristics for  minimization.</p>
<ul>
<li>The gradient is not continuous because the absolute value function is not differentiable at its minimum point.</li>
<li>It does not emphasize the correction of large errors.</li>
<li>The abs() function is also not very mathematically efficient.</li>
</ul>
<p>However, the squared error cost function has some very desirable characteristics:</p>
<ul>
<li>The cost can be computed very efficiently.</li>
<li>Its partial derivative is easily computed.</li>
<li>Its partial derivative is continuous.</li>
</ul>
<p><strong>Q2: How does the Cocktail Party problem work?</strong></p>
<p>It isn’t clustering.</p>
<p>Clustering would not preserve the time-sequence of the sound samples, so the results would not sound like speech.</p>
<p>The method used is Principal Component Analysis. This method is a mathematical trick that takes two sets of correlated data, and returns two new sets of data that are not correlated. The sequence of the data is retained.</p>
<p>If the data is audio recordings, the result has the effect to the human ear of sounding like two separate audio tracks.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2020/10/23/%E4%B8%8D%E8%83%BD%E6%89%BF%E5%8F%97%E7%94%9F%E5%91%BD%E4%B9%8B%E8%BD%BB%20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2020/10/23/%E4%B8%8D%E8%83%BD%E6%89%BF%E5%8F%97%E7%94%9F%E5%91%BD%E4%B9%8B%E8%BD%BB%20/" itemprop="url">《不能承受生命之轻》</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-10-23T15:15:55+08:00">
                2020-10-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/Books/" itemprop="url" rel="index">
                    <span itemprop="name">Books</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2020/10/23/%E4%B8%8D%E8%83%BD%E6%89%BF%E5%8F%97%E7%94%9F%E5%91%BD%E4%B9%8B%E8%BD%BB%20/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2020/10/23/%E4%B8%8D%E8%83%BD%E6%89%BF%E5%8F%97%E7%94%9F%E5%91%BD%E4%B9%8B%E8%BD%BB%20/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2020/10/23/%E4%B8%8D%E8%83%BD%E6%89%BF%E5%8F%97%E7%94%9F%E5%91%BD%E4%B9%8B%E8%BD%BB%20/" class="leancloud_visitors" data-flag-title="《不能承受生命之轻》">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="《不能承受生命之轻》"><a href="#《不能承受生命之轻》" class="headerlink" title="《不能承受生命之轻》"></a>《不能承受生命之轻》</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p><a target="_blank" rel="noopener" href="https://book.douban.com/subject/1017143/">豆瓣</a></p>
<p>Milan Kundera最富盛名的作品。</p>
<p>空洞，却又深沉的阅读体验。 - 2020.10.23</p>
<h2 id="摘录"><a href="#摘录" class="headerlink" title="摘录"></a>摘录</h2><h3 id="第一章：轻与重"><a href="#第一章：轻与重" class="headerlink" title="第一章：轻与重"></a>第一章：轻与重</h3><p>1.</p>
<p>永恒轮回是一种神秘的想法，尼采曾用它不少哲学家陷入窘境：想想吧，有朝一日，一切都将以我们经历过的方式再现，而且这种反复还将无限重复下去！这一谵妄之说到底意味着什么？</p>
<!---more --->
<p>永恒轮回之说从反面肯定了生命一旦永远消逝，便不再回复，似影子一般，了无分量，未先灭亡，即使它是残酷，美丽，或是绚烂的，这份残酷、美丽和绚练也都没有意义。</p>
<p>且说永恒轮回的想法表达了这样一种视角，事物并不想是我们所认知的一样，因为事情在我们看来并不是因为转瞬即逝就具有减罪之情状。</p>
<p>与希特勒的这种和解，暴露了一个建立在轮回不存在之上的世界所固有的深刻道德沉沦，因为在这个世界上，<strong>一切都预先被谅解了，一切也就被卑鄙的许可了</strong>。</p>
<p>2.</p>
<p>如果我们生命中的每一秒钟都得无限重复，我们就会像耶稣一样被钉死在十字架上一样被钉死在永恒上。这一想法是残酷的。在永恒轮回世界里，一举一动都承受着不能承受的责任重负。这就是尼采说永恒轮回的想法是最沉重的负担的缘故吧。</p>
<p>最沉重的负担压迫者我们，让我们屈服于它，把我们压倒到地上。但在历代的爱情诗中，女人总渴望承受一个男性身体的重量。于是，最沉重的负担同时也成了最强盛的生命力的影像。负担越重，我们的生命就越贴近大地，它就越真实的存在。</p>
<p>相反，当负担完全缺失，人就会变得比空气还轻，就会飘起来，就会远离大地和地上的生命，人也就只是一个半真的存在，其运动也就变得自由而没有意义。</p>
<p>那么，到底选择什么？是重还是轻？</p>
<p>巴门尼德早在公元前六世纪就给自己提过这个问题，在他看来，宇宙是被分割成一个个对立的二元：明与暗，厚与薄，热与冷，与在非在。他把对立的一极视为正极，另一极视为负极，这种正负之极的区分在我们看来可能显得幼稚简单。除了在这个问题上：何为正，是重还是轻？</p>
<p>巴门尼德答道：轻者为正，重者为负。他到底是对是错？这是一个问题。只有一样是确定的：重与轻的对立是所有对立中最神秘、最模糊的。</p>
<p>3.</p>
<p>人永远都无法知道自己该要什么，因为人只能活一次，既不能拿它跟它的前世相比，也不能在来生加以修正。</p>
<p>和特蕾莎在一起好呢，还是一个人好呢？</p>
<p>没有任何方法可以检验哪种抉择是好的，因为不存在任何比较。一切都是马上经历，仅此一次，不能准备。好像一个演员没有排练就上了舞台。<strong>如果生命的初次排练就是生命本身，那么生命到底会有什么价值？正因为这样，生命才是一张草图。</strong>但“草图“这个词还不确切，因为一张草图是某件事情的雏形，比如一幅画的草稿，而我们生命的草图却不是任何东西的草稿，它是一张成不了画的草图。</p>
<p>只能活一次，就和根本没有活过一样。</p>
<p>4.</p>
<p>于是他明白自己天生不是能在一个女人身边过日子的人，不管这个女人是谁，他也明白了只有单身，自己才感到真正自在。</p>
<p>托马斯当时还没有意识到，比喻是一种危险的东西。人是不能和比喻闹着玩的，一个简单比喻，便可从中产生爱情。</p>
<p>6.</p>
<p>爱情并不是通过做爱的欲望（这可以是对无数女人的欲求）体现的，而是通过和她共眠的欲望（这只能是对一个女人的欲求）而体现出来的。</p>
<p>14.</p>
<p>他和特蕾莎之间的爱情无疑是美好的，但也很累人：总要瞒着什么，又是隐藏，又是假装，还得讲和，让她振作，给她安慰，翻来覆去向她证明他爱她，还要忍受因为嫉妒、痛苦、做噩梦而产生的满腹怨艾，总之，他总能感受到自己有罪，得为自己开脱，请对方原谅。现在，再也不用受累了，剩下的只有美好。</p>
<p>星期六的夜晚开始了；他第一次肚子在苏黎世漫步，深深地呼吸着自由的芬芳。在每个角落，都潜藏着诱惑。未来成了一个谜。他又回到单身汉的生活，他曾坚信自己命中注定要过这种生活，因为只有在这样的生活中他才真正是他自己。</p>
<p>16.</p>
<p>重、必然和价值是三个有内在联系的概念；必然者为重，重者才有价值。</p>
<p>17.</p>
<p><strong>我们都觉得，我们生命中的爱情若没有分量、无足轻重，那简直不可思议；我们总是想象我们的爱情是它应该存在的那种，没有了爱情，我们的生命将不再是我们应有的生命。</strong></p>
<h3 id="第二章：灵与肉"><a href="#第二章：灵与肉" class="headerlink" title="第二章：灵与肉"></a>第二章：灵与肉</h3><p>8.</p>
<p>母亲要为自己伸张正义，她要罪犯受到惩罚。她坚持要女儿和她都活在一个没有羞耻的世界里。在这个世界里，青春和眉毛了无意义，世界只不过是一个巨大的肉体集中营，一句句肉体彼此相像，而灵魂是根本看不见的。</p>
<p>9.</p>
<p>但是，如果一件事取决于一系列的偶然，难道不是正说明了它非同寻常而且意味深长？</p>
<p>凡事必然发生的事，凡事期盼得到，每日重复的事，都悄无声息。</p>
<p>11.</p>
<p>我们每天的生活充满了各种偶然性，确切的说，是人、事之间的偶然相遇，我们称之为巧合。两件预料不到的事情出现在同一时刻，就叫巧合。</p>
<p>人生就像谱写乐章。人在美感的引导下，把偶然的事件变成一个主题，然后记录在生命的乐章中，犹如作曲家谱写奏鸣曲的主旋律，人生的主题也在反复出现、重演、修正、延展。安娜可以用任何一种方式结束生命，但是车站、死亡这个难忘的主题和爱情的萌生结合在一起，在她绝望的一刹那，以凄凉之美诱惑着她。人就是根据美的法则在谱写生命乐章，直至深深的绝望时刻的到来，然而自己一无所知。</p>
<p><strong>因此我们不能指责小说，说被这些神秘的偶然巧合所迷惑，但我们有理由责备人类因为对这些偶然巧合视而不见而剥夺了生命的美丽。</strong></p>
<p>12.</p>
<p>为了不让自己哭出声来，她不停地大声说话，一边说，一边笑着。而他还是和上次一样，几乎她刚跨进门槛，他就把他用在怀里，然后他们就做爱。她跌落在一片浓雾里，什么也看不见，什么也听不见，除了她的叫声。</p>
<p>18.</p>
<p>她时刻感受到一种不可抑制想要摔倒的渴望，她活在一种时刻发晕的状态之中。</p>
<p>23.</p>
<p>沙俄帝国过去所犯下的罪行都隐藏在秘密的阴影中。五十万立陶宛人被放逐，成千上万波兰人被杀戮，对克里米亚的鞑靼人进行灭绝种族的屠杀，所有这一切只留在记忆里，却没有留下任何图片作为证据，就像一件无法论证的事情，迟早会被说成骗人的谎言。</p>
<p>24.</p>
<p>女摄影师用一种母性的语气接着说到：“赤裸的身体。怎么了！这很正常！<strong>一切正常的都是美的！</strong>”</p>
<h3 id="第三部：不解之词"><a href="#第三部：不解之词" class="headerlink" title="第三部：不解之词"></a>第三部：不解之词</h3><p>1.</p>
<p>对他来说，爱情是一种甘心屈从于对方的意愿和控制的热爱。委身于对方就如同投降的士兵一样，必须首先缴械。因此，自己没了防备，他便止不住担心那致命一击何时降临。所以，我可以说，爱情之于弗兰茨，就是对死亡的不断等待。</p>
<p>2.</p>
<p>假若人还年轻，他们的生命乐章不过刚刚开始，那他们可以一同创作旋律，交换动机，到那时，当他们在比较成熟的年纪相遇，每个词，每件物所指的意思便各不相同。</p>
<p>3.</p>
<p>对萨比娜来说，活着意味着观看。视觉受双重边界所限：让人什么也看不见的强光与完全彻底的黑暗。他对任何极端主义的憎恶，或许产生于此。极端标志生命的终极之界，极端主义的激情，不论是政治上的，还是艺术上的，都是一种改头换面的对死的渴望。</p>
<p>5.</p>
<p>弗兰茨说：“在欧洲，美总是带有刻意的特点，总是先有唯美的构想或长久的计划，比如一座哥特式大教堂或一座文艺复兴式的城市，得按计划，花几个漫长的世纪才能建成。纽约的没则完全来自于另一种源头。这是一种非刻意的没。它无需经过人的预先谋划，就像钟乳石溶洞一样自然天成。有些形态，本身很丑，未经任何筹划，可捧碰巧在一个看似不可思议的环境中，突然之间便散发出一种魔力般的诗意来。”</p>
<p>萨比娜接着说：“非刻意的美。是的。还可以说是错误的美。美从世界上彻底消失之前，还会存在片刻，却是因错而生。错误的美，是美的历史末期。”</p>
<p>文化就在大批的制造、言语的泛滥、数量的失控中逐渐消亡。</p>
<p>7.</p>
<p>美就是被背弃的世界。只有当迫害者误将它遗忘在某个角落时，我们才能与它不期而遇。美就隐藏在五一节游行的场景背后。要发现美，就必须把那场景击破。</p>
<p>活在真实里<br>这是卡夫卡在他的日记或书信中写过的一句话。确切的出处，弗兰茨已经记不起。他被这种说法吸引住了。活在真实里，是什么意思？否定的方式很简单：不说谎，不欺骗，不隐瞒。</p>
<p>10.</p>
<p>人的悲剧总可以用沉重来比喻。人常说重担落在我们肩上。我们背负着这个重担，承受的起或承受不起。</p>
<h3 id="第四部：灵与肉"><a href="#第四部：灵与肉" class="headerlink" title="第四部：灵与肉"></a>第四部：灵与肉</h3><p>4.</p>
<p>从那以后，她明白了集中营绝无特别之处，没有什么值得让人惊讶的，而是某种命定，根本性的东西，来到世上，就是来到它的中间，不拼进权利，就不可能从中逃出去。</p>
<p>8.</p>
<p>什么是调情？可以说调情是一种暗示有进一步性接触可能的行为，但又不担</p>
<p>保这种可能性一定能够兑现。换言之，调情是没有保证的性交承诺。</p>
<p>17.</p>
<p>因为刺激是灵魂的，正是身体对她意愿的不由自主的叛逆，正是其对这一叛逆的参与。</p>
<p>25.</p>
<p>要逃避痛苦，最常见的，就是躲进未来。在时间轨道上，人们想象有一条线，超脱了这条线，当前的痛苦便不复存在。</p>
<p>28.</p>
<p>爱情就像是帝国：它们建立在信念之上，信念一旦消失，帝国也随之灭亡。</p>
<h3 id="第五部：轻与重"><a href="#第五部：轻与重" class="headerlink" title="第五部：轻与重"></a>第五部：轻与重</h3><p>6.</p>
<p>他已经很清楚人们的心理，他们从别人的精神耻辱中得到无比的快乐，根本不愿有什么解释来糟蹋这种快乐。</p>
<p>10.</p>
<p>追逐众多女性的男人很容易被分为两类。一类人在所有女人身上寻找他们自己的梦，他们对于女性的主观意念。另一类人则被欲念所驱使，想占有客观女性世界的无尽的多样性。</p>
<p>前者的迷恋是浪漫型的迷恋：他们在女人身上寻找的是他们自己，是他们的理想。他们总是不断地失望，因为，正如我们所知，理想从来都不是可能找到的。失望把他们从一个女人推向另一个女人，赋予他们的善变一种感伤的借口，因此，许多多愁善感的女人为他们的顽强的纠缠所感动。</p>
<p>后者的迷恋是放荡型的迷恋，女人在其中看不到丝毫感人之处：由于男人没有在女性身上寄托一个主观的理想，他们对所有女人都感兴趣，没有谁会令他们失望。的确，就是着从不失望带有某种可耻的成分。在世人眼中，放浪之徒的迷恋是不可宽恕的。</p>
<p>12.</p>
<p>不爱，并不意味着托马斯对那个年轻的女人厚颜无耻，像人们说的那样，只是把她看作性工具。相反，他像爱女友一般爱他，欣赏她的个性和智慧，只要她有需要，他随时会帮她。待她不好的不是他，而是他的记忆，他也无能为力，是记忆将她的爱情区域排除出来。</p>
<p>“我寻求的不是快感，而是幸福。没有幸福的快感，那算不上快感。”</p>
<p>爱开始于一个女人以某句话印在我们诗化记忆中的那一刻。</p>
<p>15.</p>
<p>人只能活一回，我们无法验证决定的对错，因为，在任何情况下，我们只能做一个决定。上天不会赋予我们第二次，第三次，第四次生命以供比较不同的决定。</p>
<p>16</p>
<p>只有在这种乌托邦式的前景中，悲观和乐观的概念才具有一定的意义：凡认为人类历史在五号星球上会变得不那么血腥的，为乐观主义者。凡不这么认为的，则为悲观主义者。</p>
<h3 id="第六章：伟大的进军"><a href="#第六章：伟大的进军" class="headerlink" title="第六章：伟大的进军"></a>第六章：伟大的进军</h3><p>2.</p>
<p>斯大林之子因粪便而献出了自己的生命，但是为粪便而死并不是一种毫无意义的死。德国人不惜牺牲生命向东方拼命扩张帝国的领土，俄国人则为向西方扩张自己的势力范围而丧生，是的，这些人为愚蠢的事情而死，他们的死才毫无意义，才没有任何价值。相反，斯大林儿子之死是在战争的普遍愚蠢之中唯一的具有形而上学意义的死。</p>
<p>9.</p>
<p>没有人比政治家更深谙这一点。只要附近有一架照相机，一见到孩子，他们就会跑过去把他抱在怀中，亲她的脸蛋儿。媚俗，就是所有政治家，所有的政治运动的美学理想。</p>
<p>在一个多流派并存，多种势力相互抵消，相互制约的社会里，多少还可以摆脱媚俗的专横；个人可以维护自己的个性，艺术家可以创造处不同凡响的作品。但是在某个政治运动独霸整个权利的地方，人们便一下置身于极权的媚俗之王国。</p>
<p>我说“极权”，那是因为有损于媚俗的一切，必须被清处生活：任何个人主义的表现、任何怀疑、任何嘲讽、甚至是抛弃家庭母亲，爱男人剩余爱女人的那人，都是有损你媚俗的行为。因为这就是威胁那句神圣不可侵犯的口号“多生多育“。</p>
<p>从这一点来看，所谓古拉格，可以被视为极权的媚俗乱倒垃圾的化粪坑。</p>
<p>10.</p>
<p>特蕾莎揭露了媚俗的真正作用：媚俗是掩盖死亡的一道屏风。</p>
<p>11.</p>
<p>在极权媚俗之王国，总是现有答案并排除一切新问题。所以极权的媚俗的真正对手就是爱发问的人。问题就像刚裁开装饰画布的刀让人看到隐藏其后的东西。萨比娜就是这样像特蕾莎解释那些油画的意义的：前面是明明白白的谎言，后面则是隐现出让人无法理解的真相。</p>
<p>人们总像以自己的生活制造媚俗，要摆脱它，得付出多少艰辛，令人绝望。</p>
<p>29.</p>
<p>弗兰茨留下了什么？</p>
<p>一句碑文：迷途漫漫，终有一归。</p>
<p>等等，如此等等。在被遗忘之前，我们会变得媚俗。媚俗，是存在与遗忘之间的中转站。</p>
<h3 id="第七部：卡列宁的微笑"><a href="#第七部：卡列宁的微笑" class="headerlink" title="第七部：卡列宁的微笑"></a>第七部：卡列宁的微笑</h3><p>2.</p>
<p>《创世纪》的开篇写到，上帝造人是为了让人统治鸟、鱼、牲畜。当然，《创世纪》是人写的，而不是一匹马写的。因此，并不能完全断定上帝是真的希望人类统治其他生物。更有可能是人类发明了上帝，以便使其篡夺来的对牛马的支配权合乎神圣法则。对，就是杀死一只鹿或一头母牛的权利，全人类在这一点上达到来共识，即使是在最血腥的战争年代也不例外。</p>
<p>4.</p>
<p>她倒是觉得人类夫妻这种创造，本来就是让男女之爱从根本上就不及人与狗之间可能产生的爱。这真是人类历史上的怪现象，造物主当初或许并没有打算这样安排。</p>
<p>7.</p>
<p>任何人都没有使命。当你发现自己是自由的，没有任何使命时，便是一种极大的解脱。</p>
<p>他们来来回回，合着钢琴声和小提琴声迈着舞步，特蕾莎的头靠在托马斯的肩上，两人就像坐着飞机在云雾里穿行。此刻她又感受到了那种奇特的幸福，那种奇特的忧虑。这忧虑意味着：我们已经在最后一站。这幸福意味着：我们在一起。忧虑是形式，幸福是内容。幸福充盈着忧虑的空间。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superming.lifehttps://superming.life/2020/10/17/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://superming.life/images/ninja8.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="https://superming.life/2020/10/17/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" itemprop="url">Insertion</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-10-17T12:16:55+08:00">
                2020-10-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https://superming.life/categories/CS/" itemprop="url" rel="index">
                    <span itemprop="name">CS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="https://superming.life/2020/10/17/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="https://superming.life/2020/10/17/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="https://superming.life/2020/10/17/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" class="leancloud_visitors" data-flag-title="Insertion">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h1><h2 id="直接插入排序（Straight-Insertion-Sort）"><a href="#直接插入排序（Straight-Insertion-Sort）" class="headerlink" title="直接插入排序（Straight Insertion Sort）"></a>直接插入排序（Straight Insertion Sort）</h2><p>直接插入排序是简单直观的排序方法，将一个记录插入到已排好的有序表中，从而得到一个新的、记录数增1的有序表。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="https://superming.life/2020/10/17/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="https://superming.life/page/2/">2</a><a class="page-number" href="https://superming.life/page/3/">3</a><a class="extend next" rel="next" href="https://superming.life/page/2/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://superming.life/images/ninja8.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://superming.life/archives/">
              
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="https://superming.life/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="https://superming.life/tags/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="https://superming.life/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="mailto:supermingzero@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/AlenZhang-Dev" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/zzz-65-21-31/activities" target="_blank" title="Zhihu">
                      
                        <i class="fa fa-fw fa-circle"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.instagram.com/alen_zhang_bubble/" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/u/5982658581" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i></a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AlenZhang</span>

  
</div>









<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共84.7k字</span>
</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="https://superming.life/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="https://superming.life/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="https://superming.life/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="https://superming.life/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="https://superming.life/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="https://superming.life/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="https://superming.life/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="https://superming.life/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="https://superming.life/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'qwoVwWOTHdN9LlXpTz7BojRm-gzGzoHsz',
        appKey: 'GvmFzmeE5nuRcXTSQNH3icVD',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("qwoVwWOTHdN9LlXpTz7BojRm-gzGzoHsz", "GvmFzmeE5nuRcXTSQNH3icVD");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
