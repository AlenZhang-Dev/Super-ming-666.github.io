<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"superming.life","root":"/","images":"/images","scheme":"Mist","version":"8.2.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta name="description" content="Quick SortThe quicksort algorithm has a worst-case running time of $\Theta(n^{2})$ on input array of n numbers. Despite this slow worst-cast running time, quicksort is often the best practical choice">
<meta property="og:type" content="article">
<meta property="og:title" content="QuickSort">
<meta property="og:url" content="https://superming.life/2021/05/13/quicksort/index.html">
<meta property="og:site_name" content="AlenZhang&#39;s Blog">
<meta property="og:description" content="Quick SortThe quicksort algorithm has a worst-case running time of $\Theta(n^{2})$ on input array of n numbers. Despite this slow worst-cast running time, quicksort is often the best practical choice">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_8.39.38_AM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_8.36.49_AM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_11.28.55_AM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_11.28.27_AM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_9.09.17_AM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_9.48.36_AM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.13.19_PM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_4.00.02_PM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.32.19_PM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_11.22.21_AM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.35.34_PM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.37.51_PM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_4.40.58_PM.png">
<meta property="og:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.40.58_PM.png">
<meta property="article:published_time" content="2021-05-13T03:04:41.000Z">
<meta property="article:modified_time" content="2021-05-13T03:07:22.694Z">
<meta property="article:author" content="AlenZhang">
<meta property="article:tag" content="Algorithms">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://superming.life/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_8.39.38_AM.png">


<link rel="canonical" href="https://superming.life/2021/05/13/quicksort/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>
<title>QuickSort | AlenZhang's Blog</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="/custom_css_source.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="AlenZhang's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">AlenZhang's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Quick-Sort"><span class="nav-number">1.</span> <span class="nav-text">Quick Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Description"><span class="nav-number">1.1.</span> <span class="nav-text">Description.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Performance"><span class="nav-number">1.2.</span> <span class="nav-text">Performance.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Worst-case"><span class="nav-number">1.3.</span> <span class="nav-text">Worst-case.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Best-case"><span class="nav-number">1.4.</span> <span class="nav-text">Best-case.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Balanced-partitioning"><span class="nav-number">1.5.</span> <span class="nav-text">Balanced partitioning.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Improvements"><span class="nav-number">1.6.</span> <span class="nav-text">Improvements.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-way-Partitioning"><span class="nav-number">1.7.</span> <span class="nav-text">3-way Partitioning</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="AlenZhang"
      src="/images/ninja8.jpg">
  <p class="site-author-name" itemprop="name">AlenZhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">32</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:supermingzero@gmail.com" title="E-Mail → mailto:supermingzero@gmail.com" rel="noopener" target="_blank"><i class="far fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/AlenZhang-Dev" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AlenZhang-Dev" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.instagram.com/alen_zhang_bubble/" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;alen_zhang_bubble&#x2F;" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/t.me/AlenZhang" title="Telegram → t.me&#x2F;AlenZhang"><i class="fab fa-telegram fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2021/05/13/quicksort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja8.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          QuickSort
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-13 11:04:41" itemprop="dateCreated datePublished" datetime="2021-05-13T11:04:41+08:00">2021-05-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>7k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>6 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Quick-Sort"><a href="#Quick-Sort" class="headerlink" title="Quick Sort"></a>Quick Sort</h1><p>The quicksort algorithm has a worst-case running time of $\Theta(n^{2})$ on input array of n numbers.</p>
<p>Despite this slow worst-cast running time, quicksort is often the best practical choice for sorting because it’r remarkably efficient on the average.</p>
<p>It also has the advantage of sorting <strong>in place</strong>. Also it works well in virtual-memory environments.</p>
<a id="more"></a>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description."></a><strong>Description.</strong></h2><p>Use the conception of divide-and-conquer paradigm. </p>
<p><strong>Divide</strong>: Partition (rearrange) the array A[p…r] into two (possibly empty) subarrays A[p, q- 1]and A[q+1, r] such that each element of A[p, q- 1] is less than or equal to A[q], which is, in turn, less than or equal to each element of A[q+1, r]. Compute the index q as part of this partitioning procedure.</p>
<p><strong>Conquer</strong>: Sort the two subarrays A[p, q- 1] and A[q+1, r] by recursive calls to quicksort.</p>
<p><strong>Combine</strong>: The subarrays are already sorted, no work is needed to combine them: the entire array is sorted.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(A, low, high)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(low &lt; high)&#123;</span><br><span class="line">        <span class="keyword">int</span> index = partition(A, low, high);</span><br><span class="line">        quickSort(A, low, index - <span class="number">1</span>);</span><br><span class="line">        quickSOrt(A, index + <span class="number">1</span>, high);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Partitioning the array.</p>
<p>The partition function make sure put the pivot to the right position. All elements at the left of the pivot is smaller than the pivot, on the right is larger than the pivot.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//The goal of the partition function is that find the right position of pivot.</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pivot = A[high];</span><br><span class="line">    <span class="keyword">int</span> i = low - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = low; j &lt; high; ++j)&#123;</span><br><span class="line">        <span class="keyword">if</span>(A[j] &lt; pivot)&#123;</span><br><span class="line">            i++;</span><br><span class="line">            swap(A, i, j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    swap(A, i + <span class="number">1</span>, high);</span><br><span class="line">    <span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Condition during for loop:</p>
<ol>
<li><code>A[low, i] &lt; pivot</code></li>
<li><code>A[i+1, j] &gt; pivot</code></li>
</ol>
<p>The four region maintained by the procedure PARTITION on a subarray A[p..r].</p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_8.39.38_AM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2021-05-12_at_8.39.38_AM.png"></p>
<p>The operation of partition sample:</p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_8.36.49_AM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2021-05-12_at_8.36.49_AM.png"></p>
<p>Maintain the low and high point. Make sure low point to the element which is smaller than pivot, and </p>
<p>Conditions:</p>
<ol>
<li><p><code>A[0, low] &lt; pivot</code></p>
</li>
<li><p><code>A[low, length] &gt; pivot</code></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">moveBothPartition</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pivot = A[high];</span><br><span class="line">    <span class="keyword">while</span>(low &lt; high)&#123;</span><br><span class="line">        <span class="keyword">while</span>(low &lt; high &amp;&amp; A[low] &lt;= pivot)</span><br><span class="line">            low++;</span><br><span class="line">        swap(arr, low, high);</span><br><span class="line">        <span class="keyword">while</span>(low &lt; high &amp;&amp; A[high] &lt;= pivot)</span><br><span class="line">            high--;</span><br><span class="line">        swap(arr, low, high);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> low;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Java implementation in Algs.4</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">partition</span><span class="params">(Comparable[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = lo, j = hi + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">        <span class="comment">//find the item on left to swap</span></span><br><span class="line">        <span class="keyword">while</span>(less(a[++i], a[lo])</span><br><span class="line">            <span class="keyword">if</span>(i == hi) <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">//find the item on right to swap</span></span><br><span class="line">        <span class="keyword">while</span>(less(a[lo], a[--j])</span><br><span class="line">            <span class="keyword">if</span>(j == lo) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(i &gt;= j) <span class="keyword">break</span>;</span><br><span class="line">        exch(a, i, j);</span><br><span class="line">    &#125;</span><br><span class="line">    exch(a, lo, j)</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(Comparable[] a)</span></span>&#123;</span><br><span class="line">    StdRandom.shuffle(a);</span><br><span class="line">    sort(a, <span class="number">0</span>, a.lenght-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(comparable[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(hi &lt;= lo) </span><br><span class="line">     	<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> j = partition(a, lo, hi);</span><br><span class="line">    sort(a, lo, j - <span class="number">1</span>);</span><br><span class="line">    sort(a, j + <span class="number">1</span>; hi);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The running time of Partition on the subarray A[p..r] is $\Theta (n)$, where <code>n = r - p + 1</code>;</p>
<h2 id="Performance"><a href="#Performance" class="headerlink" title="Performance."></a><strong>Performance.</strong></h2><p>The running time of quicksort depends on whether the partitioning is balanced or unbalanced, which in turn depends on which elements are used for partitioning.If the partitioning is balanced, the algorithm runs asymptotically as fast as merge sort. If unbalanced, it can run as slowly as insertion sort.</p>
<h2 id="Worst-case"><a href="#Worst-case" class="headerlink" title="Worst-case."></a><strong>Worst-case.</strong></h2><p>the worst-case behavior occurs when the partition routine produces one subproblem with n - 1 elements and one with 0 element. The partition cost $\Theta(n)$ time. Since the recursive call on an array of size 0 just returns, T(0) = $\Theta(1)$.The recurrence for the running time is $T(n) = T(n - 1) + T(0) + \Theta(n) = T(n-1) + \Theta(n)$</p>
<p>Intuitively, the total cost is $\Theta(n^{2})$.</p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_11.28.55_AM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2021-05-12_at_11.28.55_AM.png"></p>
<h2 id="Best-case"><a href="#Best-case" class="headerlink" title="Best-case."></a><strong>Best-case.</strong></h2><p>In the most even case, partition produces two subproblems, each of size no more than n/2, since one is of size $\left \lfloor n/2 \right \rfloor$ and one of size $\left \lfloor n/2 - 1 \right \rfloor$. In this case, the recurrence for the running time is $T(n) = 2T(n/2) + \Theta(n)$.</p>
<p>The total cost is $\Theta(nlgn)$.</p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_11.28.27_AM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2021-05-12_at_11.28.27_AM.png"></p>
<h2 id="Balanced-partitioning"><a href="#Balanced-partitioning" class="headerlink" title="Balanced partitioning."></a><strong>Balanced partitioning.</strong></h2><p>The average-case running time of quicksort is much closer to the best case than to the worst case.</p>
<p>Assume algorithms always produces a 9-to-1 proportional split, it seems quite unbalanced. </p>
<p>The recurrence is $T(n)=T(9n/10)+T(n/10)+cn$.</p>
<p>It create a recursion tree of depth $\Theta(lgn)$ .</p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_9.09.17_AM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2021-05-12_at_9.09.17_AM.png"></p>
<p>The total cost of quicksort is therefore $\Theta(nlgn)$.The running time is therefore $\Theta(nlgn)$ whenever the split has constant proportionality.</p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_9.48.36_AM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2021-05-12_at_9.48.36_AM.png"></p>
<p><strong>A randomized version of quicksort.</strong></p>
<p>In exploring the average-case behavior of quicksort, we have made an assumption that all permutations of the input numbers are equally likely. Many people regard the resulting randomized version of quicksort as the sorting algorithm of choice for large enough inputs.</p>
<p>We could do a <strong>random sampling</strong> to simpler analysis. So we select a randomly chosen element from the subarray as the pivot.we ensure that the pivot element <code>x = A[r]</code> is equally likely to be any of the <code>r - p + 1</code> elements in the subarray.</p>
<p>The change is small.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">random</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">    Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">    <span class="keyword">int</span> pivot = rand.nextInt(high - low) + low;</span><br><span class="line">    swap(A, pivot, high);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">partition_random</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">    random(a, low, high);</span><br><span class="line">    <span class="keyword">int</span> pivot = arr[high];</span><br><span class="line">    <span class="keyword">int</span> i = low - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = low, j &lt; high; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[j] &lt; pivot)</span><br><span class="line">            swap(a, i, j);</span><br><span class="line">    &#125;</span><br><span class="line">    swap(a, i + <span class="number">1</span>, j);</span><br><span class="line">    <span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> q = partition_random(a, low, high);</span><br><span class="line">    partition_random(a. p, q -<span class="number">1</span>);</span><br><span class="line">    partition_random(a, q + <span class="number">1</span>, high);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The worst case is still $\Theta(n^{2})$.  The expected running time is $\Theta(nlogn)$. [The analysis of the algorithms check CLRS 7.4.2]</p>
<h2 id="Improvements"><a href="#Improvements" class="headerlink" title="Improvements."></a><strong>Improvements.</strong></h2><p><strong>Insertion sort small subarrays.</strong></p>
<ul>
<li>Even quicksort has too much overhead for tiny subarrays.</li>
<li>Cutoff to insertion sort for ≈ 10 items.</li>
<li>Note: could delay insertion sort until one pass at end.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(Comparable[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (hi &lt;= lo + CUTOFF - <span class="number">1</span>)&#123;</span><br><span class="line">      Insertion.sort(a, lo, hi);</span><br><span class="line">      <span class="keyword">return</span>; </span><br><span class="line">    &#125;</span><br><span class="line">   <span class="keyword">int</span> j = partition(a, lo, hi);</span><br><span class="line">   sort(a, lo, j-<span class="number">1</span>);</span><br><span class="line">   sort(a, j+<span class="number">1</span>, hi);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Median of sample.</strong></p>
<ul>
<li>Best choice of pivot item = median.</li>
<li>Estimate true median by taking median of sample.</li>
<li>Median-of-3(random) items.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(Comparable[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (hi &lt;= lo) <span class="keyword">return</span>;</span><br><span class="line">   <span class="keyword">int</span> m = medianOf3(a, lo, lo + (hi - lo)/<span class="number">2</span>, hi);</span><br><span class="line">   swap(a, lo, m);</span><br><span class="line">   <span class="keyword">int</span> j = partition(a, lo, hi);</span><br><span class="line">   sort(a, lo, j-<span class="number">1</span>);</span><br><span class="line">   sort(a, j+<span class="number">1</span>, hi);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/7559608/median-of-three-values-strategy">median of three values strategy</a></p>
<p><strong>Selection</strong></p>
<p>Goal. Given a array of N items, find a k^th smallest item.</p>
<p>Ex. Min(k = 0), max(k = N -1), median(k = N/2)</p>
<p>Applications.</p>
<ul>
<li>Order statistics.</li>
<li><p>Find the “top k.”</p>
<p>  <img src="/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.13.19_PM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2020-11-27_at_3.13.19_PM.png"></p>
</li>
</ul>
<p><strong>Quick-select</strong></p>
<p>Partition array so that:</p>
<ul>
<li>Entry a[j] is in place.</li>
<li>No larger entry to the left of j.</li>
<li>No smaller entry to the right of j.</li>
</ul>
<p>Repeat in one subarray, depending on j, finished when j equals k.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Compareble <span class="title">select</span><span class="params">(Comparable[] a, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    StdRandom.shuffle(a);</span><br><span class="line">    <span class="keyword">int</span> lo = <span class="number">0</span>, hi = a.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(hi &gt; lo)&#123;</span><br><span class="line">        <span class="keyword">int</span> j = partition(a, lo, hi);</span><br><span class="line">        <span class="keyword">if</span>(j &lt; k) lo = j + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; k) hi = j - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> a[k];		</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a[k];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Mathematical analysis</strong></p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_4.00.02_PM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2020-11-27_at_4.00.02_PM.png"></p>
<p><strong>Duplicate keys</strong></p>
<p>Often, purpose of sort is to bring items with equal keys together.</p>
<ul>
<li>Sort population by age.</li>
<li>Remove duplicates from mailing list.</li>
<li>Sort job application by college attended.</li>
</ul>
<p><strong>The Problem</strong></p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.32.19_PM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2020-11-27_at_3.32.19_PM.png"></p>
<h2 id="3-way-Partitioning"><a href="#3-way-Partitioning" class="headerlink" title="3-way Partitioning"></a>3-way Partitioning</h2><p>Goal. Partition array into 3 parts so that:</p>
<ul>
<li>Entries between lt and gt equal to partition item v.</li>
<li>No larger entries to left of lt.</li>
<li>No smaller entries to right of gt.</li>
</ul>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2021-05-12_at_11.22.21_AM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2021-05-12_at_11.22.21_AM.png"></p>
<p><strong>Dutch nation flag problem.[Edsger Dijkstra]</strong></p>
<ul>
<li>Let v be partitioning item a[lo].</li>
<li>Scan i from left to right.<ul>
<li>(a[i] &lt; v): exchange a[lt] with a[i]; increment both lt and i</li>
<li>(a[i] &gt; v): exchange a[gt] with a[i]; decrement gt</li>
<li>(a[i] == v): increment i</li>
</ul>
</li>
</ul>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.35.34_PM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2020-11-27_at_3.35.34_PM.png"></p>
<p><strong>Trace.</strong></p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.37.51_PM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2020-11-27_at_3.37.51_PM.png"></p>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_4.40.58_PM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2020-11-27_at_4.40.58_PM.png"></p>
<p><strong>3-way Quicksort: Java implementation.</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(Comparable[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(hi &lt; lo) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> lt = lo, gt = hi;</span><br><span class="line">    Comparable v = a[lo];</span><br><span class="line">    <span class="keyword">int</span> i = lo;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= gt)&#123;</span><br><span class="line">        <span class="keyword">int</span> cmp = a[i].compareTo(v);</span><br><span class="line">        <span class="keyword">if</span>(cmp &lt; <span class="number">0</span>) exch(a, lt++, i++);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmp &gt; <span class="number">0</span>) exch(a, i, gt--);</span><br><span class="line">        <span class="keyword">else</span> i++;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(a, lo, lt - <span class="number">1</span>);</span><br><span class="line">    sort(a, gt + <span class="number">1</span>, hi);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2021/05/13/quicksort/Screen_Shot_2020-11-27_at_3.40.58_PM.png" alt="%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%20/Screen_Shot_2020-11-27_at_3.40.58_PM.png"></p>
<p>References：</p>
<p><a target="_blank" rel="noopener" href="https://algs4.cs.princeton.edu/23quicksort/">Algs4 2.3</a></p>
<p>CLRS</p>

    </div>

    
    
    
      
  <div class="popular-posts-header">Related Posts</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/11/15/Algorithms-StacksandQueues/" rel="bookmark">Algorithms，Part I：Stacks and Queues</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2021/04/15/B-tree/" rel="bookmark">B-tree</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/10/07/MergeSort/" rel="bookmark">MergeSort</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/11/16/Programming Assignment Deques and Randomized Queues/" rel="bookmark">Programming Assignment:Deques and Randomized Queues</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/10/17/插入排序/" rel="bookmark">Insertion</a></div>
    </li>
  </ul>


    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Algorithms/" rel="tag"># Algorithms</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2021/05/07/Heapsort/" rel="next" title="HeapSort">
                  HeapSort <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-alien"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AlenZhang</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Symbols count total">236k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">3:34</span>
  </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollRestoration: false,
  scrollTo: !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  






  



    <div class="pjax">

  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



    </div>
</body>
</html>
