<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"superming.life","root":"/","images":"/images","scheme":"Mist","version":"8.2.1","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta name="description" content="SSH-01SSH means Secure Shell. Definition: SSH uses public-key cryptography to authenticate the remote computer and allow it to authenticate the user, if necessary. There are several ways to use SSH; o">
<meta property="og:type" content="article">
<meta property="og:title" content="SSH-01">
<meta property="og:url" content="https://superming.life/2021/09/21/SSH01/index.html">
<meta property="og:site_name" content="AlenZhang&#39;s Blog">
<meta property="og:description" content="SSH-01SSH means Secure Shell. Definition: SSH uses public-key cryptography to authenticate the remote computer and allow it to authenticate the user, if necessary. There are several ways to use SSH; o">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://superming.life/2021/09/21/SSH01/Untitled.png">
<meta property="article:published_time" content="2021-09-21T15:31:35.000Z">
<meta property="article:modified_time" content="2021-09-22T15:16:04.444Z">
<meta property="article:author" content="AlenZhang">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://superming.life/2021/09/21/SSH01/Untitled.png">


<link rel="canonical" href="https://superming.life/2021/09/21/SSH01/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>
<title>SSH-01 | AlenZhang's Blog</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="/custom_css_source.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="AlenZhang's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">AlenZhang's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SSH-01"><span class="nav-number">1.</span> <span class="nav-text">SSH-01</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="nav-number">1.0.1.</span> <span class="nav-text">基本使用：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F"><span class="nav-number">1.0.2.</span> <span class="nav-text">加密方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%EF%BC%9A%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%EF%BC%88Man-in-the-middle-attack"><span class="nav-number">1.0.3.</span> <span class="nav-text">安全问题：中间人攻击（Man-in-the-middle attack)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SSH%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E4%BB%A5%E4%B8%8A%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="nav-number">1.0.4.</span> <span class="nav-text">SSH如何解决以上安全问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%AB%E5%90%8D%E4%BD%BF%E7%94%A8"><span class="nav-number">1.0.5.</span> <span class="nav-text">别名使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93"><span class="nav-number">1.0.6.</span> <span class="nav-text">文件传输</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">1.1.</span> <span class="nav-text">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
# 把本地的 &#x2F;path&#x2F;to&#x2F;local&#x2F;file 文件传输到远程的 &#x2F;path&#x2F;to&#x2F;remote&#x2F;file
scp -P port &#x2F;path&#x2F;to&#x2F;local&#x2F;file user@remote:&#x2F;path&#x2F;to&#x2F;remote&#x2F;file

# 也可以使用别名
scp &#x2F;path&#x2F;to&#x2F;local&#x2F;file lab:&#x2F;path&#x2F;to&#x2F;remote&#x2F;file

# 把远程的 &#x2F;path&#x2F;to&#x2F;remote&#x2F;file 下载到本地的 &#x2F;path&#x2F;to&#x2F;local&#x2F;file
scp lab:&#x2F;path&#x2F;to&#x2F;remote&#x2F;file &#x2F;path&#x2F;to&#x2F;local&#x2F;file

# 远程的默认路径是家目录
# 下面命令把当前目录下的 file 传到远程的 ~&#x2F;dir&#x2F;file
scp file lab:dir&#x2F;file

# 加上 -r 命令可以传送文件夹
# 下面命令可以把当前目录下的 dir 文件夹传到远程的家目录下
scp -r dir lab:

# 别忘了 . 可以用来指代当前目录
# 下面命令可以把远程的 ~&#x2F;dir 目录下载到当前目录里面
scp -r lab:dir&#x2F; .
</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="AlenZhang"
      src="/images/ninja8.jpg">
  <p class="site-author-name" itemprop="name">AlenZhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:supermingzero@gmail.com" title="E-Mail → mailto:supermingzero@gmail.com" rel="noopener" target="_blank"><i class="far fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/AlenZhang-Dev" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AlenZhang-Dev" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.instagram.com/alen_zhang_bubble/" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;alen_zhang_bubble&#x2F;" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/t.me/AlenZhang" title="Telegram → t.me&#x2F;AlenZhang"><i class="fab fa-telegram fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/alen-zhang-5b82ba1a5/" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;alen-zhang-5b82ba1a5&#x2F;" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2021/09/21/SSH01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja8.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SSH-01
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-09-21 23:31:35" itemprop="dateCreated datePublished" datetime="2021-09-21T23:31:35+08:00">2021-09-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>5.4k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>5 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="SSH-01"><a href="#SSH-01" class="headerlink" title="SSH-01"></a>SSH-01</h1><p>SSH means Secure Shell.</p>
<p>Definition: SSH uses public-key cryptography to authenticate the remote computer and allow it to authenticate the user, if necessary.</p>
<p>There are several ways to use SSH; one is to use automatically generated public-private key pairs to simply encrypt a network connection, and then use password authentication to log on. Another is to use manually generated public-private key pair to perform the authentication, allow user or programs to log in without having to specify a password. In this scenario, anyone can produce a matching pair of different keys(public and private). The public key is placed on all computer that must allow access to the owner of the matching private key.(the owner keeps the private key secret). While authentication is based on private key, the key itself is never transferred through the network during authentication. So SSH only verifies whether the same person offering the public key also owns the matching private key.</p>
<p>SSH是一种加密通讯的协议，用于互联网上的一些敏感信息的传输，主要用于计算机之间的加密登陆。</p>
<a id="more"></a> 
<h3 id="基本使用："><a href="#基本使用：" class="headerlink" title="基本使用："></a>基本使用：</h3><p>SSH是Linux系统上很常见的工具。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh user@remote -p port</span><br></pre></td></tr></table></figure>
<ul>
<li>user 为远程机器上的用户名</li>
<li>remote是远程机器的地址，可以是IP、域名或是别名</li>
<li>port是SSH Server监听的端口，默认22</li>
</ul>
<p>使用以上三个参数使用任意的SSH Client都可以连上SSH Server。</p>
<p><strong>OpenSSH Server</strong></p>
<p>如果远程机器没有安装SSH Server，Client即使知道远程机器的ip地址，也是无法脸上该机器的。强行使用ssh进行连接，会产生如下报错：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">client$ ssh user@remote -p port</span><br><span class="line">ssh: connect to host remote port 22: Connection refused</span><br></pre></td></tr></table></figure>
<p>需要使用如下命令进行安装，不同的Linux系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssh-server</span><br></pre></td></tr></table></figure>
<p>前提是使用ssh-keygen -t RSA 生成公私钥对。</p>
<p><code>ssh-copy-id -i ~/.ssh/id_rsa.pub user@host</code>将公钥分发给远程主机。</p>
<p>通过<code>ssh-copy-id -i ~/.ssh/id_rsa.pub user@host</code>命令分发的公钥都会被保存至远程主机的<code>/.ssh/authorized_keys</code>文件中。</p>
<h3 id="加密方式"><a href="#加密方式" class="headerlink" title="加密方式"></a><strong>加密方式</strong></h3><p>一般来说加密方式分为两种，对称加密和非对称加密。</p>
<ol>
<li>对称加密（密钥加密）：加密解密使用同一套密钥。</li>
<li>非对称加密（公钥加密）</li>
</ol>
<p>对称加密很难破解，但是只要获取密钥就能够破解。在一个系统中，只要一个Client端的密钥泄漏，足以摧毁整个系统的安全性。</p>
<p>非对称加密就是解决以上这个问题。非对称加密有使用两组密钥，公钥和私钥。</p>
<p>公钥可以保存在数量庞大的Clients中，将发送的数据通过公钥进行加密，但是该数据只能通过私钥进行解密。因此即使公钥泄漏，只要对方没有获取到私钥，很难对数据进行解密。因此保证了整个系统的安全性没，这就是非对称加密的特点。SSH采用的是非对称加密。</p>
<h3 id="安全问题：中间人攻击（Man-in-the-middle-attack"><a href="#安全问题：中间人攻击（Man-in-the-middle-attack" class="headerlink" title="安全问题：中间人攻击（Man-in-the-middle attack)"></a><strong>安全问题：中间人攻击（Man-in-the-middle attack)</strong></h3><p>问题在于Client能否保证接收到的公钥发自Server？</p>
<p>如果Attacker拦截了Client向服务器的请求，Attacker冒充远程服务器向Client发送自己的公钥，Client端用使用Attacker提供的公钥对数据进行加密，然后发送回Attacker冒充的服务器，Attacker再用自己的私钥进行解密，即可窃取Client的登陆信息。即中间人攻击。</p>
<p>SSH协议的公钥不像https有类似CA进行公证的，即用户自己签发，因此很难对其进行辨别。</p>
<p>没有绝对安全的系统。</p>
<h3 id="SSH如何解决以上安全问题"><a href="#SSH如何解决以上安全问题" class="headerlink" title="SSH如何解决以上安全问题"></a><strong>SSH如何解决以上安全问题</strong></h3><ol>
<li><strong>基于口令的认证</strong></li>
</ol>
<p>中间人攻击最大的问题就在于<em>如何对Server的公钥进行鉴别。</em></p>
<p>SSH通常在第一次登陆的时候，会现实主机的公钥指纹，需要自己决定是否与主机进行连接。</p>
<p>输入yes之后，表示host得到client的信任，被追加到文件known_host中，然后输入密码继续即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Clinet$ ssh user@host</span><br><span class="line"></span><br><span class="line">　　The authenticity of host <span class="string">&#x27;host (12.18.429.21)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">　　RSA key fingerprint is 98:2e:d7:e0:de:9f:ac:67:28:c2:42:2d:37:16:58:4d.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">　　Are you sure you want to continue connecting (yes/no)?</span></span><br></pre></td></tr></table></figure>
<p>上面的意思是，无法确认主机12.18.429.21的真实性，但是公钥知道其公钥指纹，是否继续连接。使用指纹（fingerprint）代替key的主要原因是为了方便，RSA算法得出的公钥有1024位，很难对其进行比较，对公钥生成128位的指纹，大大减少比较的成本。</p>
<p>当输入yes后，会有以下信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Warning: Permanently added <span class="string">&#x27;ssh-server.example.com,12.18.429.21&#x27;</span> (RSA) to the list of known hosts. </span><br><span class="line">Password: (enter password)</span><br></pre></td></tr></table></figure>
<p>输入正确密码后即可远程登陆Server。</p>
<p>可以看到系统的提示 <code>Permanently added &#39;ssh-server.example.com,12.18.429.21&#39; (RSA) to the list of known hosts.</code> 即远程Server的公钥被接收后，会保存在<code>.ssh/known_hosts</code>文件中，（known_hosts保存用户信任的远程主机）下次连接该Server时，会跳过警告的部分，直接提示密码输入。</p>
<ol>
<li><strong>基于公钥进行认证</strong></li>
</ol>
<p>口令登陆的方式，每次远程登陆都需要输入密码。SSH提供了一种使用公钥进行认证的方式，可以免去复杂的密码输入登陆方式。</p>
<p>公钥认证解释：</p>
<p>Client可以手动将公钥添加到Server端的authorized_keys中，Server接收到Client请求后会在其authorized_keys中匹配到Client的公钥pubKey，生成随机数并使用公钥对其进行加密得pubKey(R)，并将其传输给Client。Client则通过私钥进行解密得到随机数R，然后对随机数R和本次会话的SessionKey使用MD5生成Digest1，发送给Server端。Server端对R和SessionKey使用相同的算法生成Digest2，最后比较两者是否一致，完成认证。</p>
<p>【Github配置的时候就需要是将自己的公钥放到Server上的过程。】</p>
<p><img src="/2021/09/21/SSH01/Untitled.png" alt="Untitled"></p>
<p><strong>使用示例I：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -P <span class="string">&#x27;&#x27;</span> -f ~/.ssh/id_rsa</span><br><span class="line">$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">$ chmod 0600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>
<p>ssh-keygen用于生产密钥的工具。<code>-t</code> 表示指定生成密钥类型（rsa、dsa、ecdsa等）<code>-P</code>表示指定passphrase，用于确保私钥的安全。<code>-f</code>表示指定存放密钥的文件（公钥文件默认和私钥同目录下，不同的是，存放公钥的文件名需要加上后缀.pub。</p>
<p><strong>使用示例II：</strong></p>
<p>使用ssh-keygen可以生成公钥，一路回车即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">*client*$ ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/home/user/.ssh/id_rsa):</span><br><span class="line">Created directory <span class="string">&#x27;/home/user/.ssh&#x27;</span>.</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /home/user/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /home/user/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:47VkvSjlFhKRgz/6RYdXM2EULtk9TQ65PDWJjYC5Jys user@<span class="built_in">local</span></span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|       ...o...X+o|</span></span><br><span class="line"><span class="string">|      . o+   B=Oo|</span></span><br><span class="line"><span class="string">|       .....ooo*=|</span></span><br><span class="line"><span class="string">|        o+ooo.+ .|</span></span><br><span class="line"><span class="string">|       .SoXo.  . |</span></span><br><span class="line"><span class="string">|      .E X.+ .   |</span></span><br><span class="line"><span class="string">|       .+.= .    |</span></span><br><span class="line"><span class="string">|        .o       |</span></span><br><span class="line"><span class="string">|                 |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br></pre></td></tr></table></figure>
<p>提示语中表示生成的公钥放在<code>~/.ssh/id_rsa.pub</code> ，私钥放在<code>~/.ssh/id_rsa</code> 。</p>
<p>然后 将公钥发送到Server上，Server即可记住我们的公钥，使用如下命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client$ ssh-copy-id user@remote -p port </span><br></pre></td></tr></table></figure>
<p><code>ssh-copy-id</code>在Mac机器可以使用<code>brew install ssh-copy-id</code>安装。</p>
<p>如果没有<code>ssh-copy-id</code>工具，也可以使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client$ ssh user@remote -p port <span class="string">&#x27;mkdir -p .ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys&#x27;</span> &lt; ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<p>通过在Server端新建.ssh文件，然后将本地的<code>~/.ssh/id_rsa.pub</code>追加到Server的<code>.ssh/authorized_key</code>中。即只要将Client的公钥追加到Server的<code>anthorized_keys</code>中就行。</p>
<p>其中每一台主机都有可能是Client也可能是Server，可以同时拥有authorized_key 和 know_hosts。</p>
<h3 id="别名使用"><a href="#别名使用" class="headerlink" title="别名使用"></a>别名使用</h3><p>每次登陆都需要提供user、remote、port等，配置别名能带来很大的便利，是一个偷懒小妙招。</p>
<p>如果想用别名代替以上输入，在~/.ssh/config中追加以下格式即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Host Name1</span><br><span class="line">    HostName remote</span><br><span class="line">    User user</span><br><span class="line">    Port port</span><br><span class="line">Host Name2 </span><br><span class="line">    HostName remote</span><br><span class="line">    User user</span><br><span class="line">    Port port</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>config文件保存后，即可使用别名登陆，例如<code>ssh Name1</code> 可以登陆按照Name1配置的远程Server，如果进行了公钥的配置，那么还可以省去密码输入的过程，直接登陆。</p>
<h3 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h3><p>两台机器之间传输文件的命令为<code>scp</code>，使用方式与<code>ssh</code>类似，不做过多介绍。</p>
<h2 id><a href="#" class="headerlink" title></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把本地的 /path/to/local/file 文件传输到远程的 /path/to/remote/file</span></span><br><span class="line">scp -P port /path/to/<span class="built_in">local</span>/file user@remote:/path/to/remote/file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以使用别名</span></span><br><span class="line">scp /path/to/<span class="built_in">local</span>/file lab:/path/to/remote/file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把远程的 /path/to/remote/file 下载到本地的 /path/to/local/file</span></span><br><span class="line">scp lab:/path/to/remote/file /path/to/<span class="built_in">local</span>/file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 远程的默认路径是家目录</span></span><br><span class="line"><span class="comment"># 下面命令把当前目录下的 file 传到远程的 ~/dir/file</span></span><br><span class="line">scp file lab:dir/file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加上 -r 命令可以传送文件夹</span></span><br><span class="line"><span class="comment"># 下面命令可以把当前目录下的 dir 文件夹传到远程的家目录下</span></span><br><span class="line">scp -r dir lab:</span><br><span class="line"></span><br><span class="line"><span class="comment"># 别忘了 . 可以用来指代当前目录</span></span><br><span class="line"><span class="comment"># 下面命令可以把远程的 ~/dir 目录下载到当前目录里面</span></span><br><span class="line">scp -r lab:dir/ .</span><br></pre></td></tr></table></figure></h2><p>端口转发…next time…</p>
<hr>
<p>References</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Secure_Shell">Secure Shell - Wikipedia</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/33461b619d53">图解SSH原理</a></p>
<p><a target="_blank" rel="noopener" href="https://abcdabcd987.com/ssh/">SSH 基本用法</a></p>
<hr>

    </div>

    
    
    
      


    <footer class="post-footer">
          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://www.linkedin.com/in/alen-zhang-5b82ba1a5/">
          <span class="icon">
            <i class="fab fa-linkedin"></i>
          </span>

          <span class="label">Linkedin</span>
        </a>
      </div>

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://t.me/newsrecord">
          <span class="icon">
            <i class="fab fa-telegram"></i>
          </span>

          <span class="label">Telegram</span>
        </a>
      </div>

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://github.com/AlenZhang-Dev">
          <span class="icon">
            <i class="fab fa-github"></i>
          </span>

          <span class="label">GitHub</span>
        </a>
      </div>

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://www.instagram.com/alen_zhang_bubble/">
          <span class="icon">
            <i class="fab fa-instagram"></i>
          </span>

          <span class="label">Instagram</span>
        </a>
      </div>

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://weibo.com/5982658581/profile?topnav=1&wvr=6">
          <span class="icon">
            <i class="fab fa-weibo"></i>
          </span>

          <span class="label">Weibo</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Linux/" rel="tag"># Linux</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2021/06/28/Weekly-Report-21.6.1/" rel="next" title="Weekly Report - Jun">
                  Weekly Report - Jun <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-alien"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AlenZhang</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Symbols count total">246k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">3:44</span>
  </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollRestoration: false,
  scrollTo: !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  






  



    <div class="pjax">

  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



    </div>
</body>
</html>
