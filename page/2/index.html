<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"superming.life","root":"/","images":"/images","scheme":"Mist","version":"8.2.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta property="og:type" content="website">
<meta property="og:title" content="AlenZhang&#39;s Blog">
<meta property="og:url" content="https://superming.life/page/2/index.html">
<meta property="og:site_name" content="AlenZhang&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="AlenZhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://superming.life/page/2/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>
<title>AlenZhang's Blog</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="AlenZhang's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">AlenZhang's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="AlenZhang"
      src="/images/ninja2.jpg">
  <p class="site-author-name" itemprop="name">AlenZhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">29</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:supermingzero@gmail.com" title="E-Mail → mailto:supermingzero@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/AlenZhang-Dev" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AlenZhang-Dev" rel="noopener" target="_blank"><i class="github fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/10/15/HeapSort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/15/HeapSort/" class="post-title-link" itemprop="url">HeapSort</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-10-15 10:48:56" itemprop="dateCreated datePublished" datetime="2020-10-15T10:48:56+08:00">2020-10-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span id="/2020/10/15/HeapSort/" class="post-meta-item leancloud_visitors" data-flag-title="HeapSort" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>2.1k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="HeapSort「堆排序」"><a href="#HeapSort「堆排序」" class="headerlink" title="HeapSort「堆排序」"></a>HeapSort「堆排序」</h1><h2 id="堆（Heap）"><a href="#堆（Heap）" class="headerlink" title="堆（Heap）"></a>堆（Heap）</h2><p><img src="/2020/10/15/HeapSort/DataStructure.png" alt="Heap Data Structure"></p>
<p>（二叉）堆数据结构是一种数组对象，可以被视为一颗特殊的完全二叉树。</p>
<p>树中每个节点与数组中存放该节点值的那个元素对应。树每一层都是填满的，最后一层除外。</p>
<p>二叉堆有两种：最大堆和最小堆【大根堆和小根堆】。</p>
<!---more --->
<p>大根堆：“给定堆中的任意节点P和C，若P是C的根节点，那么P的值大于等于C的值。” <code>A[Parent(i)] &gt;= A[i]</code>，i 表示除了根节点以外的每个节点。</p>
<p>小根堆：“给定堆中的任意节点P和C，若P是C的根节点，那么P的值小于等于的值。” <code>A[Parent(i)] &lt;= A[i]</code>，i 表示除了根节点以外的每个节点。</p>
<p>大根堆最大元素在根部，小根堆最小元素在根部。</p>
<p>在堆排序中，我们使用大根堆，小根堆主要在构造<strong>优先排列</strong>时使用。</p>
<h2 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h2><p>堆排序是使用堆这种数据结构而设计的一种排序算法，是一种<strong>选择排序</strong>，同时也是一种<strong>不稳定的排序</strong>。</p>
<p>堆排序主要流程：</p>
<ol>
<li>将无序序列构造成一个大根堆，将序列的最大值放到堆顶。【建堆】<ol>
<li>无序序列构造初始堆时，需要从第一个非叶子结点开始，也就是length / 2 - 1出，然后逐步递减。</li>
</ol>
</li>
<li>将堆顶元素与末尾元素进行交换，末尾元素即为最大值。【依次排序】</li>
<li>将剩余的n-1个元素重新排列成堆，堆顶再次得到n-1个元素的最大值。</li>
<li>循环1-3步，直到排成有序数列。</li>
</ol>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeapSort</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] arr = &#123;<span class="number">11</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>&#125;;</span><br><span class="line">        heap_sort(arr);</span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">heap_sort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//Build heap</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = arr.length / <span class="number">2</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            max_heapify(arr, i, arr.length);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Sort Process, extract an element one by one.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = arr.length - <span class="number">1</span>; j &gt; <span class="number">0</span>; j--) &#123;</span><br><span class="line">            <span class="comment">//Move current root to end.</span></span><br><span class="line">            swap(arr, <span class="number">0</span>, j);</span><br><span class="line">            <span class="comment">//Rebuild the heap.</span></span><br><span class="line">            max_heapify(arr, <span class="number">0</span>, j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//adjust the heap, the core function of HeapSort;</span></span><br><span class="line">    <span class="comment">//To heapify a subtree from start to end.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">max_heapify</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//keep the current swap element.</span></span><br><span class="line">        <span class="keyword">int</span> temp = arr[start];</span><br><span class="line">        <span class="comment">//compare the child, from left to right</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = start * <span class="number">2</span> + <span class="number">1</span>; i &lt; end; i = i * <span class="number">2</span> + <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">//select the larger one between right child and left child</span></span><br><span class="line">            <span class="keyword">if</span> (i + <span class="number">1</span> &lt; end &amp;&amp; arr[i] &lt; arr[i + <span class="number">1</span>]) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//swap the root node with larger one.</span></span><br><span class="line">            <span class="keyword">if</span> (arr[i] &gt; temp) &#123;</span><br><span class="line">                arr[start] = arr[i];</span><br><span class="line">                start = i;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        arr[start] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//swap the element</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> temp = arr[a];</span><br><span class="line">        arr[a] = arr[b];</span><br><span class="line">        arr[b] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>堆排序是一种选择排序，主要过程为创建初始堆，交换堆顶元素和末尾元素，重建堆等步骤组成。构建初始堆复杂度为O(n)。需要n - 1次交换，重建过程参考完全二叉树的性质，近似于nlogn，因此堆排序时间复杂度默认O(nlogn)。</p>
<blockquote>
<p>Time complexity of heapify is O(Logn). Time complexity of createAndBuildHeap() is O(n) and overall time complexity of Heap Sort is O(nLogn).</p>
</blockquote>
<p>堆排序的使用相对较少，因为快速排序和合并排序两者在实际生活使用中更有效率。</p>
<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p>最小k个数</p>
<p>对几乎排序的数组进行排序</p>
<p>…</p>
<hr>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/heap-sort/?ref=lbp">GeeksforGeeks HeapSort</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/chengxiao/p/6129630.html">图解排序算法之堆排序</a></p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%A0%86%E6%8E%92%E5%BA%8F#C%E8%AF%AD%E8%A8%80">wiki</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/10/07/MergeSort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/07/MergeSort/" class="post-title-link" itemprop="url">MergeSort</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-10-07 21:00:35" itemprop="dateCreated datePublished" datetime="2020-10-07T21:00:35+08:00">2020-10-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span id="/2020/10/07/MergeSort/" class="post-meta-item leancloud_visitors" data-flag-title="MergeSort" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>2.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>3 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="MergeSort"><a href="#MergeSort" class="headerlink" title="MergeSort"></a>MergeSort</h1><h2 id="Introductions"><a href="#Introductions" class="headerlink" title="Introductions"></a>Introductions</h2><p>很多算法在结构上是递归的，为了解决给定问题，需要一次或多次调用自身来解决相关子问题，通常使用<strong>分治策略（Divide-and-Conquer）</strong>，即将问题分解为n个规模较小而结构与原问题类似的子问题；递归解决这些问题，然后合并其结果，即得到问题的解。</p>
<!--- more --->
<p>分治模式在每一层的递归上一般有三个步骤：</p>
<p>分解（Divide）：将原问题分解为一系列的子问题。</p>
<p>解决（Conquer）：递归解决各子问题，若子问题足够小，则直接求解。</p>
<p>合并（combine）：将子问题的结果合并为原问题的解。</p>
<p>归并排序（MergeSort）算法是分治策略的一个完美实现。</p>
<p>分解：将n个元素分成各含n/2个元素的子序列。</p>
<p>解决：用合并排序法对两个子序列递归地排序。</p>
<p>合并：合并两个已排序的子序列以得到排序结果。</p>
<p>关键在于合并步骤中两个已经排列的子序列。</p>
<p><img src="/2020/10/07/MergeSort/Merge-Sort-Tutorial.png" alt></p>
<p>merge核心代码及流程：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> l, <span class="keyword">int</span> m, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// Your code here</span></span><br><span class="line"><span class="keyword">int</span> temp[] = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</span><br><span class="line"><span class="keyword">int</span> i = l;</span><br><span class="line"><span class="keyword">int</span> j = m + <span class="number">1</span>;<span class="comment">//right point</span></span><br><span class="line"><span class="keyword">int</span> index = <span class="number">0</span>;<span class="comment">//point of temp;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span>(i &lt;= m &amp;&amp; j &lt;= r)&#123;</span><br><span class="line">    <span class="keyword">if</span>(arr[i] &lt; arr[j])&#123;</span><br><span class="line">        temp[index++] = arr[i++];   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        temp[index++] = arr[j++];</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">while</span>(i &lt;= m)&#123;</span><br><span class="line">    temp[index++] = arr[i++];</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">while</span>(j &lt;= r)&#123;</span><br><span class="line">    temp[index++] = arr[j++];</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">for</span>(index = <span class="number">0</span>; index &lt;= r; index++)&#123;</span><br><span class="line">    arr[index] = arr[index];</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>完整代码参考：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Java program for Merge Sort */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MergeSort</span> </span>&#123; </span><br><span class="line">  <span class="comment">// Merges two subarrays of arr[]. </span></span><br><span class="line">  <span class="comment">// First subarray is arr[l..m] </span></span><br><span class="line">  <span class="comment">// Second subarray is arr[m+1..r] </span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> l, <span class="keyword">int</span> m, <span class="keyword">int</span> r)</span> </span></span><br><span class="line"><span class="function">	</span>&#123; </span><br><span class="line">    <span class="comment">// Find sizes of two subarrays to be merged </span></span><br><span class="line">    <span class="keyword">int</span> n1 = m - l + <span class="number">1</span>; </span><br><span class="line">    <span class="keyword">int</span> n2 = r - m; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Create temp arrays */</span></span><br><span class="line">    <span class="keyword">int</span> L[] = <span class="keyword">new</span> <span class="keyword">int</span>[n1]; </span><br><span class="line">    <span class="keyword">int</span> R[] = <span class="keyword">new</span> <span class="keyword">int</span>[n2]; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Copy data to temp arrays*/</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n1; ++i) </span><br><span class="line">      L[i] = arr[l + i]; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n2; ++j) </span><br><span class="line">      R[j] = arr[m + <span class="number">1</span> + j]; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Merge the temp arrays */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initial indexes of first and second subarrays </span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initial index of merged subarry array </span></span><br><span class="line">    <span class="keyword">int</span> k = l; </span><br><span class="line">    <span class="keyword">while</span> (i &lt; n1 &amp;&amp; j &lt; n2) &#123; </span><br><span class="line">      <span class="keyword">if</span> (L[i] &lt;= R[j]) &#123; </span><br><span class="line">        arr[k] = L[i]; </span><br><span class="line">        i++; </span><br><span class="line">      &#125; </span><br><span class="line">      <span class="keyword">else</span> &#123; </span><br><span class="line">        arr[k] = R[j]; </span><br><span class="line">        j++; </span><br><span class="line">      &#125; </span><br><span class="line">      k++; </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Copy remaining elements of L[] if any */</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt; n1) &#123; </span><br><span class="line">      arr[k] = L[i]; </span><br><span class="line">      i++; </span><br><span class="line">      k++; </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Copy remaining elements of R[] if any */</span></span><br><span class="line">    <span class="keyword">while</span> (j &lt; n2) &#123; </span><br><span class="line">      arr[k] = R[j]; </span><br><span class="line">      j++; </span><br><span class="line">      k++; </span><br><span class="line">    &#125; </span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  <span class="comment">// Main function that sorts arr[l..r] using </span></span><br><span class="line">  <span class="comment">// merge() </span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span></span><br><span class="line"><span class="function">	</span>&#123; </span><br><span class="line">    <span class="keyword">if</span> (l &lt; r) &#123; </span><br><span class="line">      <span class="comment">// Find the middle point </span></span><br><span class="line">      <span class="keyword">int</span> m = (l + r) / <span class="number">2</span>; </span><br><span class="line"></span><br><span class="line">      <span class="comment">// Sort first and second halves </span></span><br><span class="line">      sort(arr, l, m); </span><br><span class="line">      sort(arr, m + <span class="number">1</span>, r); </span><br><span class="line"></span><br><span class="line">      <span class="comment">// Merge the sorted halves </span></span><br><span class="line">      merge(arr, l, m, r); </span><br><span class="line">    &#125; </span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  <span class="comment">/* A utility function to print array of size n */</span></span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">int</span> arr[])</span> </span></span><br><span class="line"><span class="function">	</span>&#123; </span><br><span class="line">    <span class="keyword">int</span> n = arr.length; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) </span><br><span class="line">      System.out.print(arr[i] + <span class="string">&quot; &quot;</span>); </span><br><span class="line">    System.out.println(); </span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  <span class="comment">// Driver method </span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span></span><br><span class="line"><span class="function">	</span>&#123; </span><br><span class="line">    <span class="keyword">int</span> arr[] = &#123; <span class="number">12</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span> &#125;; </span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;Given Array&quot;</span>); </span><br><span class="line">    printArray(arr); </span><br><span class="line"></span><br><span class="line">    MergeSort ob = <span class="keyword">new</span> MergeSort(); </span><br><span class="line">    ob.sort(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>); </span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;\nSorted array&quot;</span>); </span><br><span class="line">    printArray(arr); </span><br><span class="line">  &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/* This code is contributed by Rajat Mishra */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>归并排序是一种稳定、高效的排序，一般利用了完全二叉树特性的排序一般不会太差。</p>
<p>每次合并操作的平均时间复杂度为O(n)，而完全二叉树的深度为|log2n|。总的平均时间复杂度为O(nlogn)，归并排序的最好，最坏，平均时间复杂度均为O(nlogn)。</p>
<p>拓展：Java的Array.sort( )采用的TimSort排序算法，就是归并排序的优化版本。【后续填坑】</p>
<h2 id="Application"><a href="#Application" class="headerlink" title="Application"></a>Application</h2><p>【挖坑】</p>
<hr>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/merge-sort/?ref=lbp">Merge Sort</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/chengxiao/p/6194356.html">归并排序</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/10/07/QuickSort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/07/QuickSort/" class="post-title-link" itemprop="url">QuickSort</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-10-07 12:14:41" itemprop="dateCreated datePublished" datetime="2020-10-07T12:14:41+08:00">2020-10-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span id="/2020/10/07/QuickSort/" class="post-meta-item leancloud_visitors" data-flag-title="QuickSort" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>5.6k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>5 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="QuickSort"><a href="#QuickSort" class="headerlink" title="QuickSort"></a>QuickSort</h1><h2 id="概念及简介"><a href="#概念及简介" class="headerlink" title="概念及简介"></a>概念及简介</h2><p>快速排序是经典的排序算法，一般来说，快速排序是排序的最佳选择，得益于其出众的平均性能，同时能够就地排序，在虚拟环境中能够很好的工作。</p>
<p>快速排序主要基于<strong>分治模式（divide - and - conquer）</strong>。首先对数组进行划分【分解】，通过partition函数进行划分，最后将各操作合并即可。</p>
<!--- more --->
<blockquote>
<p>关于分治算法的策略，分(divide)主要把大问题分解为模式类似的小问题，方便进行递归，而治（conquer）则将分阶段的各答案合并在一起，故称分治。</p>
</blockquote>
<h2 id="Partition实现"><a href="#Partition实现" class="headerlink" title="Partition实现"></a>Partition实现</h2><p>Partition函数是QuickSort很重要的组成。<u>首先从给定数组中选择一个pivot值【中枢值】，关于中枢值的选择比较随意，可以为首元素、尾元素、中间元素以及随机元素，一般默认为首或尾元素。</u>Partition函数的主要功能是在数组中选择一个中枢值，把该值放在排序后属于它的位置，所有比它小的数值放在该值的左侧，所有比它大的值放在它的右侧。</p>
<p><img src="/2020/10/07/QuickSort/quicksort.png" alt="quicksort"></p>
<p>Partition函数的<strong>伪代码</strong>实现【Pseudo Code】：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*This fucntion takes last element as pivot.</span></span><br><span class="line"><span class="comment">will place the pivot element at the correct position.</span></span><br><span class="line"><span class="comment">and place all smaller to left of pivot, all greater element to right of pivot.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">partition(arr[], low, high)&#123;</span><br><span class="line">    pivot = arr[high];</span><br><span class="line">    i = low - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = low; j &lt; high - <span class="number">1</span>; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[j] &lt; pivot)&#123;</span><br><span class="line">            i++;</span><br><span class="line">            swap arr[i] and arr[j]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    swap arr[i + <span class="number">1</span>] and arr[high]</span><br><span class="line">    <span class="keyword">return</span> (i + <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*This function takes first element as pivot.</span></span><br><span class="line"><span class="comment">will place the pivot element at the correct position.</span></span><br><span class="line"><span class="comment">and place all smaller to left of pivot, all greater element to right of pivot.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">partition(arr[], low, high)&#123;</span><br><span class="line">    pivot = arr[low];</span><br><span class="line">    i = low;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = low; j &lt;= high; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[j] &lt; pivot)&#123;</span><br><span class="line">            i++;</span><br><span class="line">            swap arr[i] and arr[j]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    swap arr[low] and arr[i]</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>QuickSort伪代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// low -&gt; Starting index, high -&gt; Ending index</span></span><br><span class="line">quickSort(arr[], low, high)&#123;</span><br><span class="line">    <span class="keyword">if</span>(low &lt; high)&#123;</span><br><span class="line">        pi = partition(arr, low, high);</span><br><span class="line">      	<span class="comment">//pi is on his position. Dividing the arr by pi.</span></span><br><span class="line">      	quickSort(arr, low, pi - <span class="number">1</span>);</span><br><span class="line">      	quickSort(arr, pi + <span class="number">1</span>, high);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Java-Implementation"><a href="#Java-Implementation" class="headerlink" title="Java Implementation"></a>Java Implementation</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span></span>&#123;</span><br><span class="line">  	<span class="function"><span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">      	<span class="keyword">int</span> temp = <span class="number">0</span>;</span><br><span class="line">      	<span class="keyword">int</span> pivot = arr[high];</span><br><span class="line">      	<span class="keyword">int</span> i = low - <span class="number">1</span>;</span><br><span class="line">      	<span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; high - <span class="number">1</span>; j++)&#123;</span><br><span class="line">          	<span class="keyword">if</span>(arr[j] &lt; pivot)&#123;</span><br><span class="line">              	i++;</span><br><span class="line">          			<span class="comment">//swap</span></span><br><span class="line">          			temp = arr[j];</span><br><span class="line">          			arr[j] = arr[i];</span><br><span class="line">          			arr[i] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//swap last time </span></span><br><span class="line">      	temp = arr[i++];</span><br><span class="line">      	arr[i] = arr[high];</span><br><span class="line">      	arr[high] = temp;</span><br><span class="line">      </span><br><span class="line">      	<span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  	<span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">      	<span class="keyword">if</span>(low &lt; high)&#123;</span><br><span class="line">          	<span class="keyword">int</span> pi = partition(arr, low, high);</span><br><span class="line">          	</span><br><span class="line">          	sort(arr, low, pi - <span class="number">1</span>);</span><br><span class="line">          	sort(arr, pi + <span class="number">1</span>, high);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  	</span><br><span class="line">  	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">int</span> arr[])</span></span>&#123;</span><br><span class="line">      	<span class="keyword">int</span> n = arr.length;</span><br><span class="line">      	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">          	System.out.print(arr[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        System.out.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span> <span class="params">(String args[])</span></span>&#123;</span><br><span class="line">      	<span class="keyword">int</span> arr = &#123;&#125;;<span class="comment">//test example;</span></span><br><span class="line">      	<span class="keyword">int</span> n = arr.length;</span><br><span class="line">      	</span><br><span class="line">      	QuickSort ob = <span class="keyword">new</span> QuickSort();</span><br><span class="line">      	ob.sort(arr, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">      </span><br><span class="line">      	System.out.println(<span class="string">&quot;sorted array&quot;</span>);</span><br><span class="line">      	printArray(arr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="C-Implementation"><a href="#C-Implementation" class="headerlink" title="C++ Implementation"></a>C++ Implementation</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* C++ implementation of QuickSort */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// A utility function to swap two elements </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>* a, <span class="keyword">int</span>* b)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">  <span class="keyword">int</span> t = *a; </span><br><span class="line">  *a = *b; </span><br><span class="line">  *b = t; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/* This function takes last element as pivot, places </span></span><br><span class="line"><span class="comment">the pivot element at its correct position in sorted </span></span><br><span class="line"><span class="comment">array, and places all smaller (smaller than pivot) </span></span><br><span class="line"><span class="comment">to left of pivot and all greater elements to right </span></span><br><span class="line"><span class="comment">of pivot */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">partition</span> <span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">  <span class="keyword">int</span> pivot = arr[high]; <span class="comment">// pivot </span></span><br><span class="line">  <span class="keyword">int</span> i = (low - <span class="number">1</span>); <span class="comment">// Index of smaller element </span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = low; j &lt;= high - <span class="number">1</span>; j++) </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="comment">// If current element is smaller than the pivot </span></span><br><span class="line">    <span class="keyword">if</span> (arr[j] &lt; pivot) </span><br><span class="line">    &#123; </span><br><span class="line">      i++; <span class="comment">// increment index of smaller element </span></span><br><span class="line">      swap(&amp;arr[i], &amp;arr[j]); </span><br><span class="line">    &#125; </span><br><span class="line">  &#125; </span><br><span class="line">  swap(&amp;arr[i + <span class="number">1</span>], &amp;arr[high]); </span><br><span class="line">  <span class="keyword">return</span> (i + <span class="number">1</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/* The main function that implements QuickSort </span></span><br><span class="line"><span class="comment">arr[] --&gt; Array to be sorted, </span></span><br><span class="line"><span class="comment">low --&gt; Starting index, </span></span><br><span class="line"><span class="comment">high --&gt; Ending index */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">  <span class="keyword">if</span> (low &lt; high) </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="comment">/* pi is partitioning index, arr[p] is now </span></span><br><span class="line"><span class="comment">		at right place */</span></span><br><span class="line">    <span class="keyword">int</span> pi = partition(arr, low, high); </span><br><span class="line"></span><br><span class="line">    <span class="comment">// Separately sort elements before </span></span><br><span class="line">    <span class="comment">// partition and after partition </span></span><br><span class="line">    quickSort(arr, low, pi - <span class="number">1</span>); </span><br><span class="line">    quickSort(arr, pi + <span class="number">1</span>, high); </span><br><span class="line">  &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/* Function to print an array */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> size)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">  <span class="keyword">int</span> i; </span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; size; i++) </span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>; </span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// Driver Code </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">  <span class="keyword">int</span> arr[] = &#123;<span class="number">10</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">5</span>&#125;; </span><br><span class="line">  <span class="keyword">int</span> n = <span class="keyword">sizeof</span>(arr) / <span class="keyword">sizeof</span>(arr[<span class="number">0</span>]); </span><br><span class="line">  quickSort(arr, <span class="number">0</span>, n - <span class="number">1</span>); </span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sorted array: \n&quot;</span>; </span><br><span class="line">  printArray(arr, n); </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// This code is contributed by rathbhupendra </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="QuickSort性能分析（Analysis-of-QuickSort）"><a href="#QuickSort性能分析（Analysis-of-QuickSort）" class="headerlink" title="QuickSort性能分析（Analysis of QuickSort）"></a>QuickSort性能分析（Analysis of QuickSort）</h2><p>快速排序的性能可以通过如下公式进行表示： <strong>T(n) = T(k) + T(n-k-1) + $\theta$(n)</strong></p>
<p>前两个属于用于两个递归调用，最后一个术语为分区过程。k表示小于pivot的元素个数，快速排序的时间花费主要取决于输入数组以及分区策略。【最坏情况、最优情况、平均情况】</p>
<p><strong>最坏情况（Worst Case）</strong></p>
<p>当每次分区都选择了最大或者最小的值作为pivot值。</p>
<p> <strong>T(n) = T(n-1) + $\theta$ (n)</strong></p>
<p>上述快排运行时间为$\theta$(n<sup>2</sup>)。</p>
<p><strong>最佳情况（Best Case）</strong></p>
<p>每次分区都选择中间元素作为pivot值。</p>
<p> <strong>T(n) = 2T(n / 2) + $\theta$ (n)</strong></p>
<p><strong>平均情况（Average Case）</strong></p>
<p>根据复杂的运行时间分析【后续补充】，得到该算法的平均运行效率公式为：</p>
<p> <strong>T(n) = T(n / 9) + T(9n / 10) + $\theta$ (n)</strong></p>
<p>上述快排的运行时间为$\theta$(nLogn)。</p>
<p>根据以上分析，QuickSort算法在最坏情况下的运行效率不及多数的排序算法，比如归并排序(Merge Sort)、堆排序(Heap Sort)。但在实际使用中，QuickSort排序算法表现很快，主要因为算法内部的循环排序可以很高效的适用于现实生活中多数的数组结构。因为pivot值可以随机更换，故最坏的情况很少在现实生活中发生，快排基本被认为相同数量级中所有排序算法中平均性能最优秀的。但与归并排序相比，归并排序更适用于数据量大且存储在外部的数据存储模式。</p>
<p>快速排序是一个不稳定的算法，在排序后相同值的元素相对位置会发生改变。</p>
<h2 id="三分法-快速排序（3-Way-QuickSort）"><a href="#三分法-快速排序（3-Way-QuickSort）" class="headerlink" title="三分法-快速排序（3-Way-QuickSort）"></a>三分法-快速排序（3-Way-QuickSort）</h2><p>3-Way-QuickSort也叫<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Dutch_national_flag_problem">Dutch national flag problem</a>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Dutch national flag problem (DNF) is a computer science programming problem proposed by Edsger Dijkstra.The flag of the Netherlands consists of three colors: red, white and blue. Given balls of these three colors arranged randomly in a line (the actual number of balls does not matter), the task is to arrange them such that all balls of the same color are together and their collective color groups are in the correct order.</span><br></pre></td></tr></table></figure>
<p>简单的说，即给定红、白、蓝三种颜色的小球若干，将其排成一列，是相同颜色的小球相邻，三种颜色的先后顺序为红白蓝。</p>
<p>将问题进行简单的抽象，即蓝色为pivot值，左边的红色部分小于pivot，右边的白色部分大于pivot，中间部分为pivot，此时用到三分法-快速排序，通过三个指针将数组分为四个部分，通过一次扫描即可完成排序。</p>
<p><img src="/2020/10/07/QuickSort/3-way-quicksort.png" alt="3-way"></p>
<p>核心代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">three_way_partition</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;arr, <span class="keyword">int</span> target)</span></span>&#123;</span><br><span class="line">  	<span class="keyword">int</span> next_less_pos = <span class="number">0</span>;</span><br><span class="line">  	<span class="keyword">int</span> next_scan_pos = <span class="number">0</span>;</span><br><span class="line">  	<span class="keyword">int</span> next_bigger_pos = arr.size() - <span class="number">1</span>;</span><br><span class="line">  </span><br><span class="line">  	<span class="keyword">while</span>(arr[next_scan_pos] &lt;= target)&#123;</span><br><span class="line">      	<span class="keyword">if</span>(arr[next_scan_pos] &lt; target)</span><br><span class="line">          	swap(arr[next_scan_pos++], arr[next_less_pos++]);</span><br><span class="line">     		<span class="keyword">else</span> <span class="keyword">if</span>(arr[next_scan_pos &gt; traget)</span><br><span class="line">            swap(arr[next_scan_pos++], arr[next_bigger_pos--]);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            next_scan_pos++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/quick-sort/">GG:QuickSort</a></p>
<p><a target="_blank" rel="noopener" href="https://selfboot.cn/2016/09/01/lost_partition/">被忽视的partition算法</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Dutch_national_flag_problem">Dutch national flag problem</a></p>
<p><a target="_blank" rel="noopener" href="https://wiki.jikexueyuan.com/project/easy-learn-algorithm/fast-sort.html">快速排序</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/09/20/Tsingtao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/20/Tsingtao/" class="post-title-link" itemprop="url">Tsingtao</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-09-20 20:15:19" itemprop="dateCreated datePublished" datetime="2020-09-20T20:15:19+08:00">2020-09-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Life/" itemprop="url" rel="index"><span itemprop="name">Life</span></a>
        </span>
    </span>

  
    <span id="/2020/09/20/Tsingtao/" class="post-meta-item leancloud_visitors" data-flag-title="Tsingtao" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>2k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Tsingtao"><a href="#Tsingtao" class="headerlink" title="Tsingtao"></a>Tsingtao</h1><p>九月，在青岛，迷人的海滨城市。</p>
<p><img src="/2020/09/20/Tsingtao/tsing.jpeg" alt="view form Tsingtao library"></p>
<h2 id="市井味儿、啤酒"><a href="#市井味儿、啤酒" class="headerlink" title="市井味儿、啤酒"></a>市井味儿、啤酒</h2><p>青岛啤酒无处不在，大铁桶装着的青岛啤酒从未在视线外消失过。粗浅观察了一下，啤酒对于青岛人民来说，像是矿泉水，走道的老大爷走渴了，找个转角的啤酒屋，迫切得要上一大杯，寒暄几句，吨吨喝下，生活继续。【目睹好几次，更多的是装上塑料袋，灌满一大袋回家吨吨】。</p>
<!--- more --->
<p>尤其喜欢市井烟火味重的地方，旅游当然也不例外。网红打卡超级海景，永远体会不到那种闲散慵懒融入这片土地的味道。找一家青岛本地人日常吃饭的小小啤酒屋，有那么些许的杂乱，点上几碗小菜，温度适宜，短袖刚好，与友谈天说地，甚好。诧异的是，每桌默认5扎青岛扎啤，喝不完退。于是，我们成了整个菜馆最怂的一桌，在阵阵海风中和老板娘的诧异的眼神中，脑袋有那么点沉重，看着别人桌少则半打，多的直接上桶，在这座城市中，突然有那么点小小的卑微。</p>
<p>话说回来，青岛本地菜家常菜口味着实不错，很家常，和东北菜类似，量挺大的，一定要留好肚子，某次点了三碗喝了半扎啤酒，差点爬回家。</p>
<p><img src="/2020/09/20/Tsingtao/beer.jpeg" alt="beer" style="zoom:50%;"></p>
<p><img src="/2020/09/20/Tsingtao/seefood.jpeg" alt="beer" style="zoom:50%;"></p>
<p>朋友在东北出生长大，告诉我青岛本地人真的很热情，balabala。对于民风这种东西，对我而言像是种玄学，很难从几个固定的角度去考察判断。在旅行途中，与各种人交流打交道，总会有让你特别温暖的陌生人，也会有一心想敲诈你的陌生人。比较崇尚多元的我，很享受和陌生人这种莫名其妙的接触，哪怕你想敲诈我。【怪不得在哪都被敲诈】至少我回忆起来还觉得挺有趣的，比如这次旅行，有满嘴跑火车的出租车的中年大哥，一个劲教唆我去青岛最繁华的CBD下面迪厅蹦迪，跑着山路吹着风耳边听着他的青岛话“年轻人要balabala”，给我乐坏了；也有沉稳温柔的网约车女司机，我们在痛苦地在车里谈论在当地海鲜市场被宰的经历，把她也乐坏了，一个劲笑… 虽然不是什么动人故事，但旅途中这微不足道甚至很傻x的故事，还是蛮有味道的。</p>
<p>总的来说，碰到的本地青岛人很热情，从网约车司机到餐馆老板…都让人挺温暖的。</p>
<h2 id="乱扯"><a href="#乱扯" class="headerlink" title="乱扯"></a>乱扯</h2><p>对青岛历史充满热情，而青岛比较有故事有味道的点都在市南和市北区，也是本次旅行的主要活动范围。青岛老城区真的太有味道了，尤其是从青岛站到五四广场这片范围附近。路很小很精致，道边的树遮天蔽日，穿行其中真的很惬意，一位本地司机告诉我们，现在这个时候是青岛最美的时候，天气刚刚好，树叶还没落，又黄又绿的，很美。</p>
<p><img src="/2020/09/20/Tsingtao/roads.jpeg" alt="roads"></p>
<p>关于CBD，五四广场和市政府附近，各种商务办公楼、商场及住宅区沿着海岸线扩张，以五四广场为中心，依次排开。青岛CBD的建筑群密集又高耸，而且观赏角度可以很近，更会有别样的感觉，与上海杭州那种隔江相望不同，一街之隔的CBD让手机的超广角力不从心。有被震撼到。</p>
<p><img src="/2020/09/20/Tsingtao/square1.jpeg" alt="square1"></p>
<p>五四广场一群人围着听小哥哥唱歌，有牵着小手或相拥取暖的靓丽情侣，有抽着烟的中年帅大哥… 歌声伴着海风吹进每个人的心里，把大家都黏在了一起。「此情此景，几乎听哭，关键他在唱张学友，还很好听」</p>
<p><img src="/2020/09/20/Tsingtao/square3.jpeg" alt="square3"></p>
<p><img src="/2020/09/20/Tsingtao/suqare.jpeg" alt="suqare"></p>
<p>八大关，嗯，就是那万国建筑群，我也不懂这个风格那个风格，在欧洲老式建筑间穿行，这些屋子几乎都被一些高级餐厅啥的占领了，在门口看着文物保护的牌子，肤浅的惊呼：哦～原来这以前是捷克大使馆，哇～原来这是西班牙大使馆，卧槽，那是英国的… 肤浅的在全是上下坡的山路走着，自觉俗不可耐。景色不错，坐拥第一第二第三海水浴场，媲美大连滨海路？</p>
<p>中山路、栈桥、圣弥厄尔大教堂…散漫又美丽，也是我在青岛最爱逛的地方。</p>
<p><img src="/2020/09/20/Tsingtao/church.jpeg" alt="church"></p>
<h2 id="Coffee"><a href="#Coffee" class="headerlink" title="Coffee"></a>Coffee</h2><p>青岛咖啡店很多很杂，只要你有精力，当然还要有钱，总会找到你喜欢的。</p>
<p><strong>TinyCafe 晓晓咖啡</strong></p>
<p>关键词：无敌海景、专注意式</p>
<p>刚搬迁，坐落在小港码头，选址无敌，是一家无敌有趣的夫妻店。少数派的黄色潜水艇的SOE，令人惊艳的蓝莓水果味儿。小夫妻超级有趣，店内装饰都是小夫妻和咖啡之间甜甜的故事，咖啡的价格非常亲民，很难得。</p>
<p><img src="/2020/09/20/Tsingtao/tiny.jpeg" alt="beer"></p>
<p><img src="/2020/09/20/Tsingtao/tiny4.jpeg" alt="beer"></p>
<p><strong>十角馆</strong></p>
<p>关键字：个性、安静、复古、日式</p>
<p>老板是个异常有个性的人，说话声音很轻，给人很稳重味道，很像我以前的一个朋友，心里藏着无数个故事，内敛而又深刻，我好喜欢这样的人。</p>
<p>如果你不和他去交流，他真不会和你多说一句话；你慢慢和他交流到那个恰好的点，就开始慢慢展现他自己了，给我们介绍他淘的各种古董、杯子、机车模型，还会特定翻出杂志和书本来给我们看，好享受这种感觉啊。</p>
<p>朋友说想喝日式豆子，他掏出几款让我们挑，相中了一块日本直接进口过来的，他最后一点了，有点小小对不起他的感觉。</p>
<p><img src="/2020/09/20/Tsingtao/10angle.jpeg" alt="beer"></p>
<p><img src="/2020/09/20/Tsingtao/2.jpeg" alt="beer"></p>
<p><strong>77咖啡</strong></p>
<p>关键字：教堂、深烘</p>
<p>老板喜欢咖啡的那种焦苦味，一杯深烘的埃塞，有种不悦的香料味，不是我喜欢的感觉吧。怎么说呢，咖啡毕竟是很主观的东西，更多的是一种表达和态度，喜不喜欢便是你和店家之间的缘分啦。其实很喜欢这个带着京腔的爷爷，气质上就能把你征服。</p>
<p>他的狗狗叫拿铁，被可爱到了。我喜欢这个爷爷。</p>
<p><img src="/2020/09/20/Tsingtao/IMG_0360.jpeg" alt="IMG_0360"></p>
<p><strong>许国明咖啡</strong></p>
<p>那自己名字做咖啡店的名字，就能感受到那种气场了。整个旅途中最值得、最有价值的一次交流。对于咖啡行业的深刻洞见，眼神中无法掩盖的那种热爱，对我们问题的耐心讲解..收益匪浅，超近距离感受到了这种真正的热爱、态度和气质。</p>
<p>蹭了好多杯各种精品产地豆，质量真没得说。</p>
<p><img src="/2020/09/20/Tsingtao/xu1.jpeg" alt></p>
<p><img src="/2020/09/20/Tsingtao/xu5.jpeg" alt></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/07/16/%E4%B8%96%E7%95%8C%E5%92%96%E5%95%A1%E5%9C%B0%E5%9B%BE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/16/%E4%B8%96%E7%95%8C%E5%92%96%E5%95%A1%E5%9C%B0%E5%9B%BE/" class="post-title-link" itemprop="url">世界咖啡地图</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-07-16 18:15:19" itemprop="dateCreated datePublished" datetime="2020-07-16T18:15:19+08:00">2020-07-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Books/" itemprop="url" rel="index"><span itemprop="name">Books</span></a>
        </span>
    </span>

  
    <span id="/2020/07/16/%E4%B8%96%E7%95%8C%E5%92%96%E5%95%A1%E5%9C%B0%E5%9B%BE/" class="post-meta-item leancloud_visitors" data-flag-title="世界咖啡地图" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>8.5k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>8 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="《世界咖啡地图-第二版》"><a href="#《世界咖啡地图-第二版》" class="headerlink" title="《世界咖啡地图 第二版》"></a>《世界咖啡地图 第二版》</h1><p>前言：<strong>这是属于咖啡的时代，喝咖啡不仅是种享受，而且充满乐趣。</strong></p>
<p>《世界咖啡地图》是一本适用人群非常广的咖啡指南工具书，从小白到咖啡爱好者或是专业咖啡师，销量和很好的口碑说明了一切。是初学者眼中完美的咖啡入门指南，而对于专业选手，则是一本咖啡行业及领域的实用参考书，各种一手信息，图表对比，原产地资料等。</p>
<p>作者是著名的咖啡师詹姆斯 霍夫曼，2007年WBC「世界咖啡师比赛」冠军，2008年英国杯测大赛冠军。拥有一个名为<strong>Square Mile Coffee Roasters的咖啡烘焙公司</strong>，拥有17位专业人士，专注于为希望作出最好的咖啡的企业提供批发服务。而更为著名的黑鹰咖啡机VA388「少数星巴克臻选店会选用，也叫黑鹰店」出自他和另一位设计师之手，独特的重量控制系统，极大地提高了咖啡出品的稳定性，被视为划时代产品。</p>
<p>据说：James Hoffmann在研究咖啡的时候曾看到《世界红酒地图》这本书，想到当今还没有这样关于咖啡的书，于是这本书就诞生了。他用整整两年时间走遍了各个咖啡产区，用他的这些阅历成就了《世界咖啡地图》</p>
<p>本书由认识咖啡、咖啡制作、咖啡产地探源三个模块构成，并在第二版中首次将中国云南作为产地加入该咖啡地图中。</p>
<p>仔细阅读并作了相关笔记，打算整理一下分享出来。</p>
<blockquote>
<p>书中的内容真的很有启发很有意思，作者介绍基础的咖啡知识的同时也分享了很多自己对整个产业的思考和观察，极大引起读者的思考和兴趣。</p>
<p>以下记录主要为书中内容，并结合自己知识和其他书本内容辅助，旨在构建一个比较清晰明朗的咖啡知识入门框架。</p>
</blockquote>
<!----more--->
<p><img src="/2020/07/16/%E4%B8%96%E7%95%8C%E5%92%96%E5%95%A1%E5%9C%B0%E5%9B%BE/jameshoffmann.png" alt="帅"></p>
<h2 id="导言"><a href="#导言" class="headerlink" title="导言"></a>导言</h2><p>咖啡产业可以被划分为两个不同的类别：商业咖啡(commodiy coffee)和精品咖啡(speciality coffee)。 本书主要聚焦于对精品咖啡的讨论，口感和品质是定义精品咖啡的标准，咖啡的产地很重要，因为产地在很大程度上决定了咖啡的风味。商业咖啡则是指不以品质来论价格，仅仅被称为咖啡的商品，对商业咖啡来说，咖啡的种植地点、采收方式及处理方式并不重要，“一种来自热带的普通商品，能让我快速获取咖啡因并保持清醒的饮品”，这是世上大多数咖啡饮用者对咖啡的认知，也可以说是商业咖啡的定义。</p>
<h2 id="认识咖啡"><a href="#认识咖啡" class="headerlink" title="认识咖啡　"></a>认识咖啡　</h2><p><strong>咖啡品种</strong></p>
<p>阿拉比卡和罗布斯塔（Arabica and Robusta）</p>
<p>当提及咖啡时，通常指从一个特定树种（Species）—— 咖啡树结出的果实，我们现在称这种书为阿拉比卡（Coffea arabica）。占据全球咖啡市场主要份额，在数十个咖啡生产国中种植。但目前被识别的咖啡树种超过120个，仅有一种达到阿拉比卡的普及程度，即卡内弗拉咖啡树属（Coffea canephora），也就是我们熟知的罗布斯塔（Robusta）。</p>
<p>罗布斯塔主要用于宣传树种特性，19世纪末最先出现于刚果。相较于阿拉比卡严苛的生产种植条件，罗布斯塔对于环境的适应程度很高，所以成本很低。问题在于，多数罗布斯塔咖啡不是很美味。但罗布斯塔咖啡全球市场率依旧占到了约40%，主要是因为速溶咖啡产业的推动，对于速溶咖啡而言，成本远大于风味，这个市场占比一般会根据市场需求浮动（全球咖啡价格等）。</p>
<blockquote>
<p>并非所有罗布斯塔豆都品质低下，制作出高质量的罗布斯塔也是可能的。</p>
<p>两者从基因上发现，罗布斯塔是阿拉比卡的双亲之一。</p>
</blockquote>
<p><strong>咖啡树</strong></p>
<p><img src="/2020/07/16/%E4%B8%96%E7%95%8C%E5%92%96%E5%95%A1%E5%9C%B0%E5%9B%BE/coffeetree.jpg" alt></p>
<blockquote>
<p>笔者研究较少，仅做少量摘录补充。</p>
</blockquote>
<p>咖啡生产者在选择栽培哪个品类时，风味优劣并非主要考量因素；对将种植咖啡作为日常生机来源的生产者来说，品类是否高产或有较强的抗病性更为重要。并不是说所有咖啡生产者的种植标准都源于此，但重要的一点是，我们必须有心理准备，明白生产者的抉择与他们的获利和收入息息相关。</p>
<p>咖啡树种植条件苛刻，一般需要年均温度20度，成长期需要充足的降水。咖啡树广泛种植在赤道附近的热带、亚热带地区。</p>
<p>从<strong>种子到成树</strong>，需要6-12个月，种苗可以从育苗区移植到正式咖啡园区。从种植到收获，至少需要三年时间。所以种植咖啡豆是一件需要严肃对待的事情。</p>
<p><strong>咖啡果实</strong></p>
<p>不同品种咖啡果实、大小会有很到不同，总的来说，咖啡果实体积像小号的葡萄。与葡萄不同的是，咖啡果实中心的种子占据了整颗果实的绝大部分，表皮及其底下的一层果肉占比很低。果实的<strong>成熟度</strong>通常与其含糖量的多寡直接相关，这正是种出美味咖啡的决定性因素。</p>
<p><strong>咖啡的种子也就是咖啡豆</strong>，结构有许多层，大部分都会在生豆精致处理阶段被去除，留下用来研磨以及冲煮的咖啡豆。种子的外壳有保护作用，称为内果皮（parchment），里面还有一层薄膜，称为银皮（silverskin）。</p>
<p>大部分咖啡浆果内有两对生种子，相连的一面会随着果实的生长呈平面。偶尔浆果中只有一颗种子，称为小圆豆(peaberry)，他不像平豆那样有一面是平的，而是呈椭圆形，这种情况占总体产量的5%左右。小圆豆通常会被特意分出来，因为有些人相信他有特别讨喜的特质，也有人认为小圆豆必须用不同于平豆的烘焙方式处理。</p>
<blockquote>
<p>什么是圆豆：一般来说一颗咖啡果中会有两颗平豆，只有极少数咖啡果中有一颗圆形种子。</p>
</blockquote>
<h2 id="咖啡品种（Coffee-Varieties）"><a href="#咖啡品种（Coffee-Varieties）" class="headerlink" title="咖啡品种（Coffee Varieties）"></a>咖啡品种（Coffee Varieties）</h2><blockquote>
<p>人工栽种的咖啡树起源于埃塞俄比亚，这一称为帝比卡(Typica)的品种直到今日仍被广泛种植；现今还有许多其他品种，一些自然突变的品种和其他杂交品种。某些品种具有明确的风味特质，有些则因生长环境细微的风土条件、栽种方式和生豆精致处理方式等因素产生不同的风味特质。</p>
</blockquote>
<p>注意：在介绍不同品种时，除非有十分明确、独特风味关联性，一般不会主动描述风味，风味受到多种因素影响，缺乏系统性研究来佐证其中的联系，容易造成误导。</p>
<p><strong>帝比卡（Typica）</strong></p>
<p>该品种是所有咖啡变种或基因筛选的原型。</p>
<p>荷兰是第一个将咖啡传播到世界各地并进行商业化种植的国家，帝比卡就是当时的咖啡品种。</p>
<p>果实通常红色，杯中风味突出，果实产量相对较少。</p>
<p><strong>波旁（Bourbon）</strong></p>
<p>留尼汪岛由帝比卡自然突变得到的品种，果实产量相对帝比卡略多。</p>
<p>许多专业人士认为波旁有一股独特的甜味，因此常在比赛中获奖，风味愉悦，抗虫害能力弱。</p>
<p>果实颜色：红果皮、黄果皮甚至橘果皮。</p>
<p><strong>蒙多诺沃（Mundo Novo）</strong></p>
<p>帝比卡及波旁的自然杂交品种。风味接近波旁。</p>
<p>20世纪40年代发现于巴西，以当地地名命名。</p>
<p>果实产量相对较高，体制较强以及较佳的抗病性被广泛种植，且能够适应巴西1000 - 1200米的海拔高度。</p>
<p><strong>卡杜拉(Caturra)</strong></p>
<p>1937年发现于巴西的波旁突变种。</p>
<p>果实产量较高，果实产量会超过植物的负荷，容易压断枝干导致枯萎。</p>
<p>高度在各品种中属于较低矮的，因此也称“侏儒品种”或“半侏儒品种”。</p>
<p>在哥伦比亚和中美洲特别受欢迎，巴西也很常见。</p>
<p>杯中风味表现优秀，随着海拔上升质量提升，产量随之递减。</p>
<p>果实由红色和黄色之分，高度较矮。</p>
<p><strong>卡图艾（Catuai）</strong></p>
<p>20世纪50～60年代由巴西农艺研究机构栽培的卡杜拉及蒙多诺沃的杂交品种。主要结合了卡杜拉的侏儒基因和蒙多诺沃的高产量和抗病性。</p>
<p>果实有红黄之分。</p>
<p><strong>马拉戈日皮（Maragogype）</strong></p>
<p>马拉戈日皮是帝比卡变种中较容易辨认的品种之一，最先发现于巴西。</p>
<p>豆体巨大，树叶宽大，但果实产量较少，也被称为“象豆”。</p>
<p>通常红色果皮。</p>
<p><strong>SL-28</strong></p>
<p>20世纪30年代，在肯尼亚的斯科特实验室（Scott Lavoratories）中由坦桑尼亚一种耐旱品种选育出来。果实成熟时呈红色，种子一般品种略大。</p>
<p>一般认为可以制作出水果风味明显的咖啡。</p>
<p>容易感染叶锈病，适合在高海拔地区种植。</p>
<p><strong>SL-34</strong></p>
<p>由法国传教士波旁（French Mission Bourbon）选育，自波旁岛带入非洲，一开始出现在坦桑尼亚，稍后被引入肯尼亚。</p>
<p>具有明显的水果风味，但一般认为风味略逊于SL-28。</p>
<p>对叶锈病抵抗力很弱，红色果皮。</p>
<p><strong>瑰夏(Geisha/Gesha)</strong></p>
<p>今天种植于巴拿马境内的瑰夏是从哥斯达黎加引进的，一般认为源头是埃塞俄比亚一个名为Gesha的小镇。</p>
<p>一般可以制作出有特别芳香的花朵风味咖啡，近年来因市场需求度高而价格暴涨。</p>
<p><strong>帕卡斯（Pacas）</strong></p>
<p>帕卡斯为波旁变种，与1949年在萨尔瓦多被帕卡斯家族发现。</p>
<p>帕卡斯品种的果皮为红色，较低矮的树丛有利于人工采收。</p>
<p>风味近似波旁，属于较为讨喜的类型。</p>
<p><strong>维拉 萨尔奇(Villa Sarchi)</strong></p>
<p>哥斯达黎加一个小镇被发现，因此得名。</p>
<p>波旁的另一个自然突变种，与帕斯卡一样有着侏儒般的低矮树丛。</p>
<p>目前被培育成产量极高的咖啡品种。</p>
<p>风味优异，红色果皮。</p>
<p><strong>帕卡马拉(Pacamara)</strong></p>
<p>1958年在萨尔瓦多人工培育出的混血品种，双亲为帕卡斯和马拉戈日皮。与马拉戈日皮一样具有较大的叶片、果实及种子，风味也有许多明显、优质的独特属性。</p>
<p>有巧克力和水果氛围，但可能带不讨喜的草本、洋葱的风味。</p>
<p>红色果皮。</p>
<p><strong>肯特(Kent)</strong></p>
<p>20世纪20年代在印度的一项选种计划中一位咖啡农的姓氏得名。</p>
<p>为提高抗叶锈病的能力而培育的品种。</p>
<p><strong>S795</strong></p>
<p>印度配虚的品种，肯特和S288杂交，较早被选育、具有抗叶锈病能力的品种，在印度和印尼广泛种植。</p>
<p><strong>野生阿拉比卡品类(Wild Arabica Varieties)</strong></p>
<p>以上品种基因相似度较高，因为几乎源于单一品种的帝皮卡。</p>
<p>而埃塞俄比亚具有很多不是人工培育的原生品类（heirloom varieties），由不同树种品类之间各种杂交，很难更具种类来分类并研究风味上的差异。</p>
<h2 id="采收咖啡-Harvesting-Coffee"><a href="#采收咖啡-Harvesting-Coffee" class="headerlink" title="采收咖啡(Harvesting Coffee)"></a>采收咖啡(Harvesting Coffee)</h2><p>采收咖啡是一个很基本又非常重要的环节。在咖啡果实达到最佳成熟度时采收，制作出的咖啡通常味道最棒。专家将采收阶段视为影响咖啡品质的关键。采收之后的各阶段只能保持品质而无法改变品质。</p>
<p>采收高质量咖啡果实面临最大挑战大概就是所在的地形了，高质量的咖啡必须种植在海拔相对较高的地区，许多咖啡庄园就位于多山区域的陡峭斜坡上。</p>
<p><strong>机械采收</strong></p>
<p>巴西境内有许多高海拔又地势平坦的区域，适合大量种植咖啡，大型庄园会将大型机械开进整齐划一的咖啡树列中，发出震动，使浆果松脱后掉落。</p>
<p>使用机械采收最法的问题是会采收到未完全成熟的果实。意味着采收完后必须进行分离成熟果和未熟果的工序，随着果皮掉落的断枝与树叶也必须剔除。</p>
<p>机械采收可以大大降低成本，但同时也会降低质量。</p>
<p><strong>速剥采收法</strong></p>
<p>一次将整个枝条上所有果实以熟练的手法快速剥除，像机械收割般快速，但相对不精确。采收的结果是成熟的果实与未熟的果实混杂，需要进一步筛选。</p>
<p><strong>手摘采收法</strong></p>
<p>为了制作高质量的咖啡，该方法依旧是最有效率的采收方式。 采收工采收成熟的浆果，未成熟的果实等成熟后再收，这是一种高强度的劳动。</p>
<h2 id="生豆处理-Processing"><a href="#生豆处理-Processing" class="headerlink" title="生豆处理(Processing)"></a>生豆处理(Processing)</h2><p>咖啡在采收后进行精制处理的方式对一杯咖啡的风味有很大影响，因此如何描述和推销精致处理法越来越重要。精致处理对咖啡质量影响甚巨，越来越多老练的咖啡生产者开始通过操纵精制处理流程的差异来制作特定质量的产品。</p>
<p>采收后，所有咖啡浆果会送到湿处理厂，在这里进行从剥除外果皮到晒干咖啡豆等系列程序，才能达到合适的存储状态。「咖啡豆的含水率从60%到11%～12%，防止运送过程中腐坏」</p>
<p><img src="/2020/07/16/%E4%B8%96%E7%95%8C%E5%92%96%E5%95%A1%E5%9C%B0%E5%9B%BE/process.jpg" alt></p>
<p><strong>日晒处理法(dry process)</strong></p>
<p>最古老的生豆精制处理法：将采收后的咖啡浆果直接铺成薄薄一层，接受阳光暴晒。有些产区会将浆果放在砖制的露台上，有些则使用特质的架高式日晒专用桌，让浆果享受更多空气对流，干燥效果更均匀。日晒过程中不断翻动浆果，避免发霉，过度发酵或腐败。当浆果达到适当含水率时（11%）用机器将外果皮及硬壳脱除，在出口前以生豆的状态保存。</p>
<p>日晒处理偶尔会添加宜人的好味道，但多数是令人不舒服的气味。</p>
<p>在全世界的产区中，日晒处理法通常被视为用来制作质量非常低或未成熟果较多批次的方式。多数选择用日晒处理高质量咖啡豆的人会发现，用日晒处理更昂贵，因为要照顾好这些豆子需要付出更多专注力以及劳动力。</p>
<p>不论哪个品种或在哪个微气候区域，日晒处理通常为为咖啡增加水果般的风味。所谓水果风味通常为蓝莓、草莓、热带水果等，但有时候也会产生负面风味，比如谷仓边的土地味，野性风味，过度发酵及粪便味等。</p>
<p>日晒处理法是一种相对难以预测的精致处理法，经过高质量采收批次有可能因为这一处理法而变质，造成难以挽回的失败和生产者的重大经济损失。</p>
<p><strong>水洗处理法</strong></p>
<p>水洗处理法的目的是在干燥程序之前去除咖啡豆上黏糊糊的果肉层，如此可大大降低干燥程序中可能出现的变量，因此咖啡豆可能会有较高的经济价值。不过会花费更多成本。</p>
<p>在采收后浆果会用去皮机将外果皮及大部分果肉从咖啡豆上分离，随后被引导至一个干净的水槽，浸泡水中进行发酵。</p>
<p>发酵程序所需的时间与许多因素有关，包括海拔高度以及周围环境的温度，温度越高的环境发酵越快。如果咖啡豆在发酵过程中浸泡太久，负面风味就会增加。</p>
<p>发酵完成后进行干燥，基本与日晒相同。</p>
<p>相较别的处理法，水洗处理法往往使得咖啡豆呈现出酸味稍高、复杂度较强及更干净的杯中特质。</p>
<p>干净是个非常重要的词，意指一杯咖啡没有负面风味，，如瑕疵风味或者不寻常的尖锐感（harshness）及涩感（astringency）</p>
<blockquote>
<p>水洗处理法发酵过后的污水可能产生危害环境的毒性。</p>
</blockquote>
<p><strong>以下为混合式处理法：</strong></p>
<p><strong>去果皮日晒处理法</strong></p>
<p>主要在巴西使用的处理法，由设备制造商Pinhalese经过多次实验研发出来的成果，实验方向就是用比水洗法更少的水制作出高质量的咖啡豆。</p>
<p>在采收之后，咖啡果实用去果皮机剥除外果皮会大部分的果肉层，直接送至露台或高架式日晒专用桌进行干燥。保留的果肉越少，越能降低瑕疵豆的风险，但小部分的果肉仍会给咖啡豆贡献更多的甜味与风味的厚实度。需要留意脱除果皮、果肉后的干燥程序。</p>
<p><strong>蜜处理法</strong></p>
<p>接近果皮日晒处理，主要在哥斯达黎加和萨尔瓦多等为数不少的中美洲国家使用。采收后的咖啡果实一样用去果皮机剥除外果皮，但会比果皮日晒处理法使用更少的水。</p>
<p>去果皮机可以控制让多少果肉层保留在豆表硬壳上，因此该制作可以称为100%蜜处理或20%蜜处理等。</p>
<p>保留越多果肉层，进行干燥程序时产生过度发酵风味的瑕疵风险就越高。</p>
<p><strong>半水洗处理 / 湿磨处理法</strong></p>
<p>印度尼西亚常用的处理法，当地称为giingbasah。采收后的浆果脱除果皮后，会进行短时间的干燥程序。</p>
<p>与其他处理法不同的是，这一处理法不直接将咖啡豆晒到含水量11%～12%的程度，而是晒到含水率30～35%时先脱去内果皮，让生豆表面直接暴露出来，之后继续晒干，直到达到不易腐坏、方便存储的含水率，这两次干燥方式赋予咖啡豆沼泽般的深绿色外观。</p>
<p>半水洗处理法使咖啡豆具备较低的酸度，同时具有更醇厚的特性，这一处理法也制作出很多不同的风味。</p>
<h2 id="咖啡烘培-Coffee-Roasting"><a href="#咖啡烘培-Coffee-Roasting" class="headerlink" title="咖啡烘培(Coffee Roasting)"></a>咖啡烘培(Coffee Roasting)</h2><p>在咖啡产业里，烘焙是很吸引人的一个环节。咖啡生豆几乎没有风味可言，甚至有一种不讨喜的蔬菜味。但烘焙后的就会转变为不可思议的芳香而又风味复杂的咖啡熟豆。</p>
<p>总的来说，全世界的精品咖啡烘焙商都依靠自我训练，其中许多通过不断试错而学到精品咖啡贸易的精髓。不同的咖啡烘焙商有各自的风格，、美学理念和烘焙哲学，对如何重视他们想要的咖啡质量十分清楚，但不见得了解烘焙全貌，因为要烘焙出不同风格可能存在困境。</p>
<p>简言之，咖啡烘焙指的是咖啡豆最后的颜色烘到多深，要花多长时间，轻描淡写的说某种咖啡是浅烘的，这样不够，因为这种咖啡可能是快炒也可能是慢炒，不同的烘焙速率会带来截然不同的风味体现，尽管颜色相近。</p>
<p>咖啡在烘焙时会发生一系列不同的化学反应，很多反应让重量减少，当然也会造成水分流失。慢炒（14～20分钟完成烘焙）会有较高的失重量比（16% ～ 18%），快炒最快可以在90s内完成。对于一杯昂贵的咖啡而言，慢炒的方式会呈现出更好的风味。</p>
<p>三个决定咖啡最终风味的要素必须控制得当：酸味、甜味、苦味。一般而言，总体烘焙时间越久，最后留下的酸味就越少，相反，苦味则随着烘焙时间增加而增强，也深烘焙的咖啡越苦。甜味的发展呈现钟形曲线状，介于酸味和苦味高峰之间，好的咖啡烘焙商知道如何让咖啡豆达到每个烘焙度中的甜度峰值。但无论使用酸甜程度皆强的烘法还是甜度极高，酸度较弱的烘法，如果你使用的咖啡豆质量差，调整烘焙手法可能也无济于事。</p>
<p><strong>咖啡烘焙阶段：</strong></p>
<p>第一阶段：去除水分</p>
<p>咖啡生豆含有7% - 11%的水分，均匀分布与整颗咖啡哦度紧密的结构中，水分较多时，咖啡豆不会变成褐色。</p>
<p>第二阶段：转黄</p>
<p>多余水分被带出咖啡豆后，褐化反应第一阶段就开始了。咖啡豆在这个阶段结构依然紧实，且带有类似印度香米及烤面包的香气。</p>
<p>以上阶段至关重要，如果咖啡豆水分没有被适当去除，咖啡豆在之后的烘焙阶段无法实现均匀烘焙。即使咖啡豆表面看起来无碍，内部却可能没有熟透，冲煮风味令人不悦。</p>
<p>第三阶段：第一爆</p>
<p>褐化反应加速时，咖啡豆内开始产生大量气体及水蒸气。当内部压力变大时，咖啡豆开始爆裂，发出清脆异响。同时膨胀至两倍大小。这是烘豆师就可以自行选择何时结束烘焙。</p>
<p>第四阶段：风味发展初期</p>
<p>第一爆结束后，咖啡豆表面看上去会较为平滑，但仍有少许褶皱。这个阶段决定咖啡最终上色的深度和烘焙的实际深度。</p>
<p>第五阶段：第二爆</p>
<p>到这个阶段，咖啡豆再次发出爆裂声，不过声音较为细微和密集。这个阶段内部的油脂会容易被带到豆表，大部分酸味会消退，并产生一种新的风味，称为“烘焙味”。这种风味不会因为豆子种类不同而存在差异，因为成因为炭化或焦化作用，而非来自内部固有风味成分。</p>
<p>将咖啡豆烘焙到第二爆阶段更深的程度是很危险的，有时可能导致火灾。</p>
<p>其中“法式烘焙”和“意式烘焙”等烘培程度是烘焙到很深的的咖啡豆，有典型的高浓郁度、强烈的苦味，但多数豆子自身的个性会消失。如果你想认识来自不同产地的高品质咖啡的风味及个性，建议不要选择重度烘焙的豆子。</p>
<p>咖啡内的糖分：</p>
<p>咖啡生豆含有一定的单糖成分，在烘焙温度的催化下很容易发生反应。一旦咖啡豆内大部分水分蒸发以后，糖类就会与热量开始发生不同的反应，有些会产生焦糖化作用，使某些咖啡豆产生焦糖似得调性。但焦糖化之后，糖类的甜度会降低，最终变为苦味的来源之一；此外，有些糖类会与咖啡豆内的蛋白质相互作用，产生所谓的美拉德反应(Maillard reactions)，这种反应也包括肉类在烤箱内转变为褐色的现象以及烘焙可可豆时变色现象。</p>
<p>一爆后，单糖基本不存在了，可能都参与了不同的化学反应，最后转变为更多不同类型的咖啡芳香化合物。</p>
<p><img src="/2020/07/16/%E4%B8%96%E7%95%8C%E5%92%96%E5%95%A1%E5%9C%B0%E5%9B%BE/bean.jpg" alt></p>
<p>咖啡内的酸成分：</p>
<p>咖啡豆中有许多酸，有些讨喜，有些不美味。对于烘豆师而言，最重要的是绿原酸(CGAs),烘焙咖啡时，重点目标是完全除去不够完美的酸，同时避免制造出更多负面风味因子，而保留更多讨喜的芳香成分。此外，有些酸在烘焙后保持稳定状态，例如：奎宁酸，会增加讨喜，干净的风味质感。</p>
<p>咖啡内芳香化合物：<br> 大多数咖啡的香气来自烘焙时的三大反应：美拉德反应，焦糖化反应以及斯特雷克降解反应。这些反应在咖啡烘焙时因受热而催化，最后产生超过800种不同的易挥发性芳香化合物，这就是咖啡风味的来源。</p>
<p>在咖啡烘焙完成后，必须快速将咖啡豆冷却，以免过度烘焙或是让咖啡豆发展出负面风味。</p>
<h2 id="咖啡的研磨（Grinding-Coffee"><a href="#咖啡的研磨（Grinding-Coffee" class="headerlink" title="咖啡的研磨（Grinding Coffee)"></a>咖啡的研磨（Grinding Coffee)</h2><p>研磨咖啡的目的是让咖啡豆在冲煮之前产生足够的表面积，以便萃取出封存于咖啡内部的成分。咖啡豆磨的越细，理论上就会有更大的表面积，可以用更快的速度煮出咖啡的味道，因为水有更多机会带出咖啡风味因子。</p>
<p>研磨机器：</p>
<p>螺旋桨刀片研磨机：电动研磨机十分常见，价格也不贵，机器构造是在电动马达上连接一组金属刀片，借助旋转的力量击碎咖啡豆，会产生极细和极粗的颗粒，冲泡时会导致风味很怪异。</p>
<p>磨盘式磨豆机：分电动和手动版本。磨盘式磨豆机有两个面对面的切割盘，通过调整切割盘的间距，可以调整研磨粗细。当咖啡豆被切割成符合间距的大小时，咖啡粉才能更均匀，同时可以调整粗细，对煮一杯好咖啡来说相当有帮助。如果你很喜欢咖啡，磨豆机的投资带给你的回报是无法以价格衡量的。冲煮意式浓缩咖啡时，颗粒大小非常重要，即使百分之一毫米的粗细差异也会造成影响。</p>
<p>不同机器制造商会使用不同材质制造的切割盘，比如钢或者陶瓷。一段时间后，磨盘上的刻痕会变钝，此时磨豆机不会以切割的方式磨豆子，而是以碾压的方式，这样会造成很多极细的粉末，导致咖啡乏味又苦涩。根据制造商的建议，定期更换磨盘是一项很小却很值得的投资。</p>
<blockquote>
<p>很多咖啡爱好者想升级设备，第一建议就是磨豆机。是非常值得的一项投资，一台低劣的磨豆机，很容易拉低一款咖啡豆的上限。</p>
</blockquote>
<p>研磨度调整：磨豆机并不能将咖啡豆磨成同样的大小，更具自己需求多做实验，调整到合适的研磨度。深烘焙的咖啡豆质较脆，因此必须将刻度调粗一些。同样要研磨海拔产地较高的咖啡豆，比如从巴西豆转换到肯尼亚，需要把刻度调细。</p>
<p><img src="/2020/07/16/%E4%B8%96%E7%95%8C%E5%92%96%E5%95%A1%E5%9C%B0%E5%9B%BE/grid.jpg" alt></p>
<p>冲煮用水：</p>
<p>水的角色：在意式浓缩咖啡中，水占了90%，在滤泡式咖啡中，水占了98.5%；如果冲泡咖啡的水不美味，那么咖啡也绝对不可能好喝。</p>
<p>在冲煮过程中，水扮演着溶剂的角色，负责萃取出咖啡粉内的风味成分，因为水的硬度以及矿物质含量会影响咖啡的萃取效率，所以水质相当重要。</p>
<p>硬度：水的硬度指水中含有多少水垢（碳酸钙）数值。硬水会改变咖啡粉内可溶出物质的比例，进而改变咖啡的化学成分比例，理想的水硬度较低，如果含量过高甚至极高，不适合泡咖啡。矿物质含量：不希望水中有太多其他东西：即含量很低的矿物质。</p>
<hr>
<p>UPDATING…</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/" class="post-title-link" itemprop="url">Apple保修政策</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-06-29 18:15:19" itemprop="dateCreated datePublished" datetime="2020-06-29T18:15:19+08:00">2020-06-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
    </span>

  
    <span id="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/" class="post-meta-item leancloud_visitors" data-flag-title="Apple保修政策" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>6.3k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>6 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Apple-保修政策-「更新至Mac、iPhone、AirPods」"><a href="#Apple-保修政策-「更新至Mac、iPhone、AirPods」" class="headerlink" title="Apple 保修政策-「更新至Mac、iPhone、AirPods」"></a>Apple 保修政策-「更新至Mac、iPhone、AirPods」</h1><p>自从用上Apple全家桶之后，日常生活已逐渐离不开Apple生态的产品了，而从产品角度来讲，不可避免会有所损伤或故障，这时候就很有必要了解一下相关产品的保修政策了。借此机会梳理一下Apple主要产品的保修政策。</p>
<blockquote>
<p>AppleCare+ 简称AC+。</p>
</blockquote>
<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>很多Apple用户对于Apple提供的相关保修政策可能不是很了解，先介绍一下。若了解可直接跳过。</p>
<p>以下讨论为国行机器，虽然Apple产品全球联保，但经过与Apple Store相关店员确认，因为每个国家都有其保修政策，具体实施上会根据硬件产品的相关差别产生很大的影响「配件不通用等问题」，可能无法保证服务质量。</p>
<p>Apple原话：</p>
<blockquote>
<p>当你购买 Apple 硬件产品时，你还将获得 Apple 一年有限保证项下的保修服务。通过购买可选的 AppleCare Protection Plan 全方位服务计划，你还可以获得其他额外益处。 根据三包规定，Mac 和 iPad 的主要部件将获得自购买日起两年的保修服务。 Apple 尊重中国的国家法律和地方法规。根据浙江的地方三包规定，浙江省的 Mac 台式电脑产品享有整机三年保修服务。</p>
</blockquote>
<!-----more------->
<p>据描述，若是在中国购买的Apple产品，Apple提供的以下保修服务：</p>
<ul>
<li>中国三包政策</li>
<li>Apple 一年有限保修服务</li>
<li>（可选）AppleCare Protection Plan 全方位服务计划</li>
</ul>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/2.png" alt="1"></p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/3.png" alt="3"></p>
<p><strong>如何区分以上几个政策：</strong></p>
<p><strong>中国三包政策</strong>：是政府为保障消费者权益而设立的政策，对相关电子产品的保修服务等作出强制的售后规定。苹果要卖电子产品必须遵守的。可以简单理解为是<strong>国内的标准三包</strong>，仅适合国内保修。</p>
<p><strong>Apple 一年有限保修服务</strong>：这个可以理解为<strong>Apple自己设立标准的三包</strong>，包含90天的电话技术支持，保修期限为一年，适合全球联保。</p>
<p><strong>AppleCare Protection Plan 全方位服务计划</strong>：即是AppleCare+服务计划，钱购买Apple的保险服务，主要特点在于延长了保修期限，Apple技术支持，<strong>最主要的是包含了因意外使用导致设备损坏，可以大大降低维修费用</strong>，且支持全球联保，可以在全球任何Apple门店享受以上服务。</p>
<blockquote>
<p>除了AC+之外的保修服务主要是Apple产品因为质量问题导致的故障。</p>
</blockquote>
<h2 id="Mac保修政策"><a href="#Mac保修政策" class="headerlink" title="Mac保修政策"></a>Mac保修政策</h2><p>首先了解一下Appe产品在中国的官方保修政策，也就是只要你购买，就享有以下保修服务：</p>
<blockquote>
<p><strong>保修期限</strong></p>
<ul>
<li>Mac <strong>电脑整机及所含附件</strong>自原始购买之日起享有 1 年保修期。</li>
<li><strong>主要部件</strong>享有自购买之日起 2 年保修期。<ul>
<li>Mac 台式电脑所有主要部件包括：主板 (MLB)、处理器 (CPU)、内存、硬盘 (HDD/SSD)、电源和显卡。</li>
<li>Mac 笔记本电脑所有主要部件范围包括主板 (MLB)、处理器 (CPU)、内存、硬盘 (HDD/SSD)、电源适配器、键盘和显示屏 (LCD)。</li>
</ul>
</li>
</ul>
<p><strong>维修方式</strong></p>
<ul>
<li>根据具体的故障情况对设备进行维修。</li>
<li>所有更换的部件和附件都是全新的。</li>
<li>更换的<strong>非主要部件和附件</strong>享受原有保修期的剩余时长或自更换日起 90 天的保修期，以二者中期限较长者为准。更换后的<strong>主要部件</strong>享有重新计算的 2 年保修期。</li>
</ul>
</blockquote>
<p>需要注意的是主要部件和非主要部件和附件之间的区分。两者的保修策略是不同的。在部件使用保修之后，根据保修部件重置保修时长。</p>
<p>划重点：</p>
<p>Apple在保修中特别提到：<strong>如果在浙江购买的台式机电脑可以享受整机3年保修</strong>（也就是所有部件），约等于免费赠送AppleCare的延保计划。而且是整机3年保修，不再分主次部件之分。但是限制条件是：<strong>在浙江购买的Mac台式电脑只有在浙江当地指定的维修点才能享受所有部件三年的保修。</strong></p>
<p>该政策的问题在于Apple通过何种方式鉴别是否为浙江省购买的用户，若冲这个服务去的，最佳的方案是在Apple浙江的零售店「天一广场店、杭州万象城店、西湖店」进行产品的购买，并保留购买凭证，然后有问题去浙江的门店维修。「有反馈说官网买，浙江地区收货，店员拒绝承认是浙江购买的例子，故最保险的还是去Apple Store购买」具体的维修政策可能有很大差异，视帮你维修的店员为准。</p>
<h3 id="Mac的AppleCare-服务"><a href="#Mac的AppleCare-服务" class="headerlink" title="Mac的AppleCare+服务"></a>Mac的AppleCare+服务</h3><p>Mac的AppleCare服务相关政策参考链接：<a target="_blank" rel="noopener" href="https://www.apple.com.cn/support/products/mac/">AppleCare</a></p>
<blockquote>
<p>适用于 Mac 的 AppleCare+ 服务计划可提供长达 <strong>3 年的专家技术支持</strong>，以及来自 <strong>Apple 的额外硬件保修服务</strong>，包括<strong>最多两次意外损坏保修服务</strong>，每次需收取相应的服务费：对于屏幕损坏或机身外壳损坏，收取 RMB 799 的服务费；对于其他损坏，收取 RMB 2299 的服务费。服务期自购买 AppleCare+ 服务计划之日开始。</p>
<p>中国的消费者权益保护法包括“三包”规定，赋予了消费者自购买 Mac 之日起 2 年的主要部件质量问题保修服务。在浙江省，消费者权益保护法赋予了消费者自购买之日起 3 年的台式电脑质量问题保修服务。在此基础之上，大多数 Apple 产品也附带 90 天的免费电话技术支持，以及来自 Apple 的 1 年有限保修服务。</p>
</blockquote>
<p><strong>重点整理：</strong></p>
<ul>
<li><p>三年专家技术支持</p>
</li>
<li><p>硬件维修范围</p>
<ul>
<li><p>你的Mac电脑、所含配件、Apple内存、AirPort、Apple USB全能光驱  「<strong>以上硬件在保修范围内被鉴定损坏，可享受免费保修</strong>」</p>
</li>
<li><p>最多两次意外损坏保修服务，屏幕损坏或机身外壳损坏，收取799服务费，其他损坏，收取2299服务费。「<strong>意外损坏非产品质量问题，而是你使用不当造成的损坏，但收费远低于过保的价格</strong>」</p>
<blockquote>
<p>这边涉及的其他损坏，一般涉及主板相关的更换，我咨询过杭州湖滨银泰的Apple Store，仅仅是键盘损坏，就需要对整块主板进行更换。</p>
</blockquote>
</li>
</ul>
</li>
<li><p>电池维修服务</p>
<ul>
<li>当电池容量低于原规格标示的80%左右时，可以获得电池维修服务。「<strong>免费更换</strong>」</li>
</ul>
</li>
<li><p>软件支持</p>
<ul>
<li>masOS 和 iCloud的使用</li>
<li>快速解答各种Apple品牌app的使用方法问题。</li>
</ul>
</li>
</ul>
<p>对于意外损坏之外的硬件产品，只要是三年内非人为损坏，均可进行免费的维修和更换，不需要材料的维修费用和维修人工费用。而其余的人为损坏，比如倒水导致主板烧掉，屏幕摔坏等等，即可享受意外损坏保修服务。不论电池或者意外损坏，一次便可回本，对于高强度使用者，或者平日比较马大哈的朋友，是很值得考虑的一个选项。</p>
<blockquote>
<p>Mac的电池损耗次数设定为1000次。若外出需求较大，三年内即便正常使用很容易达到规定的循环次数，也就是电池容量损耗至80%以下，免费更换一下电池，继续挺几年，还是比较划算的。</p>
</blockquote>
<p>保外的电池更换费用如下「血贵」：</p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/4.png" alt="xx"></p>
<h3 id="不在AppleCare保修范围内的情况："><a href="#不在AppleCare保修范围内的情况：" class="headerlink" title="不在AppleCare保修范围内的情况："></a>不在AppleCare保修范围内的情况：</h3><p><strong>下列条款适用于所有AppleCare产品</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.apple.com/legal/sales-support/applecare/appmacchszh.html">链接</a></p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/5.png" alt></p>
<h3 id="Apple-Care购买"><a href="#Apple-Care购买" class="headerlink" title="Apple Care购买"></a>Apple Care购买</h3><ol>
<li>AppleCare+ 服务计划可在购买新 Mac 的同时进行购买。</li>
<li><p>或可在购买 Mac 之日起 60 天内通过以下方式进行购买：</p>
</li>
<li><ul>
<li>前往 Apple Store零售店 (需检查你的 Mac 及其购买凭证)</li>
<li>致电 400-666-8800 (需运行远程诊断功能并提供购买凭证)</li>
</ul>
</li>
</ol>
<h3 id="AppleCare取消或转让"><a href="#AppleCare取消或转让" class="headerlink" title="AppleCare取消或转让"></a>AppleCare取消或转让</h3><p>只要没有超过AppleCare的保障期限，AppleCare是可以无理由退订或转让的。但是退款费用上回根据实际情况调整。</p>
<blockquote>
<ul>
<li>如果在购买 AppleCare 计划之日起的 30 天内取消该计划，您则将获得全额退款，但要扣除所有已提供服务的相应费用。</li>
<li>如果您在购买 AppleCare 计划的 30 天后取消这一计划，则会根据 AppleCare 计划保障的未到期天数按比例退款，并扣除所有已提供服务的相应费用。</li>
</ul>
</blockquote>
<p>费用折损计算：</p>
<blockquote>
<p>如果您在购买本计划或接受本计划的条款和条件（以后发生者为准）的三十 (30) 天内取消，您将收到在扣除已根据本计划提供服务的服务费后的全部退款。<strong>如果您在收到本计划的三十 (30) 天后取消，您将获得的退款金额为：本计划原购买价格的按比例退款（具体比例取决于自购买本计划之日算起的剩余保修期所占百分比）减去 (a) 取消手续费，即 160 元（人民币）或按比例退款金额的 10%（以二者中较低者为准）</strong></p>
</blockquote>
<p>转让手续：</p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/6.png" alt></p>
<h2 id="iPhone保修政策"><a href="#iPhone保修政策" class="headerlink" title="iPhone保修政策"></a>iPhone保修政策</h2><p>iPhone的AC+政策略微复杂，还包含了Apple推出的年年换新活动。<a target="_blank" rel="noopener" href="https://www.apple.com.cn/support/products/iphone/">AppleCare For iPhone</a></p>
<p>价格：</p>
<blockquote>
<p>iPhone11、iPhoneXR、iPhone 8 Plus：1399元</p>
<p>iPhone11 Pro、iPhone 11 Pro Max、iPhone 11 XS、iPhone 11 XS Max：1799元</p>
</blockquote>
<p>介绍：</p>
<blockquote>
<p>每部 iPhone 均可在有限保修期内享有 <strong>1 年的硬件保修服务</strong>和<strong>长达 90 天的免费电话技术支持</strong>。适用于 iPhone 的 AppleCare+ 服务计划可为你提供自购买该服务计划之日起为期 2 年的维修服务，还可获得最多两次意外损坏保修服务，每次需收取相应的服务费：对于屏幕损坏，收取 RMB 188 的服务费；对于其他任何损坏，收取 RMB 628 的服务费。</p>
</blockquote>
<p>具体内容：</p>
<blockquote>
<ol>
<li>保修从1年升至2年。</li>
<li>优先获得Apple专家的帮助，主要大城市提供当日服务。</li>
<li>硬件维修包含：iPhone整机、电池、包含的耳机和配件。</li>
<li>最多两次意外损坏保修服务，屏幕损坏，每次收取188元；其他损坏，每次收取628元。</li>
<li>电池容量低于原规格标示的80%时，可获得电池维修服务。</li>
<li>解决软件支持相关问题。</li>
</ol>
</blockquote>
<p>所有AC+如果全款购买，均可在中途退款取消或者转移。</p>
<h3 id="那么iPhone的AC-划算吗？"><a href="#那么iPhone的AC-划算吗？" class="headerlink" title="那么iPhone的AC+划算吗？"></a><strong>那么iPhone的AC+划算吗？</strong></h3><h4 id="电池"><a href="#电池" class="headerlink" title="电池"></a>电池</h4><p>根据朋友使用情况及查阅相关资料了解，iPhone电池在2年内用到80%以下，还是有点难度的，应该需要超级重度暴力使用才能做到，想要蹭电池免费换新看运气。</p>
<p>保外相关维修费用如图，</p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/9.png" alt="维修"></p>
<h4 id="屏幕维修"><a href="#屏幕维修" class="headerlink" title="屏幕维修"></a>屏幕维修</h4><p>部分型号屏幕更换费用如下：</p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/11.png" alt></p>
<p>简单算一下，如果使用的是iPhone 11，在2年内屏幕坏了一次，需要花费1399的AC+购买费用和188的屏幕维修费，总计1587元。而单次维修费用为1549元，购买AC+的成本甚至更高。</p>
<p>假设用户更厉害一点，一年坏了两次屏幕，则购买AC+后的维修费用为1775元，未购买AC+的费用为3098元。这种情况貌似有点划算，但前提是用户够狠。</p>
<h4 id="其他维修定价"><a href="#其他维修定价" class="headerlink" title="其他维修定价"></a>其他维修定价</h4><blockquote>
<p>是否需要针对其他问题（如<strong>主屏幕按钮、浸液损坏或配件</strong>）进行维修？</p>
<ul>
<li>如果您的 iPhone 问题在 Apple 保修、AppleCare 计划或消费者权益法的保障范围内，我们不会收取任何费用。<strong>这不包括意外损坏，意外损坏的维修会产生一定的费用。</strong></li>
<li>如果您的 iPhone 存在意外损坏，而您享有 AppleCare+ 服务计划保障，则<strong>可使用其中的一次意外损坏保障来将维修纳入保障范围</strong>。如下文所示，每次提供意外损坏保障时都会收取一定的 AppleCare+ 服务计划服务费。 </li>
<li>如果您的 iPhone 已损坏，而您不享有 AppleCare+ 服务计划保障，<strong>则维修费用会因具体的维修内容而异，最高不会超出下文所示的保外维修费用</strong>。这些保外维修价格适用于由 Apple 提供的维修。Apple 授权服务提供商可能会自行设定相应的费用。</li>
</ul>
</blockquote>
<p>这里就当主板维修费用，详细如下：</p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/10.png" alt></p>
<p>再次以iPhone11举例，使用AC+进行一次主板维护需要花费1399元的AC+购买费用以及628元的主板维修费用，总计2027元。而单次维修需要3109元。</p>
<p>血赚有没有？有个头。但问题是，多少用户会在使用的时候把主板都用烂，而且在两年之内，我想几率应该很小很小。你要是喜欢带着iPhone潜水，推荐购买。</p>
<h3 id="综上"><a href="#综上" class="headerlink" title="综上"></a>综上</h3><p>iPhone的AC+的保修条件相对比较难达到，且一般可以通过改变使用方式等进行避免。</p>
<p>但如果有摔手机等其他特殊癖好，对Apple屏幕、主板等质量信不过的朋友，非常推荐购买。</p>
<p>当然，重度使用者对电池消耗也相对较大，可以购置一个AC+以防万一。</p>
<p>性价比如上描述，最后根据个人情况选择即可。</p>
<h3 id="年年换新"><a href="#年年换新" class="headerlink" title="年年换新"></a>年年换新</h3><p>最后介绍一下Apple的年年换新活动，具体政策查看链接啊：<a target="_blank" rel="noopener" href="https://www.apple.com.cn/shop/iphone/iphone-upgrade-program">iPhone年年换新计划</a></p>
<p>官方介绍挺明白的：</p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/12.png" alt></p>
<p>年年换新购买条件之一是需要在Apple Store零售店购买手机的同时购入AppleCare+计划。应该是Apple希望回收的时候保证机子的质量。</p>
<p>主要<a target="_blank" rel="noopener" href="https://www.apple.com.cn/legal/sales-support/iphoneupgrade_cn/">年年换新条款</a>如下：</p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/13.png" alt="f"></p>
<p>需要留意的是在换购时需要保证iPhone状态完好，如第六条所示。</p>
<p>举个例子，如果你使用iPhone11，且满足换新条件，原价6000购入，在条件期间购买新款手机可以抵价3000元。</p>
<p>但一年使用的手机带AC+，按苹果二手回收价格来看，感觉不是很划算。根据需求判断。</p>
<h2 id="Airpods保修政策"><a href="#Airpods保修政策" class="headerlink" title="Airpods保修政策"></a>Airpods保修政策</h2><p>介绍：</p>
<blockquote>
<p>AppleCare+ 服务计划可为 AirPods、Beats 入耳式耳机或 Beats 头戴式耳机<strong>提供自购买该服务计划之日起长达 2 年的专家技术支持，以及额外硬件保修服务，还可获得最多两次意外损坏保修服务，每次收取 RMB 199 的服务费</strong>。</p>
<p>中国的消费者权益保护法包括“三包”规定，赋予了消费者自购买之日起 3 个月的有线耳机质量问题保修服务。在此基础之上，大多数 Apple 产品还附带 90 天的免费电话技术支持，以及来自 Apple 的1 年有限保修服务。</p>
</blockquote>
<p>Airpods默认一年保修，是针对<strong>产品本身质量问题</strong>导致的问题提供一年的保障，比如电池非正常老化，蓝牙连接不稳定，电流声严重等产品质量上的问题。</p>
<p>但不包含意外损坏，<strong>比如喝汤的时候耳机掉到碗里淹死了，被朋友用诺基亚砸烂，用户酷爱解剖等意外不可控因素</strong>，若日常生活中可能包含以上条件，那么AppleCare+的重要性不言而喻。</p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/8.png" alt="e"></p>
<p>AC+具体内容：</p>
<blockquote>
<p>1.保修延长至两年，优先获得技术支持。</p>
<p>2.电池容量低于80%可以<strong>免费</strong>换新。</p>
<p>3.若在保修的两年期限内，被诺基亚砸烂了，给耳机洗澡了，解剖了等等，我在购买AC+的时候特地问过店员，只要你把耳机尸体拿到店里，仍然能够识别出是你的耳机（序列号检测），耳机坏了就换耳机，壳子坏了换壳子，两个都坏了就都换，<strong>算一次意外保修</strong>，只需要再支付199元的服务费即可。而且他也特地强调了<strong>只换不修</strong>，因为使用了高精密的Sip封装，维修难度及成本不如换新来的方便。「具体售后为准」</p>
<p>4.USB充电线也包含在内，不包含在意外次数内的。</p>
</blockquote>
<p>但是需要明确的是，不能丢！！<strong>AppleCare+不为丢失或被盗的Airpods提供保障</strong>。详见：<a target="_blank" rel="noopener" href="https://support.apple.com/zh-cn/airpods/repair/service">Airpods服务和维修</a></p>
<p><img src="/2020/06/29/Apple%E4%BF%9D%E4%BF%AE%E6%94%BF%E7%AD%96/7.png" alt="x"></p>
<h3 id="为什么我认为这是性价比最高的AppleCare"><a href="#为什么我认为这是性价比最高的AppleCare" class="headerlink" title="为什么我认为这是性价比最高的AppleCare+"></a>为什么我认为这是性价比最高的AppleCare+</h3><ol>
<li>电池。根据以往几代反应的情况来看，如果你是中度或者重度使用，两年内电池是很难挺住的。假设耳机一天一次电池循环，两年内500次循环一般也挺不住。这时候就可以拿去售后检测换一个全新的耳机，还是挺香的。</li>
<li>因为是真无线耳机，摆脱线控之后，适用各种使用场景，场景一多，意外受损的几率就大很多，购买AC+在使用时便会舒心很多。</li>
<li>假设你要转卖，转卖前使用意外险换新还能卖个好价钱。</li>
<li>保外维修费用昂贵。AirPods Pro单只耳机和充电盒均705元 电池379元，AirPods单只耳机和无线充电盒均549元，有线的盒子479元，电池379元。「一次意外保险费用算上AC+为 299 + 199 = 499，相当于499换新」</li>
</ol>
<h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><p>购买AC+后的凭证需要保存好，流程一般会要求提供耳机购买凭证、AC+购买凭证以及耳机尸体才可以保修。</p>
<p>最好通过Apple官方渠道购买AC+，看到有第三方直接用AC+的名字让消费者购买却不是Apple官方的AC+。</p>
<p>尽量避免极限使用获取更长久的电池续航。</p>
<blockquote>
<p>AC+并不便宜，受财力限制及各种分析未购买AC+，且打算小心使用耳机的朋友，<strong>好好充电是很重要的</strong>，Apple产品质量上出问题的可能性不是很大，但电池损耗属于物理性损耗，电池产业在技术上没有革新的情况下，即使Apple使用了较好的电池，也很难避免电池的损耗，一般消费级电子产品使用多为锂电池，切忌将电量用到极低后再进行充电（20%以下），此时对于电池寿命的损耗是很大的。</p>
</blockquote>
<hr>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://post.smzdm.com/p/akmr45nr/">AppleCare 扫盲帖，三年苹果狗告诉你 AppleCare 到底值不值得买？</a></p>
<p><a target="_blank" rel="noopener" href="https://support.apple.com/zh-cn/warranties">中国官方保修政策</a></p>
<p><a target="_blank" rel="noopener" href="https://www.apple.com.cn/support/products">AppleCare 产品</a>,</p>
<p><a target="_blank" rel="noopener" href="https://www.apple.com.cn/legal/statutory-warranty/">Apple 产品与中国消费者权益相关法律法规</a></p>
<p><a target="_blank" rel="noopener" href="https://support.apple.com/zh-cn/repair/products">产品服务和维修信息</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/05/18/Mapreduce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/18/Mapreduce/" class="post-title-link" itemprop="url">Mapreduce</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-18 09:58:58" itemprop="dateCreated datePublished" datetime="2020-05-18T09:58:58+08:00">2020-05-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span id="/2020/05/18/Mapreduce/" class="post-meta-item leancloud_visitors" data-flag-title="Mapreduce" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>3.1k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>3 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Mapreduce"><a href="#Mapreduce" class="headerlink" title="Mapreduce"></a>Mapreduce</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><blockquote>
<p>分布式并行编程可以大幅提高程序性能，实现高效的批量数据处理。分布式程序运行在大规模计算机集群上，集群中包含大量廉价服务器，能够并行执行大规模数据处理任务，从而获得海量的计算能力。MapReduce就是一种并行编程模型，用于大规模数据集的并行运行，将复杂的，运行于大规模集群上的并行计算高度抽象到两个函数<strong>Map</strong>和<strong>Reduce</strong>，两个函数及其核心思想源自函数式编程语言。</p>
</blockquote>
<p>谷歌最先提出了分布式并行编程模型MapRecude，Hadoop MapReduce是其开源实现。前者运行在DFS上，后者运行在HDFS上。</p>
<p>在MapReduce中，一个存储在分布式文件系统中的大规模数据集会被切分为许多独立的小数据块，这些小数据块可以被多个Map任务并行处理。<u>MapReduce框架会为每个Map任务输入一个<strong>数据子集</strong>，Map任务生成的结果会继续作为Reduce任务的输入，最终由Reduce任务输出最后结果，并写入分布式文件系统。</u>「适合用MapReduce来处理的数据集需要满足一个前提条件：待处理的数据集可以分解成许多小的数据集，而且每个小数据集都可以完全并行进行处理。」</p>
<p>MapReduce的一个设计理念为<strong>“计算向数据靠拢”</strong>而非“数据向计算靠拢”。主要是因为移动数据需要大量的网络传输开销，尤其在大规模数据环境下，移动计算比移动数据更加经济。所以在集群中，MapReduce框架会将每个Map程序就近在HDFS数据所在的节点运行，即将计算节点和存储节点一起运行，减少移动数据开销。</p>
<p>综上，MapReduce是一个<strong>基于集群的高性能并行计算平台</strong>，MapReduce是一个<strong>并行计算软件框架</strong>，MapReduce是一个<strong>并行程序设计模型与方法</strong>。</p>
<h2 id="模型介绍"><a href="#模型介绍" class="headerlink" title="模型介绍"></a>模型介绍</h2><p>MapReduce核心是Map函数和Reduce函数，开发者只需要关注Map和Reduce函数的实现即可，不需要处理其他复杂的问题，比如分布式存储、工作调度、负载均衡等。</p>
<p>MapReduce使用列表和键值对<key, value>作为主要的数据模式。</key,></p>
<p><img src="/2020/05/18/Mapreduce/structure.png" alt></p>
<h3 id="Map函数"><a href="#Map函数" class="headerlink" title="Map函数"></a>Map函数</h3><p>Map函数的输入来自分布式文件系统的文件快，这些文件块的格式是任意的，可以是文档，也可以是二进制格式的。文件块是一系列元素的集合，这些元素也是任意类型的。Map函数将输入元素转化为键值对，<strong>键和值的类型也是任意的</strong>，其中键不同于一般的标志属性，键没有唯一性，不能作为输出身份标识。即使是同一输入元素也可以通过Map任务生成具有相同键的多个<key, value>。</key,></p>
<h3 id="Reduce函数"><a href="#Reduce函数" class="headerlink" title="Reduce函数"></a>Reduce函数</h3><p>Reduce函数的任务就是将输入的一系列具有相同键的键值对以某种方式组合起来，输出处理后的键值对，输出结果会合并成一个文件。用户可指定Reduce任务个数，通知实现系统，然后主控进程通常选择一个Hash函数，Map任务输出的每个键都会经过Hash函数计算，并更具哈希结果将该键值对输入相应的Reduce任务处理。</p>
<p><img src="/2020/05/18/Mapreduce/process.png" alt></p>
<h3 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h3><p><img src="/2020/05/18/Mapreduce/workflow.png" alt></p>
<p>MapReduce的核心思想可以用“分而治之”描述，如上流程图可知，即将一个大的数据集拆分成多个小数据块在多台机器上并行处理。Map任务一般在数据节点上运行，以减少多余开销。只有在Map任务结束后，中间结果会被分发到多个Reduce中。</p>
<p>需要注意的是：不同的Map任务之间不会进行通讯，不同的Reduce任务之间也不会发生任何信息交换；用户不能显式地从一台机器向另一台机器发送消息，所有数据交换都通过MapReduce自身去实现的。</p>
<p>在执行过程中，Map任务输入文件，Reduce任务的处理结果保存在分布式文件系统中，而Map任务处理得到的中间结果则保存在本地磁盘中，只有Map任务处理结束后，Reduce过程才开始；所以Map任务需要考虑到数据的局部性。</p>
<h3 id="任务执行"><a href="#任务执行" class="headerlink" title="任务执行"></a>任务执行</h3><p>MapReduce执行阶段如下：</p>
<p><img src="/2020/05/18/Mapreduce/phase.png" alt></p>
<ol>
<li>MapReduce使用<strong>InputFormat</strong>模块作为Map的预处理；然后将输入文件切分为逻辑上的多个<strong>InputSplit</strong>，<em>InputSplit是MapReduce对文件进行处理和运算的输入单位。</em>「实际上InputSplit并没有对文件进行切割，而是记录了需要处理数据的位置和长度」</li>
<li>通过<strong>RecordReader</strong>（RR）根据InputSplit里面的信息处理具体数据，加载数据并转换为适合的Map任务读取的键值对，输入给Map任务。</li>
<li>Map根据用户自定义的映射规则，输出一些列键值对作为中间结果。</li>
<li>为了让Reduce可以并行处理Map的结果，需要对Map的输出进行一定的分区(Portition)、排序(Sort)、合并(Combine)、归并(Merge)等操作，得到中间结果，然后交给对应的Reduce处理，该过程为<strong>Shuffle</strong>。从无序的键值对到有序的键值对。</li>
<li>Reduce以一系列中间结果作为输入，执行用户定义的逻辑，输出结果给OutputFormat模块。</li>
<li><strong>OutputFormat</strong>模块验证输出目录是否已经存在以及输出结果类型是否符合配置文件中的配置类型，如果都满足，就输出Reduce结果到分布式文件系统。</li>
</ol>
<h3 id="Shuffle过程"><a href="#Shuffle过程" class="headerlink" title="Shuffle过程"></a>Shuffle过程</h3><p>Shuffle是MapReduce的核心环节。Shuffle过程即对Map输出结果进行分区、排序、合并等处理交给Reduce过程，故分为Map端操作和Reduce端操作，Shuffle过程如下图。</p>
<p><img src="/2020/05/18/Mapreduce/Shuffle1.png" alt></p>
<p>Map的输出结果首先被写入缓存，缓存满后进行溢写操作，即把缓存中的数据写入磁盘文件，清空缓存。当启动溢写操作时，首先把缓存中的数据写入分区，然后对每个分区的数据进行排序、合并，之后再写入磁盘文件。每次溢写操作生成一个新的磁盘文件，随着Map任务执行，磁盘中就会有多个溢写文件，任务结束后，这些文件被归并（Merge）为一个大的磁盘文件。然后通知Reduce任务领取属于自己处理的数据。Reduce任务领取数据后，将其归并写入磁盘后交给Reduce处理。</p>
<h4 id="Map端的Shuffle过程"><a href="#Map端的Shuffle过程" class="headerlink" title="Map端的Shuffle过程"></a>Map端的Shuffle过程</h4><ol>
<li>输入数据和执行Map任务</li>
</ol>
<p>Map任务的输入数据保存在分布式文件系统的文件块中，文件格式任意。Map任务接收<key , value>作为输入后，按一定的映射规则转换成一批<key , value>进行输出。</key></key></p>
<ol>
<li>写入缓存</li>
</ol>
<p>每个Map任务都会分配一个缓存，Map输出结果先写入缓存中，在缓存满后才写入磁盘。可以大大降低开销。</p>
<ol>
<li>溢写（分区、排序和合并）</li>
</ol>
<p>提供给MapReduce的缓存容量时有限的，一旦占满缓存就执行溢写（Spill）操作，把缓存中的内容一次性写入磁盘并清空缓存。在溢写到磁盘前，缓存中的数据先被分区（Partition），以键值对形式存储；对于每个分区的键值对，后台线程根据其Key对其进行内存排序（Sort），排序是MapReduce默认操作，排序结束后执行合并（Combine）操作，合并操作根据用户定义的执行。</p>
<ol>
<li>文件归并</li>
</ol>
<p>在Map任务全部结束之前，系统会对所有溢写文件中的数据进行归并（Merge），生成一个大的溢写文件。这个大的溢写文件中所有键值对也是经过分区和排序的。</p>
<p>综上，Map端的Shuffle过程全部完成，最终生成一个大文件存放在本地磁盘上。其中JobTracker会一直检测Map任务执行，当检测到一个Map任务完成后，立即通知相关Reduce任务来领取数据。</p>
<h4 id="Reduce端的Shuffle过程"><a href="#Reduce端的Shuffle过程" class="headerlink" title="Reduce端的Shuffle过程"></a>Reduce端的Shuffle过程</h4><p>Reduce端的Shuffle过程相对简单，从Map端读取Map结果，然后进行归并，最后输送给Reduce进行处理。</p>
<ol>
<li>领取数据</li>
</ol>
<p>Map端的Shuffle过程结束后，Reduce任务把这些数据领取回来，</p>
<ol>
<li>归并数据</li>
</ol>
<p>归并过程与Map端类似</p>
<ol>
<li>把数据给Reduce任务</li>
</ol>
<p>磁盘经过多轮归并后得到若干大文件，不再继续归并，直接输入给Reduce任务，减少磁盘读写开销。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" class="post-title-link" itemprop="url">JDBC基本概念</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-16 22:30:05" itemprop="dateCreated datePublished" datetime="2020-05-16T22:30:05+08:00">2020-05-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span id="/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" class="post-meta-item leancloud_visitors" data-flag-title="JDBC基本概念" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>9.2k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>8 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="JDBC基本概念"><a href="#JDBC基本概念" class="headerlink" title="JDBC基本概念"></a>JDBC基本概念</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>JDBC（Java Database Connectivity）是一组用来按照统一方式访问数据库的API。向程序员提供了独立于数据库的<strong>统一接口</strong>，开发人员只需要学习JDBC结构，并通过JDBC加载具体驱动，就可以对数据库进行连接及操作。「组成JDBC的两个包：java.sql和javax.sql」</p>
<p>JDBC一共有四种驱动类型，参见<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/JDBC_driver">维基百科</a>。</p>
<!------more ----->
<p>JDBC API：</p>
<p><img src="/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/jdbcapi.png" alt="jdbcapi"></p>
<h2 id="基本编程操作"><a href="#基本编程操作" class="headerlink" title="基本编程操作"></a>基本编程操作</h2><p>连接数据库分为以下7步：</p>
<blockquote>
<p>第一步：加载正确的数据库驱动程序</p>
<p>第二步：定义所要连接数据库的地址</p>
<p>第三步：建立与数据库的连接</p>
<p>第四步：声明SQL语句并创建语句对象</p>
<p>第五步：执行SQL语句</p>
<p>第六步：对执行结果进行处理</p>
<p>第七步：关闭打开的资源</p>
</blockquote>
<ol>
<li>创建数据库脚本</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `<span class="keyword">user</span>`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>`  (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `ident` <span class="type">char</span>(<span class="number">1</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;0普通用户\r\n1管理员&#x27;</span>,</span><br><span class="line">  `telephone` <span class="type">varchar</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `address` <span class="type">varchar</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> INDEX `<span class="keyword">unique</span><span class="operator">-</span>username`(`username`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">17</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">user</span>` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">user</span>` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;user1&#x27;</span>, <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;041184835202&#x27;</span>, <span class="string">&#x27;大连东软信息学院A3座117室&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">user</span>` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;user2&#x27;</span>, <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;041184835207&#x27;</span>, <span class="string">&#x27;大连理工大学计算机系&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">user</span>` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;user3&#x27;</span>, <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;041184832264&#x27;</span>, <span class="string">&#x27;新新园100号2门103&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>数据表结构如下：</p>
<p><img src="/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/tablestu.png" alt="tablestu"></p>
<ol>
<li>新建Java工程并在web资源中导入数据库驱动</li>
</ol>
<p><img src="/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/connector.png" alt="connector"></p>
<ol>
<li>编写注册页面<code>register.html</code>，用于输入信息并提交至RegisterServlet。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>注册页面<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;register&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>用户注册<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>用户名：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;un&quot;</span> <span class="attr">size</span>=<span class="string">&quot;20&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span></span></span><br><span class="line"><span class="tag">					<span class="attr">required</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>密码：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pw&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>电话：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;tel&quot;</span> <span class="attr">size</span>=<span class="string">&quot;20&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span></span></span><br><span class="line"><span class="tag">					<span class="attr">required</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>地址：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;addr&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;3&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;20&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span></span></span><br><span class="line"><span class="tag">						<span class="attr">required</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;注册&quot;</span>&gt;</span> &lt;input</span><br><span class="line">          type=&quot;reset&quot;&gt;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>页面如下：</p>
<p><img src="/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/register.png" alt="register"></p>
<ol>
<li>编写<code>RegisterServlet</code>，只放doGet部分代码。</li>
</ol>
<blockquote>
<p>使用JDBC连接数据库，将注册页面填写的信息插入数据表中，并给出提示。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">  response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">  PrintWriter out = response.getWriter();</span><br><span class="line">  String un = request.getParameter(<span class="string">&quot;un&quot;</span>);</span><br><span class="line">  String pw = request.getParameter(<span class="string">&quot;pw&quot;</span>);</span><br><span class="line">  String tel = request.getParameter(<span class="string">&quot;tel&quot;</span>);</span><br><span class="line">  String addr = request.getParameter(<span class="string">&quot;addr&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(un==<span class="keyword">null</span> || pw==<span class="keyword">null</span>|| tel==<span class="keyword">null</span> ||addr==<span class="keyword">null</span>||un.equals(<span class="string">&quot;&quot;</span>)||pw.equals(<span class="string">&quot;&quot;</span>)||tel.equals(<span class="string">&quot;&quot;</span>)||addr.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">    out.println(<span class="string">&quot;注册信息不全！&quot;</span>);</span><br><span class="line">    out.println(<span class="string">&quot;请输入完整的&lt;a href=register.html&gt;注册&lt;/a&gt;信息！&quot;</span>);</span><br><span class="line">  &#125;<span class="comment">//end if 注册信息不全</span></span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">int</span> r=<span class="number">0</span>;</span><br><span class="line">    Connection con=<span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement pstmt=<span class="keyword">null</span>;</span><br><span class="line">    ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//1加载驱动程序</span></span><br><span class="line">      Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">      <span class="comment">//2定义url连接数据库</span></span><br><span class="line">      String url=<span class="string">&quot;jdbc:mysql://127.0.0.1:3306/meal?serverTimezone=UTC&quot;</span>;</span><br><span class="line">      <span class="comment">//3 建立与DB的连接</span></span><br><span class="line">      con = DriverManager.getConnection(url,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">      <span class="comment">//4写SQL语句，查询用户名是否可用</span></span><br><span class="line">      String sql = <span class="string">&quot;select * from user where username=?&quot;</span>;</span><br><span class="line">      <span class="comment">//5创建语句对象</span></span><br><span class="line">      pstmt = con.prepareStatement(sql);</span><br><span class="line">      <span class="comment">//6给❓ 赋值，执行SQL</span></span><br><span class="line">      pstmt.setNString(<span class="number">1</span>, un);</span><br><span class="line">      rs=pstmt.executeQuery();</span><br><span class="line">      <span class="comment">//7对结果集进行处理</span></span><br><span class="line">      System.out.println(<span class="string">&quot;====rs&quot;</span>+rs);</span><br><span class="line">      <span class="keyword">if</span>(rs.next()) &#123;<span class="comment">//如果结果集不为空，说明注册用户名在数据库中已存在</span></span><br><span class="line">        out.println(<span class="string">&quot;用户名不可用&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;a href=register.html&gt;返回&lt;/a&gt;&quot;</span>);</span><br><span class="line">      &#125;<span class="comment">//end if用户名已存在，不可用</span></span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        pstmt.close();</span><br><span class="line">        <span class="comment">//4 写sql语句，完成插入操作</span></span><br><span class="line">        sql=<span class="string">&quot;insert into user values(null,?,?,0,?,?)&quot;</span>;</span><br><span class="line">        pstmt = con.prepareStatement(sql);</span><br><span class="line">        pstmt.setString(<span class="number">1</span>, un);</span><br><span class="line">        pstmt.setString(<span class="number">2</span>, pw);</span><br><span class="line">        pstmt.setString(<span class="number">3</span>, tel);</span><br><span class="line">        pstmt.setString(<span class="number">4</span>, addr);</span><br><span class="line">        r=pstmt.executeUpdate();</span><br><span class="line">      &#125;<span class="comment">//end else用户名可用</span></span><br><span class="line">    &#125;<span class="comment">//end try</span></span><br><span class="line">    <span class="keyword">catch</span>(ClassNotFoundException ex) &#123;</span><br><span class="line">      ex.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(SQLException ex) &#123;</span><br><span class="line">      ex.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="comment">//8关闭连接</span></span><br><span class="line">      <span class="keyword">if</span>(rs!=<span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          rs.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">          <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">          e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">      <span class="keyword">if</span>(pstmt!=<span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          pstmt.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">          <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">          e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">      <span class="keyword">if</span>(con!=<span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">          <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">          e.printStackTrace();</span><br><span class="line">        &#125;	</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r==<span class="number">1</span>) &#123;</span><br><span class="line">      out.println(<span class="string">&quot;注册成功！&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      out.println(<span class="string">&quot;注册失败！&quot;</span>);</span><br><span class="line">    &#125;out.println(<span class="string">&quot;&lt;a href=register.html&gt;返回&lt;/a&gt;&quot;</span>);</span><br><span class="line">  &#125;<span class="comment">//end if 注册信息完整</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上，代码编写且执行均可正常运行，JDBC也连接ok。</p>
<h3 id="步骤拆分"><a href="#步骤拆分" class="headerlink" title="步骤拆分"></a>步骤拆分</h3><ol>
<li>加载正确的数据库驱动程序</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);	<span class="comment">//声明后即正确加载驱动程序</span></span><br></pre></td></tr></table></figure>
<p>如果抛出<code>ClassNotFoundException</code>异常表明所需驱动未在<code>classpath</code>中。</p>
<p>不同数据库驱动程序的名称是不同的，声明内的代码也是不同的。</p>
<ol>
<li>定义url连接数据库</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2定义url连接数据库</span></span><br><span class="line">String url=<span class="string">&quot;jdbc:mysql://127.0.0.1:3306/meal?serverTimezone=UTC&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>不同数据库连接的地址不同，URL一般由三个部分组成，用冒号隔开。<code>jdbc:子协议：子名称</code></p>
<blockquote>
<p>jdbc：JDBC中的协议就是jdbc。</p>
<p>&lt;子协议&gt;：数据库驱动程序名或数据库连接机制的名称。</p>
<p>&lt;子名称&gt;：一种标记数据库的方法。子名称根据子协议的不同而不同，使用子名称的目的是为定位数据库。</p>
</blockquote>
<p>常用数据库URL地址写法：</p>
<blockquote>
<p>String ODBCURL = “jdbc:odbc:dbName”;</p>
<p>String oracleURL = “jdbc:oracle:thin:@host:port:dbName”;</p>
<p>String mysqlURL = “jdbc:mysql://host:port/dbName”;</p>
<p>String sqlURL = “jdbc:microsoft:sqlserver://host:port;DatabaseName=dbName “;</p>
</blockquote>
<p><img src="/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/url.png" alt="url"></p>
<ol>
<li>建立与DB的连接</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3 建立与DB的连接,url,user,password</span></span><br><span class="line">Connection connetion = DriverManager.getConnection(url,username,password);</span><br></pre></td></tr></table></figure>
<p><strong>DriverManager类</strong></p>
<p>驱动程序管理类负责管理JDBC驱动程序。在使用JDBC驱动程序，在使用JDBC驱动程序前，需要向DriverManager注册才可使用，调用<code>Class.forName()</code>方法。</p>
<p>常用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerDriver</span><span class="params">(Driver driver)</span> 	<span class="comment">//向 DriverManager 注册给定驱动程序。</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Connection <span class="title">getConnection</span><span class="params">(String url,String user,String password)</span> <span class="keyword">throws</span> SQLException		<span class="comment">//获得url对应数据库的一个连接</span></span></span><br></pre></td></tr></table></figure>
<p><strong>Connection接口</strong></p>
<p>Connection对象是通过DriverManager.getConnection()方法获得，代表与数据库的连接，也就是在已经加载的驱动程序和数据库之间建立连接，是数据库编程中非常重要的一个对象，客户端和数据库之间的交互全是通过Connection对象完成的。</p>
<p>常用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Statement <span class="title">createStatement</span><span class="params">()</span> <span class="keyword">throws</span> SQLException		<span class="comment">//创建一个Statement对象</span></span></span><br><span class="line"><span class="function">PreparedStatement <span class="title">prepareStatement</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException		<span class="comment">//创建一个Preparestatement对象，并能把SQL语句提交到数据库进行预编译。</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setAutoCommit</span><span class="params">(Boolean autocommit)</span> <span class="keyword">throws</span> SQLException		<span class="comment">//设置事务提交的模式</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">commit</span><span class="params">()</span> <span class="keyword">throws</span> SQLException		<span class="comment">//提交对数据库的更改，使更改生效</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rollback</span><span class="params">()</span> <span class="keyword">throws</span> SQLException		<span class="comment">//放弃当前事务开始以来对数据库所作的修改 </span></span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure>
<ol>
<li>声明SQL语句并创建语句对象</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String sql = <span class="string">&quot;select * from tablename&quot;</span> ；</span><br><span class="line">Statement statement = connection.createStatement();</span><br><span class="line">PreparedStatement pstmt = connection.prepareStatement(sql);</span><br></pre></td></tr></table></figure>
<p><strong>Statement类</strong></p>
<p>Statement用于执行静态SQL语句。</p>
<p>执行<code>insert</code>，<code>update</code>，<code>delete</code>语句等，调用<code>executeUpdate(String sql)</code>方法。</p>
<p>执行<code>select</code>语句可以调用<code>executeQuery(String sql)</code>方法，返回<code>ResultSet</code>对象。</p>
<p>常用方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ResultSet <span class="title">executeQuery</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException		<span class="comment">//执行一个查询语句并返回结果集</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">executeUpdate</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException		<span class="comment">//执行更新操作，返回更新的行数</span></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException		<span class="comment">//执行更新或查询语句，返回是否有结果集 [任意结果集]</span></span></span><br></pre></td></tr></table></figure>
<p><strong>PreparedStatement类</strong></p>
<p>PreparedStatement 是预编译的语句对象，可以用来执行带占位符的SQL语句。</p>
<p>数据库对他们事先进行编译，因此，客户端需要做的只是传送占位符位置所需要的数据。</p>
<p><strong>Statement对象执行的SQL语句，只有在程序运行时才对他们进行编译，因此PreparedStatement运行的速度更快。</strong></p>
<p>常用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setXXX</span><span class="params">(<span class="keyword">int</span> parameterIndex,XXX x)</span> 	<span class="comment">//为第1参数指定的占位符设置第2参数指定的值</span></span></span><br><span class="line"><span class="function">ResultSet <span class="title">executeQuery</span><span class="params">()</span>	<span class="comment">//执行 SQL 查询，并返回该查询生成的 ResultSet 对象。 </span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">executeUpdate</span><span class="params">()</span> 	<span class="comment">//执行 SQL 语句，该语句必须是一个 SQL 数据操作语言（Data Manipulation Language，DML）语句，比如 INSERT、UPDATE 或 DELETE 语句；或者是无返回内容的 SQL 语句，比如 DDL 语句。 </span></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">execute</span><span class="params">()</span> 	<span class="comment">//执行 SQL 语句，该语句可以是任何种类的 SQL 语句。</span></span></span><br></pre></td></tr></table></figure>
<p>例如编程基本操作处使用的代码使用的就是PreparedStatement类。</p>
<p><strong>CallableStatement类</strong></p>
<p>CallableStatement是JDBC用来调用数据库中存储过程的机制。</p>
<p>具体的使用和PreparedStatement相似。</p>
<p>需要注意的是：要调用的存储过程必须在数据库中存在，否则将抛出异常。</p>
<ol>
<li>执行SQL语句</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pstmt = con.prepareStatement(sql);</span><br></pre></td></tr></table></figure>
<p>执行查询类SQL语句：使用语句对象的executeQuery()方法，返回 ResultSet结果集（一个二维表）。</p>
<p>执行更新类SQL语句：使用语句对象的executeUpdate()方法，返回被更新记录的条数。</p>
<p>执行各种类型的SQL语句：使用语句对象的execute()方法，当SQL语句的执行结果是一个ResultSet时，方法返回true，并可以通过语句对象的getResultSet()方法得到返回的结果集；当SQL语句的执行没有返回的结果集时，该方法返回false。</p>
<ol>
<li>处理结果</li>
</ol>
<p>ResultSet用于代表Sql语句执行结果。Resultset封装执行结果时，采用类型表格的方式。维护了一个指向表格数据行的游标，游标在第一行之前，调用<code>ResultSet.next()</code>方法，可以使游标指向具体数据行。</p>
<p>ResultSet提供了getXxx()方法，用于获取当前行中某列的值，其中“XXX”与列的数据类型有关，例如，如要获取的列是String类型，则使用getString()方法获取该列的值。getXxx()方法如下所示：getString()，getInt()，getFloat()，getDouble()，getDate()和getBoolean() </p>
<p>应用示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ResultSet rs = statement.executeQuery();</span><br><span class="line"><span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">  String name = rs.getString(<span class="number">1</span>);</span><br><span class="line">  String phone = rs.getString(<span class="number">2</span>);</span><br><span class="line">  System.out.println(name+<span class="string">&quot;,&quot;</span>+phone);</span><br><span class="line">&#125;</span><br><span class="line">通过指定列名(getXxx(String)) 或列号的方式(getXxx(<span class="keyword">int</span>)) 调用getXxx()方法将对应列的内容获取出来。</span><br><span class="line">通过first(), (), previous(), next(), absolute(<span class="keyword">int</span>), … 方法滚动结果集中的内容。</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/JDBC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/sql&amp;java.png" alt="sql&amp;java"></p>
<ol>
<li>释放资源</li>
</ol>
<p>JDBC程序运行完后，一定要释放程序中创建的一些交互对象，通常为ResultSet、Statement和Connection对象，尤其是Connection对象，非常稀有的资源，用完后需要立即释放，否则容易造成系统宕机。</p>
<p>资源释放代码一定要放在finally语句中执行。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/05/16/Hive%20MacOS%20%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/16/Hive%20MacOS%20%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">Hive MacOS配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-16 09:00:00" itemprop="dateCreated datePublished" datetime="2020-05-16T09:00:00+08:00">2020-05-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span id="/2020/05/16/Hive%20MacOS%20%E9%85%8D%E7%BD%AE/" class="post-meta-item leancloud_visitors" data-flag-title="Hive MacOS配置" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>7.4k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>7 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Hive-MacOS-配置"><a href="#Hive-MacOS-配置" class="headerlink" title="Hive MacOS 配置"></a>Hive MacOS 配置</h2><p>环境：</p>
<p>Hadoop3.2.1</p>
<p>Hive 3.1.2</p>
<h2 id="Hive-3-1-2-安装"><a href="#Hive-3-1-2-安装" class="headerlink" title="Hive 3.1.2 安装"></a>Hive 3.1.2 安装</h2><p>使用brew安装Hive</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew install hive</span><br></pre></td></tr></table></figure>
<p>Hive的默认安装目录为：<code>/usr/local/Cellar/hive/3.1.2</code></p>
<p>添加环境变量至shell配置文件, 我使用<code>zshrc</code>，故执行<code>vim .zshrc</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export HIVE_HOME=/usr/local/Cellar/hive/3.1.2</span><br><span class="line">export PATH=$PATH:$HIVE_HOME/bin</span><br></pre></td></tr></table></figure>
<p>保存退出后使配置生效<code>source .zshrc</code>。</p>
<h3 id="创建Hive的HDFS目录"><a href="#创建Hive的HDFS目录" class="headerlink" title="创建Hive的HDFS目录"></a>创建Hive的HDFS目录</h3><figure class="highlight plain"><figcaption><span>shell</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Create warehouse folder under hive and provide permission</span><br><span class="line">hdfs dfs -mkdir -p &#x2F;user&#x2F;hive&#x2F;warehouse</span><br><span class="line">hdfs dfs -chmod g+w &#x2F;user&#x2F;hive&#x2F;warehouse</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Create tmp folder in root and provide permission</span><br><span class="line">hdfs dfs -mkdir -p &#x2F;tmp</span><br><span class="line">hdfs dfs -chmod g+w &#x2F;tmp</span><br><span class="line"></span><br><span class="line">hdfs dfs -mkdir -p &#x2F;tmp&#x2F;hive</span><br><span class="line">hdfs dfs -chmod 777 &#x2F;tmp&#x2F;hive</span><br></pre></td></tr></table></figure>
<h3 id="环境变量配置"><a href="#环境变量配置" class="headerlink" title="环境变量配置"></a>环境变量配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/Cellar/hive/3.1.2/libexec/conf</span><br><span class="line">mv hive-default.xml.template hive-default.xml</span><br><span class="line">vim hive-site.xml</span><br></pre></td></tr></table></figure>
<p>进入<code>/usr/local/Cellar/hive/3.1.2/libexec/conf</code>目录创建<code>hive-site.xml</code>，在其中添加如下配置信息：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/hive?createDatabaseIfNotExist=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>JDBC connect string for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Driver class name for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hive<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>username to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hive<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>password to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其中UserName为数据库名称，Password为数据库密码，其中Password与下面mysql创建的hive账户密码一致。</p>
<h2 id="MySQL配置"><a href="#MySQL配置" class="headerlink" title="MySQL配置"></a>MySQL配置</h2><blockquote>
<p>本文默认安装MySQL。</p>
</blockquote>
<h3 id="jdbc包下载"><a href="#jdbc包下载" class="headerlink" title="jdbc包下载"></a>jdbc包下载</h3><p>下载地址：<a target="_blank" rel="noopener" href="https://downloads.mysql.com/archives/c-j/">地址</a>，选择Platform Independent，下载。</p>
<p>下载完成后，将mysql的jdbc包移入hive的lib目录下<code>/usr/local/Cellar/hive/3.1.2/libexec/lib</code>。</p>
<h3 id="创建sql表"><a href="#创建sql表" class="headerlink" title="创建sql表"></a>创建sql表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">mysql&gt; create database hive;</span><br><span class="line">mysql&gt; USE hive;</span><br><span class="line">mysql&gt; CREATE USER &#39;hive&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;hive&#39;;</span><br><span class="line">mysql&gt; grant SELECT,INSERT,UPDATE,DELETE,ALTER,CREATE ON hive.* TO &#39;hive&#39;@&#39;localhost&#39;;</span><br><span class="line">&#x2F;&#x2F; grant all on hive.* to &#39;hive&#39;@&#39;localhost&#39;;</span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<h2 id="启动Hive-并测试"><a href="#启动Hive-并测试" class="headerlink" title="启动Hive 并测试"></a>启动Hive 并测试</h2><p>先执行以下命令，使用 schematool工具初始化Hive版本的Metastore架构。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql</span><br></pre></td></tr></table></figure>
<p>最后会出现<code>Initialization script completed schemaTool completed</code></p>
<p>启动Hive</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive</span><br></pre></td></tr></table></figure>
<p>hive启动完成后会出现如下命令提示符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt;</span><br></pre></td></tr></table></figure>
<p>可以简单执行以下命令尝试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; show databases;</span><br><span class="line">hive&gt; show tables;</span><br><span class="line">hive&gt; create table test (id int, name string);</span><br><span class="line">hive&gt; insert into test values (1, &#39;John Smith&#39;);</span><br><span class="line">hive&gt; select * from test;</span><br><span class="line">hive&gt; drop table test;</span><br><span class="line">hive&gt; exit;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Hive%20MacOS%20%E9%85%8D%E7%BD%AE/hive.png" alt="hive"></p>
<p>Hive安装成功后在MySql会有如下表格：</p>
<p><img src="/2020/05/16/Hive%20MacOS%20%E9%85%8D%E7%BD%AE/hivetable.png" alt="hivetable"></p>
<h2 id="Hive常见Bug汇总"><a href="#Hive常见Bug汇总" class="headerlink" title="Hive常见Bug汇总"></a>Hive常见Bug汇总</h2><h3 id="guava版本不一致问题"><a href="#guava版本不一致问题" class="headerlink" title="guava版本不一致问题"></a>guava版本不一致问题</h3><p>在使用hive命令后，出现如下报错：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">LF4J: Class path contains multiple SLF4J bindings.</span><br><span class="line">SLF4J: Found binding in [jar:file:/usr/local/Cellar/hive/3.1.2/libexec/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: Found binding in [jar:file:/usr/local/Cellar/hadoop/3.2.1/libexec/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.</span><br><span class="line">SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]</span><br><span class="line">Exception in thread &quot;main&quot; java.lang.NoSuchMethodError: com.google.common.base.Preconditions.checkArgument(ZLjava/lang/String;Ljava/lang/Object;)V</span><br><span class="line">    at org.apache.hadoop.conf.Configuration.set(Configuration.java:1357)</span><br><span class="line">    at org.apache.hadoop.conf.Configuration.set(Configuration.java:1338)</span><br><span class="line">    at org.apache.hadoop.mapred.JobConf.setJar(JobConf.java:536)</span><br><span class="line">    at org.apache.hadoop.mapred.JobConf.setJarByClass(JobConf.java:554)</span><br><span class="line">    at org.apache.hadoop.mapred.JobConf.&lt;init&gt;(JobConf.java:448)</span><br><span class="line">    at org.apache.hadoop.hive.conf.HiveConf.initialize(HiveConf.java:5141)</span><br><span class="line">    at org.apache.hadoop.hive.conf.HiveConf.&lt;init&gt;(HiveConf.java:5099)</span><br><span class="line">    at org.apache.hadoop.hive.common.LogUtils.initHiveLog4jCommon(LogUtils.java:97)</span><br><span class="line">    at org.apache.hadoop.hive.common.LogUtils.initHiveLog4j(LogUtils.java:81)</span><br><span class="line">    at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:699)</span><br><span class="line">    at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:683)</span><br><span class="line">    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span><br><span class="line">    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">    at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">    at org.apache.hadoop.util.RunJar.run(RunJar.java:323)</span><br><span class="line">    at org.apache.hadoop.util.RunJar.main(RunJar.java:236)</span><br></pre></td></tr></table></figure>
<p>修复：</p>
<p>查阅资料后，是因为<code>com.google.common.base.Preconditions.checkArgument</code>依赖包在hive内部以及hadoop内部版本不一致导致的。</p>
<p>使用如下命令解决：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看版本</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls /usr/<span class="built_in">local</span>/Cellar/hadoop/3.2.1/libexec/share/hadoop/common/lib/guava*</span></span><br><span class="line">/usr/local/Cellar/hadoop/3.2.1/libexec/share/hadoop/common/lib/guava-27.0-jre.jar</span><br><span class="line"><span class="meta">$</span><span class="bash"> ls /usr/<span class="built_in">local</span>/Cellar/hive/3.1.2/libexec/lib/guava*</span> </span><br><span class="line">/usr/local/Cellar/hive/3.1.2/libexec/lib/guava-19.0-jre.jar</span><br><span class="line"><span class="meta">#</span><span class="bash"> hadoop 版本比 hive 高，替换之</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> mv /usr/<span class="built_in">local</span>/Cellar/hive/3.1.2/libexec/lib/guava-19.0.jar /tmp <span class="comment"># 保留下副本</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cp /usr/<span class="built_in">local</span>/Cellar/hadoop/3.2.1/libexec/share/hadoop/common/lib/guava-27.0-jre.jar /usr/<span class="built_in">local</span>/Cellar/hive/3.1.2/libexec/lib/ <span class="comment"># 替换</span></span></span><br></pre></td></tr></table></figure>
<h3 id="Metastore-Server未正常启动"><a href="#Metastore-Server未正常启动" class="headerlink" title="Metastore Server未正常启动"></a>Metastore Server未正常启动</h3><p>报错如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.RuntimeException: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient</span><br><span class="line">        at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:444)</span><br><span class="line">        at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:672)</span><br><span class="line">        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:616)</span><br><span class="line">        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)</span><br><span class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)</span><br><span class="line">        at java.lang.reflect.Method.invoke(Method.java:597)</span><br><span class="line">        at org.apache.hadoop.util.RunJar.run(RunJar.java:221)</span><br><span class="line">        at org.apache.hadoop.util.RunJar.main(RunJar.java:136)</span><br><span class="line">Caused by: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient</span><br></pre></td></tr></table></figure>
<p>解决：启动Hive的MetaStoreServer服务进程即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># hive --service metastore &amp;</span><br><span class="line">[1] 52460</span><br><span class="line">Starting Hive Metastore Server</span><br><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br><span class="line">SLF4J: Found binding in [jar:file:&#x2F;root&#x2F;hadoop&#x2F;hadoop-2.6.0&#x2F;share&#x2F;hadoop&#x2F;common&#x2F;lib&#x2F;slf4j-log4j12-1.7.5.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]</span><br><span class="line">SLF4J: Found binding in [jar:file:&#x2F;root&#x2F;hadoop&#x2F;apache-hive-0.14.0-bin&#x2F;lib&#x2F;hive-jdbc-0.14.0-standalone.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]</span><br><span class="line">SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#multiple_bindings for an explanation.</span><br><span class="line">SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Hive%20MacOS%20%E9%85%8D%E7%BD%AE/metastore.png" alt="metastore"></p>
<p>Hive启动报错</p>
<p>参见：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/52783323/hive-throws-wstxparsingexception-illegal-character-entity-expansion-character">参考</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.RuntimeException: com.ctc.wstx.exc.WstxParsingException: Illegal character entity: expansion character (code 0x8</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>解决：</p>
<p>在hive-site.xml中删除下面描述</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">     Ensures commands with OVERWRITE (such as INSERT OVERWRITE) acquire Exclusive locks for </span><br><span class="line">     transactional tables. This ensures that inserts (w/o overwrite) running concurrently</span><br><span class="line">     are not hidden by the INSERT OVERWRITE.</span><br><span class="line"><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/freedomboy319/article/details/44828337">常见问题汇总</a></p>
<p><a target="_blank" rel="noopener" href="https://www.datageekinme.com/setup/setting-up-my-mac-hive/">hive configuration</a></p>
<p><a target="_blank" rel="noopener" href="https://luckymrwang.github.io/2018/03/14/Install-hive-on-Mac-with-Homebrew/">https://luckymrwang.github.io/2018/03/14/Install-hive-on-Mac-with-Homebrew/</a></p>
<p><a target="_blank" rel="noopener" href="https://dbmstutorials.com/hive/hive-setup-on-mac.html">hive set up on mac</a></p>
<p><a target="_blank" rel="noopener" href="https://www.datageekinme.com/setup/setting-up-my-mac-hive/">set up hive</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://superming.life/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ninja2.jpg">
      <meta itemprop="name" content="AlenZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AlenZhang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/" class="post-title-link" itemprop="url">Hadoop集群配置安装：MacOS+Ubuntu尝试</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-12 00:17:58" itemprop="dateCreated datePublished" datetime="2020-05-12T00:17:58+08:00">2020-05-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
    <span id="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/" class="post-meta-item leancloud_visitors" data-flag-title="Hadoop集群配置安装：MacOS+Ubuntu尝试" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>5.5k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>5 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Hadoop集群配置安装：MacOS-Ubuntu-尝试"><a href="#Hadoop集群配置安装：MacOS-Ubuntu-尝试" class="headerlink" title="Hadoop集群配置安装：MacOS+Ubuntu 尝试"></a>Hadoop集群配置安装：MacOS+Ubuntu 尝试</h1><p>关于Hadoop集群配置，教程基本都是都是Ubuntu之间的相互配置，很少MacOs与Ubuntu之间的分布式教程，相信很多同学为了做实验受限于机器等条件限制，本文可能会有所帮助。</p>
<h2 id="环境准备："><a href="#环境准备：" class="headerlink" title="环境准备："></a>环境准备：</h2><p>MacOS 【Catalina 10.15.3 】： 作为从节点，节点名称为superming。</p>
<p>Ubuntu 【19.04】：作为主节点，节点命名ZKM-Master。【为方便理解，文章中使用Master替换】</p>
<p>两者位于同一网络环境下，ZKM-Master 节点局域网IP为<strong>192.168.1.106</strong>，superming节点局域网IP为<strong>192.1.1.101</strong>。</p>
<p><strong>说明：</strong></p>
<p>两者安装的Hadoop版本均为3.2.1。</p>
<p>Ubuntu机器使用hadoop用户进行hadoop的相关操作，而Mac机器上为了方便使用，并未创建hadoop用户，而是使用我原来的用户superming进行相关操作，在配置集群之前，所有机器上的hadoop配置均按照伪分布式配置，并可以运行。</p>
<!--- more ---->
<h2 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h2><h3 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h3><p>为了便于区分节点名称，修改Master的主机名</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hostname</span><br></pre></td></tr></table></figure>
<p>在文件hostname文件中写入自己指定的机器名称并保存即可。</p>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/hadoop4.png" alt="hadoop4"></p>
<h3 id="域名映射"><a href="#域名映射" class="headerlink" title="域名映射"></a>域名映射</h3><p>在每台机器上修改节点对应的IP映射。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br></pre></td></tr></table></figure>
<p>按照我的机器命名及IP，添加如下映射：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.106 ZKM-Master</span><br><span class="line">192.168.1.101 superming</span><br></pre></td></tr></table></figure>
<h2 id="SSH配置"><a href="#SSH配置" class="headerlink" title="SSH配置"></a>SSH配置</h2><blockquote>
<p>⚠️：SSH是配置中需要变通的一处，因为我的机器之间的用户等配置并不完全对等，需要进行一些多余配置消除这些影响。</p>
</blockquote>
<p>SSH主要是让Master节点可以通过SSH无密码登录到各Slave节点上。</p>
<p>本步骤用于Master可以通过SSH无密码访问各Slave节点。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh               # 如果没有该目录，先执行一次ssh localhost</span><br><span class="line">rm ./id_rsa*            # 删除之前生成的公匙「因为主机名修改了」</span><br><span class="line">ssh-keygen -t rsa       # 回车到底</span><br></pre></td></tr></table></figure>
<p>截止该步骤，SSH密钥生成完毕，需要SSH能够免密访问机器，需要将生成的公钥保存到Anutorized_key文件中。</p>
<blockquote>
<p>扩展：<a target="_blank" rel="noopener" href="https://abcdabcd987.com/ssh/">SSH基本用法</a></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ./id_rsa.pub &gt;&gt; ./authorized_keys  </span><br></pre></td></tr></table></figure>
<p>将本机的SSH公钥保存到本机的anthoroized_keys文件中，执行<code>ssh ZKM-Master</code>免密码访问本机，详情如下：</p>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/1.png" alt="1"></p>
<p>然后将本机的SSH公钥加入从节点的授权中：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scp ~/.ssh/id_rsa.pub superming@superming:./ #发送公钥至从机器./目录下  解释：&lt;superming:superming&gt;:机器名：用户名 scp为ssh的传输命令，即通过ssh传输文件。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 以下在从机执行</span></span><br><span class="line">mkdir ~/.ssh       # 如果不存在该文件夹需先创建，若已存在则忽略</span><br><span class="line">cat ~/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">rm ~/id_rsa.pub    # 用完就可以删掉了</span><br></pre></td></tr></table></figure>
<p>如果有多余节点，按照以上步骤进行传输并授权。该操作后，Master节点可以无密码访问各从节点。</p>
<p><strong>问题解决</strong>：以上配置后，在Master 节点执行<code>ssh superming</code>，默认使用hadoop用户访问ssh，而我的从节点使用的是superming用户，因此需要为SSH配置别名以确定默认登录用户名。</p>
<p>需要在.ssh/文件下创建一个config文件，用来指定ssh指定的访问方式。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd .ssh/</span><br><span class="line">touch config</span><br><span class="line">vim config</span><br></pre></td></tr></table></figure>
<p>config文件内容如下，Host指定访问名称，Hostname指定访问IP地址，User指定访问用户。</p>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/2.png" alt="1"></p>
<p>经过以上配置后，在Master执行<code>ssh superming</code>就指定用户superming访问Hostname为<code>192.168.1.101</code>。</p>
<h2 id="分布式集群环境配置"><a href="#分布式集群环境配置" class="headerlink" title="分布式集群环境配置"></a>分布式集群环境配置</h2><p>一共需要配置五个文件，配置文件目录在<code>/usr/local/hadoop/etc/hadoop</code>下</p>
<p><code>Slave</code>文件：</p>
<p>注：3.2.1版本slave文件即worker，编辑该文件即可。</p>
<p>Slave文件需要列出节点名称，默认为<code>localhost</code>，本节点仅有一个Datanode，名称为superming，故删除原来的localhost文件并添加superming。</p>
<p>修改<code>core-site.xml</code>文件:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://Master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>Abase for other temporary directories.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>注：以上为<strong>标准格式</strong>，需要根据个人情况进行修改，比如我的机器名为<code>ZKM-Master</code>，需要将fs.defaultFS的值改为<code>hdfs://ZKM-Master:9000</code>。</p>
<p>修改<code>hdfs-site.xml</code>文件，集群中有几个slave节点，将<code>dfs.replication</code>的值改为多少：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Master:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop/tmp/dfs/name<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop/tmp/dfs/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改<code>mapred-site.xml</code>文件：【第一次设置需要将<code>mapred-site.xml.template</code>文件重命名】</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改<code>yarn-site.xml</code>文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果是两台ubuntu机器，按以下命令即可将配置好的文件分发到各个节点上，并完成配置。</p>
</blockquote>
<p>因为以前跑过伪分布式模式，在切换到集群模式前删除之前的临时文件，<strong>并在Master节点上执行</strong>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">sudo rm -r ./hadoop/tmp     # 删除 Hadoop 临时文件</span><br><span class="line">sudo rm -r ./hadoop/logs/*   # 删除日志文件</span><br><span class="line">tar -zcf ~/hadoop.master.tar.gz ./hadoop   # 先压缩再复制</span><br><span class="line">cd ~</span><br><span class="line">scp ./hadoop.master.tar.gz superming:/home/hadoop # superming为从节点用户名称，根据自己配置情况修改</span><br></pre></td></tr></table></figure>
<p><strong>Slave节点执行：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -r /usr/local/hadoop    # 删掉旧的（如果存在）</span><br><span class="line">sudo tar -zxf ~/hadoop.master.tar.gz -C /usr/local</span><br><span class="line">sudo chown -R hadoop /usr/local/hadoop</span><br></pre></td></tr></table></figure>
<p>以上，Hadoop节点的配置基本完成。</p>
<h2 id="启动测试"><a href="#启动测试" class="headerlink" title="启动测试"></a>启动测试</h2><p>问题解决：</p>
<p>因为Hadoop在Mac上的文件以及安装目录与Ubuntu上有很大不同，按以上配置启动，在Ubuntu上启动的Namenode启动正常，但是在Mac上启动的Datanode会碰到很多问题，很多报错忘记截图了，总结了一下大致上是默认安装目录的冲突引起的问题。</p>
<blockquote>
<p>本来想根据报错一个个解决的，修改Master上寻找Datanode路径的配置的，但操作过于麻烦，还是选择了相对简单的方法。</p>
</blockquote>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/3.png" alt="1"></p>
<p>如上，在启动datanode节点时不能找到对应目录<code>/usr/local/haoop/etc/hadoop</code>目录，就是因为Mac的目录冲突导致的。所以作为Datanode，需要确保有/usr/local/hadoop/这个目录能够让Master节点访问到，如果没有就创建一个。</p>
<p>解决：将原本安装于<code>/usr/local/Cellar/hadoop/3.2.1</code>下的Hadoop相关文件复制到该目录下<code>/usr/local/hadoop/</code>下。同时又因为ubuntu的hadoop配置文件在<code>./etc/hadoop/</code>下，而Mac在<code>./libexec/share/hadoop/</code>下，故需要在hadoop目录下创建etc文件，将<code>./libexec/share/hadoop/</code>下的配置文件复制到etc文件下。</p>
<blockquote>
<p>截止该步，将Mac的配置文件与Ubuntu文件的冲突解决。</p>
</blockquote>
<p>在该目录下创建tmp文件，用于存储数据。tmp文件下创建<code>dfs/data/</code>目录以及<code>dfs/name/</code>目录。</p>
<blockquote>
<p>综上，Mac作为数据节点配置完毕。</p>
</blockquote>
<p>在Master节点上使用以下命令启动集群：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format       # 首次运行需要执行初始化</span><br><span class="line">start-dfs.sh</span><br><span class="line">start-yarn.sh</span><br><span class="line">mr-jobhistory-daemon.sh start historyserver</span><br></pre></td></tr></table></figure>
<p>如下图，Master上的执行过程：</p>
<blockquote>
<p>hdfs dfsadmin -report 用于查看节点状态。</p>
</blockquote>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/4.png" alt="1"></p>
<p>Slave节点上应该有Datanode运行：</p>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/5.png" alt="1"></p>
<p>开启成功后。可以在web页面查看节点状态：<code>localhost:9870</code></p>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/web.png" alt="1">`</p>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/web2.png" alt="web2">执行分布式例子：</p>
<p>创建HDFS用户目录：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir -p /user/hadoop</span><br><span class="line">hdfs dfs -mkdir input</span><br><span class="line">hdfs dfs -put /usr/local/hadoop/etc/hadoop/*.xml input</span><br></pre></td></tr></table></figure>
<p>执行MapReduce作业：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar /usr/local/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-examples-*.jar grep input output &#x27;dfs[a-z.]+&#x27;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/12/Hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85--MacOS+Ubuntu%E5%B0%9D%E8%AF%95/hadoop2.png" alt="hadoop2"></p>
<p>节点关闭也是在Master上执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stop-yarn.sh</span><br><span class="line">stop-dfs.sh</span><br><span class="line">mr-jobhistory-daemon.sh stop historyserver</span><br></pre></td></tr></table></figure>
<hr>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/ClusterSetup.html">Hadoop Cluster Setup</a></p>
<p><a target="_blank" rel="noopener" href="https://www.linode.com/docs/databases/hadoop/how-to-install-and-set-up-hadoop-cluster/">How to Install and Set Up a 3-Node Hadoop Cluster</a></p>
<p><a target="_blank" rel="noopener" href="http://dblab.xmu.edu.cn/blog/install-hadoop-cluster/">Hadoop集群安装配置教程_Hadoop2.6.0_Ubuntu/CentOS</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-alien"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AlenZhang</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Symbols count total">200k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">3:02</span>
  </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollRestoration: false,
  scrollTo: !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  






  


<script data-pjax>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      const visitors = document.querySelector('.leancloud_visitors');
      const url = decodeURI(visitors.id);
      const title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            const counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      const visitors = document.querySelectorAll('.leancloud_visitors');
      const entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            const target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    const { app_id, app_key, server_url } = {"enable":true,"app_id":"qwoVwWOTHdN9LlXpTz7BojRm-gzGzoHsz","app_key":"GvmFzmeE5nuRcXTSQNH3icVD","server_url":null,"security":true};
    function fetchData(api_server) {
      const Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    const api_server = app_id.slice(-9) === '-MdYXbMMI' ? `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com` : server_url;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>

    <div class="pjax">

  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



    </div>
</body>
</html>
